var XC=Object.create;var Ls=Object.defineProperty,zC=Object.defineProperties,GC=Object.getOwnPropertyDescriptor,QC=Object.getOwnPropertyDescriptors,YC=Object.getOwnPropertyNames,ha=Object.getOwnPropertySymbols,JC=Object.getPrototypeOf,lu=Object.prototype.hasOwnProperty,Pf=Object.prototype.propertyIsEnumerable;var _f=(n,e,t)=>e in n?Ls(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ce=(n,e)=>{for(var t in e||(e={}))lu.call(e,t)&&_f(n,t,e[t]);if(ha)for(var t of ha(e))Pf.call(e,t)&&_f(n,t,e[t]);return n},Sn=(n,e)=>zC(n,QC(e)),Ef=n=>Ls(n,"__esModule",{value:!0});var xf=(n,e)=>{var t={};for(var r in n)lu.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ha)for(var r of ha(n))e.indexOf(r)<0&&Pf.call(n,r)&&(t[r]=n[r]);return t};var L=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),ZC=(n,e)=>{for(var t in e)Ls(n,t,{get:e[t],enumerable:!0})},Ff=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of YC(e))!lu.call(n,i)&&(t||i!=="default")&&Ls(n,i,{get:()=>e[i],enumerable:!(r=GC(e,i))||r.enumerable});return n},z=(n,e)=>Ff(Ef(Ls(n!=null?XC(JC(n)):{},"default",!e&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n),eD=(n=>(e,t)=>n&&n.get(e)||(t=Ff(Ef({}),e,1),n&&n.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var Mf=L(Lf=>{Lf.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}});var Vf=L(gu=>{var pu=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Af=new RegExp("[\\-\\.0-9"+pu.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),$f=new RegExp("^"+pu.source+Af.source+"*(?::"+pu.source+Af.source+"*)?$"),Ws=0,Gr=1,Ui=2,Hs=3,Ki=4,Vi=5,Us=6,ga=7;function Bi(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Bi)}Bi.prototype=new Error;Bi.prototype.name=Bi.name;function jf(){}jf.prototype={parse:function(n,e,t){var r=this.domBuilder;r.startDocument(),Uf(e,e={}),iD(n,e,t,r,this.errorHandler),r.endDocument()}};function iD(n,e,t,r,i){function s(ve){if(ve>65535){ve-=65536;var Ze=55296+(ve>>10),Ge=56320+(ve&1023);return String.fromCharCode(Ze,Ge)}else return String.fromCharCode(ve)}function o(ve){var Ze=ve.slice(1,-1);return Ze in t?t[Ze]:Ze.charAt(0)==="#"?s(parseInt(Ze.substr(1).replace("x","0x"))):(i.error("entity not found:"+ve),ve)}function a(ve){if(ve>y){var Ze=n.substring(y,ve).replace(/&#?\w+;/g,o);f&&c(y),r.characters(Ze,0,ve-y),y=ve}}function c(ve,Ze){for(;ve>=l&&(Ze=h.exec(n));)u=Ze.index,l=u+Ze[0].length,f.lineNumber++;f.columnNumber=ve-u+1}for(var u=0,l=0,h=/.*(?:\r\n?|\n)|.*$/g,f=r.locator,C=[{currentNSMap:e}],b={},y=0;;){try{var S=n.indexOf("<",y);if(S<0){if(!n.substr(y).match(/^\s*$/)){var k=r.doc,v=k.createTextNode(n.substr(y));k.appendChild(v),r.currentElement=v}return}switch(S>y&&a(S),n.charAt(S+1)){case"/":var D=n.indexOf(">",S+3),R=n.substring(S+2,D),x=C.pop();D<0?(R=n.substring(S+2).replace(/[\s<].*/,""),i.error("end tag name: "+R+" is not complete:"+x.tagName),D=S+1+R.length):R.match(/\s</)&&(R=R.replace(/[\s<].*/,""),i.error("end tag name: "+R+" maybe not complete"),D=S+1+R.length);var F=x.localNSMap,N=x.tagName==R,U=N||x.tagName&&x.tagName.toLowerCase()==R.toLowerCase();if(U){if(r.endElement(x.uri,x.localName,R),F)for(var J in F)r.endPrefixMapping(J);N||i.fatalError("end tag name: "+R+" is not match the current start tagName:"+x.tagName)}else C.push(x);D++;break;case"?":f&&c(S),D=uD(n,S,r);break;case"!":f&&c(S),D=cD(n,S,r,i);break;default:f&&c(S);var te=new Kf,ie=C[C.length-1].currentNSMap,D=sD(n,S,te,ie,o,i),Ee=te.length;if(!te.closed&&aD(n,D,te.tagName,b)&&(te.closed=!0,t.nbsp||i.warning("unclosed xml attribute")),f&&Ee){for(var Dt=Wf(f,{}),ut=0;ut<Ee;ut++){var lt=te[ut];c(lt.offset),lt.locator=Wf(f,{})}r.locator=Dt,Hf(te,r,ie)&&C.push(te),r.locator=f}else Hf(te,r,ie)&&C.push(te);te.uri==="http://www.w3.org/1999/xhtml"&&!te.closed?D=oD(n,D,te.tagName,o,r):D++}}catch(ve){if(ve instanceof Bi)throw ve;i.error("element parse error: "+ve),D=-1}D>y?y=D:a(Math.max(S,y)+1)}}function Wf(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function sD(n,e,t,r,i,s){function o(C,b,y){C in t.attributeNames&&s.fatalError("Attribute "+C+" redefined"),t.addValue(C,b,y)}for(var a,c,u=++e,l=Ws;;){var h=n.charAt(u);switch(h){case"=":if(l===Gr)a=n.slice(e,u),l=Hs;else if(l===Ui)l=Hs;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===Hs||l===Gr)if(l===Gr&&(s.warning('attribute value must after "="'),a=n.slice(e,u)),e=u+1,u=n.indexOf(h,e),u>0)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e-1),l=Vi;else throw new Error("attribute value no end '"+h+"' match");else if(l==Ki)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e),s.warning('attribute "'+a+'" missed start quot('+h+")!!"),e=u+1,l=Vi;else throw new Error('attribute value must after "="');break;case"/":switch(l){case Ws:t.setTagName(n.slice(e,u));case Vi:case Us:case ga:l=ga,t.closed=!0;case Ki:case Gr:case Ui:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),l==Ws&&t.setTagName(n.slice(e,u)),u;case">":switch(l){case Ws:t.setTagName(n.slice(e,u));case Vi:case Us:case ga:break;case Ki:case Gr:c=n.slice(e,u),c.slice(-1)==="/"&&(t.closed=!0,c=c.slice(0,-1));case Ui:l===Ui&&(c=a),l==Ki?(s.warning('attribute "'+c+'" missed quot(")!'),o(a,c.replace(/&#?\w+;/g,i),e)):((r[""]!=="http://www.w3.org/1999/xhtml"||!c.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),o(c,c,e));break;case Hs:throw new Error("attribute value missed!!")}return u;case"\x80":h=" ";default:if(h<=" ")switch(l){case Ws:t.setTagName(n.slice(e,u)),l=Us;break;case Gr:a=n.slice(e,u),l=Ui;break;case Ki:var c=n.slice(e,u).replace(/&#?\w+;/g,i);s.warning('attribute "'+c+'" missed quot(")!!'),o(a,c,e);case Vi:l=Us;break}else switch(l){case Ui:var f=t.tagName;(r[""]!=="http://www.w3.org/1999/xhtml"||!a.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,l=Gr;break;case Vi:s.warning('attribute space is required"'+a+'"!!');case Us:l=Gr,e=u;break;case Hs:l=Ki,e=u;break;case ga:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function Hf(n,e,t){for(var r=n.tagName,i=null,s=n.length;s--;){var o=n[s],a=o.qName,c=o.value,f=a.indexOf(":");if(f>0)var u=o.prefix=a.slice(0,f),l=a.slice(f+1),h=u==="xmlns"&&l;else l=a,u=null,h=a==="xmlns"&&"";o.localName=l,h!==!1&&(i==null&&(i={},Uf(t,t={})),t[h]=i[h]=c,o.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(h,c))}for(var s=n.length;s--;){o=n[s];var u=o.prefix;u&&(u==="xml"&&(o.uri="http://www.w3.org/XML/1998/namespace"),u!=="xmlns"&&(o.uri=t[u||""]))}var f=r.indexOf(":");f>0?(u=n.prefix=r.slice(0,f),l=n.localName=r.slice(f+1)):(u=null,l=n.localName=r);var C=n.uri=t[u||""];if(e.startElement(C,l,r,n),n.closed){if(e.endElement(C,l,r),i)for(u in i)e.endPrefixMapping(u)}else return n.currentNSMap=t,n.localNSMap=i,!0}function oD(n,e,t,r,i){if(/^(?:script|textarea)$/i.test(t)){var s=n.indexOf("</"+t+">",e),o=n.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(t)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),s)}return e+1}function aD(n,e,t,r){var i=r[t];return i==null&&(i=n.lastIndexOf("</"+t+">"),i<e&&(i=n.lastIndexOf("</"+t)),r[t]=i),i<e}function Uf(n,e){for(var t in n)e[t]=n[t]}function cD(n,e,t,r){var i=n.charAt(e+2);switch(i){case"-":if(n.charAt(e+3)==="-"){var s=n.indexOf("-->",e+4);return s>e?(t.comment(n,e+4,s-e-4),s+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var s=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,s-e-9),t.endCDATA(),s+3}var o=lD(n,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var c=o[1][0],u=!1,l=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],l=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(l=o[3][0]));var h=o[a-1];return t.startDTD(c,u,l),t.endDTD(),h.index+h[0].length}}return-1}function uD(n,e,t){var r=n.indexOf("?>",e);if(r){var i=n.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var s=i[0].length;return t.processingInstruction(i[1],i[2]),r+2}else return-1}return-1}function Kf(){this.attributeNames={}}Kf.prototype={setTagName:function(n){if(!$f.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!$f.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function lD(n,e){var t,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(n);t=i.exec(n);)if(r.push(t),t[1])return r}gu.XMLReader=jf;gu.ParseError=Bi});var ku=L(zs=>{function Ks(n,e){for(var t in n)e[t]=n[t]}function rn(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};var r=i;i.prototype=e.prototype,i=new i,Ks(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknow Class:"+n),t.constructor=n)}var dD="http://www.w3.org/1999/xhtml",sn={},Mn=sn.ELEMENT_NODE=1,Xi=sn.ATTRIBUTE_NODE=2,ma=sn.TEXT_NODE=3,Bf=sn.CDATA_SECTION_NODE=4,Xf=sn.ENTITY_REFERENCE_NODE=5,fD=sn.ENTITY_NODE=6,zf=sn.PROCESSING_INSTRUCTION_NODE=7,Gf=sn.COMMENT_NODE=8,Qf=sn.DOCUMENT_NODE=9,Yf=sn.DOCUMENT_TYPE_NODE=10,br=sn.DOCUMENT_FRAGMENT_NODE=11,hD=sn.NOTATION_NODE=12,Nt={},Tt={},rF=Nt.INDEX_SIZE_ERR=(Tt[1]="Index size error",1),iF=Nt.DOMSTRING_SIZE_ERR=(Tt[2]="DOMString size error",2),pD=Nt.HIERARCHY_REQUEST_ERR=(Tt[3]="Hierarchy request error",3),sF=Nt.WRONG_DOCUMENT_ERR=(Tt[4]="Wrong document",4),oF=Nt.INVALID_CHARACTER_ERR=(Tt[5]="Invalid character",5),aF=Nt.NO_DATA_ALLOWED_ERR=(Tt[6]="No data allowed",6),cF=Nt.NO_MODIFICATION_ALLOWED_ERR=(Tt[7]="No modification allowed",7),gD=Nt.NOT_FOUND_ERR=(Tt[8]="Not found",8),uF=Nt.NOT_SUPPORTED_ERR=(Tt[9]="Not supported",9),Jf=Nt.INUSE_ATTRIBUTE_ERR=(Tt[10]="Attribute in use",10),lF=Nt.INVALID_STATE_ERR=(Tt[11]="Invalid state",11),dF=Nt.SYNTAX_ERR=(Tt[12]="Syntax error",12),fF=Nt.INVALID_MODIFICATION_ERR=(Tt[13]="Invalid modification",13),hF=Nt.NAMESPACE_ERR=(Tt[14]="Invalid namespace",14),pF=Nt.INVALID_ACCESS_ERR=(Tt[15]="Invalid access",15);function pi(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,Tt[n]),this.message=Tt[n],Error.captureStackTrace&&Error.captureStackTrace(this,pi);return t.code=n,e&&(this.message=this.message+": "+e),t}pi.prototype=Error.prototype;Ks(Nt,pi);function Qr(){}Qr.prototype={length:0,item:function(n){return this[n]||null},toString:function(n,e){for(var t=[],r=0;r<this.length;r++)Qi(this[r],t,n,e);return t.join("")}};function zi(n,e){this._node=n,this._refresh=e,mu(this)}function mu(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!=e){var t=n._refresh(n._node);hh(n,"length",t.length),Ks(t,n),n._inc=e}}zi.prototype.item=function(n){return mu(this),this[n]};rn(zi,Qr);function va(){}function Zf(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function eh(n,e,t,r){if(r?e[Zf(e,r)]=t:e[e.length++]=t,n){t.ownerElement=n;var i=n.ownerDocument;i&&(r&&ih(i,n,r),mD(i,n,t))}}function th(n,e,t){var r=Zf(e,t);if(r>=0){for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,n){var s=n.ownerDocument;s&&(ih(s,n,t),t.ownerElement=null)}}else throw pi(gD,new Error(n.tagName+"@"+t))}va.prototype={length:0,item:Qr.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new pi(Jf);var t=this.getNamedItem(n.nodeName);return eh(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new pi(Jf);return t=this.getNamedItemNS(n.namespaceURI,n.localName),eh(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return th(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return th(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var r=this[t];if(r.localName==e&&r.namespaceURI==n)return r}return null}};function nh(n){if(this._features={},n)for(var e in n)this._features=n[e]}nh.prototype={hasFeature:function(n,e){var t=this._features[n.toLowerCase()];return!!(t&&(!e||e in t))},createDocument:function(n,e,t){var r=new Bs;if(r.implementation=this,r.childNodes=new Qr,r.doctype=t,t&&r.appendChild(t),e){var i=r.createElementNS(n,e);r.appendChild(i)}return r},createDocumentType:function(n,e,t){var r=new Cu;return r.name=n,r.nodeName=n,r.publicId=e,r.systemId=t,r}};function qt(){}qt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return oh(this,n,e)},replaceChild:function(n,e){this.insertBefore(n,e),e&&this.removeChild(e)},removeChild:function(n){return sh(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return Su(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==ma&&n.nodeType==ma?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var r in t)if(t[r]==n)return r}e=e.nodeType==Xi?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t)return t[n];e=e.nodeType==Xi?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function rh(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}Ks(sn,qt);Ks(sn,qt.prototype);function Vs(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Vs(n,e))return!0;while(n=n.nextSibling)}function Bs(){}function mD(n,e,t){n&&n._inc++;var r=t.namespaceURI;r=="http://www.w3.org/2000/xmlns/"&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function ih(n,e,t,r){n&&n._inc++;var i=t.namespaceURI;i=="http://www.w3.org/2000/xmlns/"&&delete e._nsMap[t.prefix?t.localName:""]}function vu(n,e,t){if(n&&n._inc){n._inc++;var r=e.childNodes;if(t)r[r.length++]=t;else{for(var i=e.firstChild,s=0;i;)r[s++]=i,i=i.nextSibling;r.length=s}}}function sh(n,e){var t=e.previousSibling,r=e.nextSibling;return t?t.nextSibling=r:n.firstChild=r,r?r.previousSibling=t:n.lastChild=t,vu(n.ownerDocument,n),e}function oh(n,e,t){var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===br){var i=e.firstChild;if(i==null)return e;var s=e.lastChild}else i=s=e;var o=t?t.previousSibling:n.lastChild;i.previousSibling=o,s.nextSibling=t,o?o.nextSibling=i:n.firstChild=i,t==null?n.lastChild=s:t.previousSibling=s;do i.parentNode=n;while(i!==s&&(i=i.nextSibling));return vu(n.ownerDocument||n,n),e.nodeType==br&&(e.firstChild=e.lastChild=null),e}function vD(n,e){var t=e.parentNode;if(t){var r=n.lastChild;t.removeChild(e);var r=n.lastChild}var r=n.lastChild;return e.parentNode=n,e.previousSibling=r,e.nextSibling=null,r?r.nextSibling=e:n.firstChild=e,n.lastChild=e,vu(n.ownerDocument,n,e),e}Bs.prototype={nodeName:"#document",nodeType:Qf,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==br){for(var t=n.firstChild;t;){var r=t.nextSibling;this.insertBefore(t,e),t=r}return n}return this.documentElement==null&&n.nodeType==Mn&&(this.documentElement=n),oh(this,n,e),n.ownerDocument=this,n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),sh(this,n)},importNode:function(n,e){return fh(this,n,e)},getElementById:function(n){var e=null;return Vs(this.documentElement,function(t){if(t.nodeType==Mn&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=new RegExp("(^|\\s)"+n+"(\\s|$)");return new zi(this,function(t){var r=[];return Vs(t.documentElement,function(i){i!==t&&i.nodeType==Mn&&e.test(i.getAttribute("class"))&&r.push(i)}),r})},createElement:function(n){var e=new Gi;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.childNodes=new Qr;var t=e.attributes=new va;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new wa;return n.ownerDocument=this,n.childNodes=new Qr,n},createTextNode:function(n){var e=new yu;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new wu;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new bu;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new Tu;return t.ownerDocument=this,t.tagName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new ya;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new Du;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new Gi,r=e.split(":"),i=t.attributes=new va;return t.childNodes=new Qr,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,i._ownerElement=t,t},createAttributeNS:function(n,e){var t=new ya,r=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,t}};rn(Bs,qt);function Gi(){this._nsMap={}}Gi.prototype={nodeType:Mn,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===br?this.insertBefore(n,null):vD(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var r=this.ownerDocument.createAttributeNS(n,e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new zi(this,function(e){var t=[];return Vs(e,function(r){r!==e&&r.nodeType==Mn&&(n==="*"||r.tagName==n)&&t.push(r)}),t})},getElementsByTagNameNS:function(n,e){return new zi(this,function(t){var r=[];return Vs(t,function(i){i!==t&&i.nodeType===Mn&&(n==="*"||i.namespaceURI===n)&&(e==="*"||i.localName==e)&&r.push(i)}),r})}};Bs.prototype.getElementsByTagName=Gi.prototype.getElementsByTagName;Bs.prototype.getElementsByTagNameNS=Gi.prototype.getElementsByTagNameNS;rn(Gi,qt);function ya(){}ya.prototype.nodeType=Xi;rn(ya,qt);function Xs(){}Xs.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(Tt[pD])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var r=this.data.substring(0,n),i=this.data.substring(n+e);t=r+t+i,this.nodeValue=this.data=t,this.length=t.length}};rn(Xs,qt);function yu(){}yu.prototype={nodeName:"#text",nodeType:ma,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};rn(yu,Xs);function wu(){}wu.prototype={nodeName:"#comment",nodeType:Gf};rn(wu,Xs);function bu(){}bu.prototype={nodeName:"#cdata-section",nodeType:Bf};rn(bu,Xs);function Cu(){}Cu.prototype.nodeType=Yf;rn(Cu,qt);function ah(){}ah.prototype.nodeType=hD;rn(ah,qt);function ch(){}ch.prototype.nodeType=fD;rn(ch,qt);function Du(){}Du.prototype.nodeType=Xf;rn(Du,qt);function wa(){}wa.prototype.nodeName="#document-fragment";wa.prototype.nodeType=br;rn(wa,qt);function Tu(){}Tu.prototype.nodeType=zf;rn(Tu,qt);function uh(){}uh.prototype.serializeToString=function(n,e,t){return lh.call(n,e,t)};qt.prototype.toString=lh;function lh(n,e){var t=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,s=r.namespaceURI;if(s&&i==null){var i=r.lookupPrefix(s);if(i==null)var o=[{namespace:s,prefix:null}]}return Qi(this,t,n,e,o),t.join("")}function dh(n,e,t){var r=n.prefix||"",i=n.namespaceURI;if(!r&&!i||r==="xml"&&i==="http://www.w3.org/XML/1998/namespace"||i=="http://www.w3.org/2000/xmlns/")return!1;for(var s=t.length;s--;){var o=t[s];if(o.prefix==r)return o.namespace!=i}return!0}function Qi(n,e,t,r,i){if(r)if(n=r(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case Mn:i||(i=[]);var s=i.length,o=n.attributes,a=o.length,c=n.firstChild,u=n.tagName;t=dD===n.namespaceURI||t,e.push("<",u);for(var l=0;l<a;l++){var h=o.item(l);h.prefix=="xmlns"?i.push({prefix:h.localName,namespace:h.value}):h.nodeName=="xmlns"&&i.push({prefix:"",namespace:h.value})}for(var l=0;l<a;l++){var h=o.item(l);if(dh(h,t,i)){var f=h.prefix||"",C=h.namespaceURI,b=f?" xmlns:"+f:" xmlns";e.push(b,'="',C,'"'),i.push({prefix:f,namespace:C})}Qi(h,e,t,r,i)}if(dh(n,t,i)){var f=n.prefix||"",C=n.namespaceURI;if(C){var b=f?" xmlns:"+f:" xmlns";e.push(b,'="',C,'"'),i.push({prefix:f,namespace:C})}}if(c||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(e.push(">"),t&&/^script$/i.test(u))for(;c;)c.data?e.push(c.data):Qi(c,e,t,r,i),c=c.nextSibling;else for(;c;)Qi(c,e,t,r,i),c=c.nextSibling;e.push("</",u,">")}else e.push("/>");return;case Qf:case br:for(var c=n.firstChild;c;)Qi(c,e,t,r,i),c=c.nextSibling;return;case Xi:return e.push(" ",n.name,'="',n.value.replace(/[<&"]/g,rh),'"');case ma:return e.push(n.data.replace(/[<&]/g,rh).replace(/]]>/g,"]]&gt;"));case Bf:return e.push("<![CDATA[",n.data,"]]>");case Gf:return e.push("<!--",n.data,"-->");case Yf:var y=n.publicId,S=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),S&&S!="."&&e.push(" ",S),e.push(">");else if(S&&S!=".")e.push(" SYSTEM ",S,">");else{var k=n.internalSubset;k&&e.push(" [",k,"]"),e.push(">")}return;case zf:return e.push("<?",n.target," ",n.data,"?>");case Xf:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function fh(n,e,t){var r;switch(e.nodeType){case Mn:r=e.cloneNode(!1),r.ownerDocument=n;case br:break;case Xi:t=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,t)for(var i=e.firstChild;i;)r.appendChild(fh(n,i,t)),i=i.nextSibling;return r}function Su(n,e,t){var r=new e.constructor;for(var i in e){var s=e[i];typeof s!="object"&&s!=r[i]&&(r[i]=s)}switch(e.childNodes&&(r.childNodes=new Qr),r.ownerDocument=n,r.nodeType){case Mn:var o=e.attributes,a=r.attributes=new va,c=o.length;a._ownerElement=r;for(var u=0;u<c;u++)r.setAttributeNode(Su(n,o.item(u),!0));break;case Xi:t=!0}if(t)for(var l=e.firstChild;l;)r.appendChild(Su(n,l,t)),l=l.nextSibling;return r}function hh(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case Mn:case br:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};gF=n,Object.defineProperty(zi.prototype,"length",{get:function(){return mu(this),this.$$length}}),Object.defineProperty(qt.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case Mn:case br:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),hh=function(e,t,r){e["$$"+t]=r}}}catch{}var gF;zs.Node=qt;zs.DOMException=pi;zs.DOMImplementation=nh;zs.XMLSerializer=uh});var vh=L(Qs=>{function ph(n){this.options=n||{locator:{}}}ph.prototype.parseFromString=function(n,e){var t=this.options,r=new bD,i=t.domBuilder||new Gs,s=t.errorHandler,o=t.locator,a=t.xmlns||{},c=/\/x?html?$/.test(e),u=c?wD.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return o&&i.setDocumentLocator(o),r.errorHandler=yD(s,i,o),r.domBuilder=t.domBuilder||i,c&&(a[""]="http://www.w3.org/1999/xhtml"),a.xml=a.xml||"http://www.w3.org/XML/1998/namespace",n&&typeof n=="string"?r.parse(n,a,u):r.errorHandler.error("invalid doc source"),i.doc};function yD(n,e,t){if(!n){if(e instanceof Gs)return e;n=e}var r={},i=n instanceof Function;t=t||{};function s(o){var a=n[o];!a&&i&&(a=n.length==2?function(c){n(o,c)}:n),r[o]=a&&function(c){a("[xmldom "+o+"]	"+c+Ru(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),r}function Gs(){this.cdata=!1}function Yi(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}Gs.prototype={startDocument:function(){this.doc=new DD().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,r){var i=this.doc,s=i.createElementNS(n,t||e),o=r.length;ba(this,s),this.currentElement=s,this.locator&&Yi(this.locator,s);for(var a=0;a<o;a++){var n=r.getURI(a),c=r.getValue(a),t=r.getQName(a),u=i.createAttributeNS(n,t);this.locator&&Yi(r.getLocator(a),u),u.value=u.nodeValue=c,s.setAttributeNode(u)}},endElement:function(n,e,t){var r=this.currentElement,i=r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&Yi(this.locator,t),ba(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=gh.apply(this,arguments),n){if(this.cdata)var r=this.doc.createCDATASection(n);else var r=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(n)&&this.doc.appendChild(r),this.locator&&Yi(this.locator,r)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=gh.apply(this,arguments);var r=this.doc.createComment(n);this.locator&&Yi(this.locator,r),ba(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(n,e,t);this.locator&&Yi(this.locator,i),ba(this,i)}},warning:function(n){console.warn("[xmldom warning]	"+n,Ru(this.locator))},error:function(n){console.error("[xmldom error]	"+n,Ru(this.locator))},fatalError:function(n){throw new CD(n,this.locator)}};function Ru(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function gh(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){Gs.prototype[n]=function(){return null}});function ba(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}var wD=Mf(),mh=Vf(),bD=mh.XMLReader,CD=mh.ParseError,DD=Qs.DOMImplementation=ku().DOMImplementation;Qs.XMLSerializer=ku().XMLSerializer;Qs.DOMParser=ph;Qs.__DOMHandler=Gs});var bh=L(wh=>{var TD=vh().DOMParser;wh.parse=kD;var Ca=3,yh=4,SD=8;function Pu(n){return n.nodeType===Ca||n.nodeType===SD||n.nodeType===yh}function Cr(n){return!n.childNodes||n.childNodes.length===0}function gi(n,e){if(!n)throw new Error(e)}function kD(n){var e=new TD().parseFromString(n);gi(e.documentElement.nodeName==="plist","malformed document. First element should be <plist>");var t=Ji(e.documentElement);return t.length==1&&(t=t[0]),t}function Ji(n){var e,t,r,i,s,o,a,c;if(!n)return null;if(n.nodeName==="plist"){if(s=[],Cr(n))return s;for(e=0;e<n.childNodes.length;e++)Pu(n.childNodes[e])||s.push(Ji(n.childNodes[e]));return s}else if(n.nodeName==="dict"){if(t={},r=null,a=0,Cr(n))return t;for(e=0;e<n.childNodes.length;e++)Pu(n.childNodes[e])||(a%2==0?(gi(n.childNodes[e].nodeName==="key","Missing key while parsing <dict/>."),r=Ji(n.childNodes[e])):(gi(n.childNodes[e].nodeName!=="key",'Unexpected key "'+Ji(n.childNodes[e])+'" while parsing <dict/>.'),t[r]=Ji(n.childNodes[e])),a+=1);if(a%2==1)throw new Error('Missing value for "'+r+'" while parsing <dict/>');return t}else if(n.nodeName==="array"){if(s=[],Cr(n))return s;for(e=0;e<n.childNodes.length;e++)Pu(n.childNodes[e])||(o=Ji(n.childNodes[e]),o!=null&&s.push(o));return s}else if(n.nodeName!=="#text"){if(n.nodeName==="key")return Cr(n)?"":(gi(n.childNodes[0].nodeValue!=="__proto__","__proto__ keys can lead to prototype pollution. More details on CVE-2022-22912"),n.childNodes[0].nodeValue);if(n.nodeName==="string"){if(o="",Cr(n))return o;for(e=0;e<n.childNodes.length;e++){var c=n.childNodes[e].nodeType;(c===Ca||c===yh)&&(o+=n.childNodes[e].nodeValue)}return o}else{if(n.nodeName==="integer")return gi(!Cr(n),'Cannot parse "" as integer.'),parseInt(n.childNodes[0].nodeValue,10);if(n.nodeName==="real"){for(gi(!Cr(n),'Cannot parse "" as real.'),o="",e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===Ca&&(o+=n.childNodes[e].nodeValue);return parseFloat(o)}else if(n.nodeName==="data"){if(o="",Cr(n))return Buffer.from(o,"base64");for(e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===Ca&&(o+=n.childNodes[e].nodeValue.replace(/\s+/g,""));return Buffer.from(o,"base64")}else{if(n.nodeName==="date")return gi(!Cr(n),'Cannot parse "" as Date.'),new Date(n.childNodes[0].nodeValue);if(n.nodeName==="true")return!0;if(n.nodeName==="false")return!1}}}}});var Th=L(Da=>{"use strict";Da.byteLength=PD;Da.toByteArray=ED;Da.fromByteArray=ID;var ir=[],Rn=[],RD=typeof Uint8Array!="undefined"?Uint8Array:Array,_u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(mi=0,Ch=_u.length;mi<Ch;++mi)ir[mi]=_u[mi],Rn[_u.charCodeAt(mi)]=mi;var mi,Ch;Rn["-".charCodeAt(0)]=62;Rn["_".charCodeAt(0)]=63;function Dh(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function PD(n){var e=Dh(n),t=e[0],r=e[1];return(t+r)*3/4-r}function _D(n,e,t){return(e+t)*3/4-t}function ED(n){var e,t=Dh(n),r=t[0],i=t[1],s=new RD(_D(n,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Rn[n.charCodeAt(c)]<<18|Rn[n.charCodeAt(c+1)]<<12|Rn[n.charCodeAt(c+2)]<<6|Rn[n.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Rn[n.charCodeAt(c)]<<2|Rn[n.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Rn[n.charCodeAt(c)]<<10|Rn[n.charCodeAt(c+1)]<<4|Rn[n.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function xD(n){return ir[n>>18&63]+ir[n>>12&63]+ir[n>>6&63]+ir[n&63]}function FD(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(xD(r));return i.join("")}function ID(n){for(var e,t=n.length,r=t%3,i=[],s=16383,o=0,a=t-r;o<a;o+=s)i.push(FD(n,o,o+s>a?a:o+s));return r===1?(e=n[t-1],i.push(ir[e>>2]+ir[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(ir[e>>10]+ir[e>>4&63]+ir[e<<2&63]+"=")),i.join("")}});var Dr=L((Sh,vi)=>{(function(){var n,e,t,r,i,s,o=[].slice,a={}.hasOwnProperty;n=function(){var c,u,l,h,f,C;if(C=arguments[0],f=2<=arguments.length?o.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(c=0,l=f.length;c<l;c++)if(h=f[c],h!=null)for(u in h)!a.call(h,u)||(C[u]=h[u]);return C},r=function(c){return!!c&&Object.prototype.toString.call(c)==="[object Function]"},i=function(c){var u;return!!c&&((u=typeof c)==="function"||u==="object")},e=function(c){return r(Array.isArray)?Array.isArray(c):Object.prototype.toString.call(c)==="[object Array]"},t=function(c){var u;if(e(c))return!c.length;for(u in c)if(!!a.call(c,u))return!1;return!0},s=function(c){var u,l;return i(c)&&(l=Object.getPrototypeOf(c))&&(u=l.constructor)&&typeof u=="function"&&u instanceof u&&Function.prototype.toString.call(u)===Function.prototype.toString.call(Object)},vi.exports.assign=n,vi.exports.isFunction=r,vi.exports.isObject=i,vi.exports.isArray=e,vi.exports.isEmpty=t,vi.exports.isPlainObject=s}).call(Sh)});var Eu=L((kh,Rh)=>{(function(){var n;Rh.exports=n=function(){function e(t,r,i){if(this.options=t.options,this.stringify=t.stringify,r==null)throw new Error("Missing attribute name of element "+t.name);if(i==null)throw new Error("Missing attribute value for attribute "+r+" of element "+t.name);this.name=this.stringify.attName(r),this.value=this.stringify.attValue(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},e}()}).call(kh)});var Ys=L((Ph,_h)=>{(function(){var n,e,t,r,i,s,o=function(c,u){for(var l in u)a.call(u,l)&&(c[l]=u[l]);function h(){this.constructor=c}return h.prototype=u.prototype,c.prototype=new h,c.__super__=u.prototype,c},a={}.hasOwnProperty;s=Dr(),i=s.isObject,r=s.isFunction,t=on(),n=Eu(),_h.exports=e=function(c){o(u,c);function u(l,h,f){if(u.__super__.constructor.call(this,l),h==null)throw new Error("Missing element name");this.name=this.stringify.eleName(h),this.attributes={},f!=null&&this.attribute(f),l.isDocument&&(this.isRoot=!0,this.documentObject=l,l.rootObject=this)}return u.prototype.clone=function(){var l,h,f,C;f=Object.create(this),f.isRoot&&(f.documentObject=null),f.attributes={},C=this.attributes;for(h in C)!a.call(C,h)||(l=C[h],f.attributes[h]=l.clone());return f.children=[],this.children.forEach(function(b){var y;return y=b.clone(),y.parent=f,f.children.push(y)}),f},u.prototype.attribute=function(l,h){var f,C;if(l!=null&&(l=l.valueOf()),i(l))for(f in l)!a.call(l,f)||(C=l[f],this.attribute(f,C));else r(h)&&(h=h.apply()),(!this.options.skipNullAttributes||h!=null)&&(this.attributes[l]=new n(this,l,h));return this},u.prototype.removeAttribute=function(l){var h,f,C;if(l==null)throw new Error("Missing attribute name");if(l=l.valueOf(),Array.isArray(l))for(f=0,C=l.length;f<C;f++)h=l[f],delete this.attributes[h];else delete this.attributes[l];return this},u.prototype.toString=function(l){return this.options.writer.set(l).element(this)},u.prototype.att=function(l,h){return this.attribute(l,h)},u.prototype.a=function(l,h){return this.attribute(l,h)},u}(t)}).call(Ph)});var Js=L((Eh,xh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=on(),xh.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).cdata(this)},s}(e)}).call(Eh)});var Zs=L((Fh,Ih)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=on(),Ih.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing comment text");this.text=this.stringify.comment(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).comment(this)},s}(e)}).call(Fh)});var eo=L((Oh,Nh)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Dr().isObject,e=on(),Nh.exports=n=function(s){r(o,s);function o(a,c,u,l){var h;o.__super__.constructor.call(this,a),t(c)&&(h=c,c=h.version,u=h.encoding,l=h.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),u!=null&&(this.encoding=this.stringify.xmlEncoding(u)),l!=null&&(this.standalone=this.stringify.xmlStandalone(l))}return o.prototype.toString=function(a){return this.options.writer.set(a).declaration(this)},o}(e)}).call(Oh)});var to=L((qh,Lh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=on(),Lh.exports=n=function(i){t(s,i);function s(o,a,c,u,l,h){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");if(c==null)throw new Error("Missing DTD attribute name");if(!u)throw new Error("Missing DTD attribute type");if(!l)throw new Error("Missing DTD attribute default");if(l.indexOf("#")!==0&&(l="#"+l),!l.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(h&&!l.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(a),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(u),this.defaultValue=this.stringify.dtdAttDefault(h),this.defaultValueType=l}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdAttList(this)},s}(e)}).call(qh)});var no=L((Mh,Ah)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Dr().isObject,e=on(),Ah.exports=n=function(s){r(o,s);function o(a,c,u,l){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing entity name");if(l==null)throw new Error("Missing entity value");if(this.pe=!!c,this.name=this.stringify.eleName(u),!t(l))this.value=this.stringify.dtdEntityValue(l);else{if(!l.pubID&&!l.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(l.pubID&&!l.sysID)throw new Error("System identifier is required for a public external entity");if(l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID)),l.nData!=null&&(this.nData=this.stringify.dtdNData(l.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}}return o.prototype.toString=function(a){return this.options.writer.set(a).dtdEntity(this)},o}(e)}).call(Mh)});var ro=L(($h,jh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=on(),jh.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(a),this.value=this.stringify.dtdElementValue(c)}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdElement(this)},s}(e)}).call($h)});var io=L((Wh,Hh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=on(),Hh.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(a),c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdNotation(this)},s}(e)}).call(Wh)});var so=L((Uh,Kh)=>{(function(){var n,e,t,r,i,s,o,a=function(u,l){for(var h in l)c.call(l,h)&&(u[h]=l[h]);function f(){this.constructor=u}return f.prototype=l.prototype,u.prototype=new f,u.__super__=l.prototype,u},c={}.hasOwnProperty;o=Dr().isObject,s=on(),n=to(),t=no(),e=ro(),r=io(),Kh.exports=i=function(u){a(l,u);function l(h,f,C){var b,y;l.__super__.constructor.call(this,h),this.documentObject=h,o(f)&&(b=f,f=b.pubID,C=b.sysID),C==null&&(y=[f,C],C=y[0],f=y[1]),f!=null&&(this.pubID=this.stringify.dtdPubID(f)),C!=null&&(this.sysID=this.stringify.dtdSysID(C))}return l.prototype.element=function(h,f){var C;return C=new e(this,h,f),this.children.push(C),this},l.prototype.attList=function(h,f,C,b,y){var S;return S=new n(this,h,f,C,b,y),this.children.push(S),this},l.prototype.entity=function(h,f){var C;return C=new t(this,!1,h,f),this.children.push(C),this},l.prototype.pEntity=function(h,f){var C;return C=new t(this,!0,h,f),this.children.push(C),this},l.prototype.notation=function(h,f){var C;return C=new r(this,h,f),this.children.push(C),this},l.prototype.toString=function(h){return this.options.writer.set(h).docType(this)},l.prototype.ele=function(h,f){return this.element(h,f)},l.prototype.att=function(h,f,C,b,y){return this.attList(h,f,C,b,y)},l.prototype.ent=function(h,f){return this.entity(h,f)},l.prototype.pent=function(h,f){return this.pEntity(h,f)},l.prototype.not=function(h,f){return this.notation(h,f)},l.prototype.up=function(){return this.root()||this.documentObject},l}(s)}).call(Uh)});var oo=L((Vh,Bh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=on(),Bh.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing raw text");this.value=this.stringify.raw(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).raw(this)},s}(n)}).call(Vh)});var ao=L((Xh,zh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=on(),zh.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing element text");this.value=this.stringify.eleText(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).text(this)},s}(n)}).call(Xh)});var co=L((Gh,Qh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=on(),Qh.exports=e=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(a),c&&(this.value=this.stringify.insValue(c))}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).processingInstruction(this)},s}(n)}).call(Gh)});var on=L((Yh,Jh)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C={}.hasOwnProperty;f=Dr(),h=f.isObject,l=f.isFunction,u=f.isEmpty,i=null,n=null,e=null,t=null,r=null,a=null,c=null,o=null,Jh.exports=s=function(){function b(y){this.parent=y,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],i||(i=Ys(),n=Js(),e=Zs(),t=eo(),r=so(),a=oo(),c=ao(),o=co())}return b.prototype.element=function(y,S,k){var v,D,R,x,F,N,U,J,te,ie;if(N=null,S==null&&(S={}),S=S.valueOf(),h(S)||(te=[S,k],k=te[0],S=te[1]),y!=null&&(y=y.valueOf()),Array.isArray(y))for(R=0,U=y.length;R<U;R++)D=y[R],N=this.element(D);else if(l(y))N=this.element(y.apply());else if(h(y)){for(F in y)if(!!C.call(y,F))if(ie=y[F],l(ie)&&(ie=ie.apply()),h(ie)&&u(ie)&&(ie=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&F.indexOf(this.stringify.convertAttKey)===0)N=this.attribute(F.substr(this.stringify.convertAttKey.length),ie);else if(!this.options.separateArrayItems&&Array.isArray(ie))for(x=0,J=ie.length;x<J;x++)D=ie[x],v={},v[F]=D,N=this.element(v);else h(ie)?(N=this.element(F),N.element(ie)):N=this.element(F,ie)}else!this.options.ignoreDecorators&&this.stringify.convertTextKey&&y.indexOf(this.stringify.convertTextKey)===0?N=this.text(k):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&y.indexOf(this.stringify.convertCDataKey)===0?N=this.cdata(k):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&y.indexOf(this.stringify.convertCommentKey)===0?N=this.comment(k):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&y.indexOf(this.stringify.convertRawKey)===0?N=this.raw(k):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&y.indexOf(this.stringify.convertPIKey)===0?N=this.instruction(y.substr(this.stringify.convertPIKey.length),k):N=this.node(y,S,k);if(N==null)throw new Error("Could not create any elements with: "+y);return N},b.prototype.insertBefore=function(y,S,k){var v,D,R;if(this.isRoot)throw new Error("Cannot insert elements at root level");return D=this.parent.children.indexOf(this),R=this.parent.children.splice(D),v=this.parent.element(y,S,k),Array.prototype.push.apply(this.parent.children,R),v},b.prototype.insertAfter=function(y,S,k){var v,D,R;if(this.isRoot)throw new Error("Cannot insert elements at root level");return D=this.parent.children.indexOf(this),R=this.parent.children.splice(D+1),v=this.parent.element(y,S,k),Array.prototype.push.apply(this.parent.children,R),v},b.prototype.remove=function(){var y,S;if(this.isRoot)throw new Error("Cannot remove the root element");return y=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[y,y-y+1].concat(S=[])),this.parent},b.prototype.node=function(y,S,k){var v,D;return y!=null&&(y=y.valueOf()),S||(S={}),S=S.valueOf(),h(S)||(D=[S,k],k=D[0],S=D[1]),v=new i(this,y,S),k!=null&&v.text(k),this.children.push(v),v},b.prototype.text=function(y){var S;return S=new c(this,y),this.children.push(S),this},b.prototype.cdata=function(y){var S;return S=new n(this,y),this.children.push(S),this},b.prototype.comment=function(y){var S;return S=new e(this,y),this.children.push(S),this},b.prototype.commentBefore=function(y){var S,k,v;return k=this.parent.children.indexOf(this),v=this.parent.children.splice(k),S=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},b.prototype.commentAfter=function(y){var S,k,v;return k=this.parent.children.indexOf(this),v=this.parent.children.splice(k+1),S=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},b.prototype.raw=function(y){var S;return S=new a(this,y),this.children.push(S),this},b.prototype.instruction=function(y,S){var k,v,D,R,x;if(y!=null&&(y=y.valueOf()),S!=null&&(S=S.valueOf()),Array.isArray(y))for(R=0,x=y.length;R<x;R++)k=y[R],this.instruction(k);else if(h(y))for(k in y)!C.call(y,k)||(v=y[k],this.instruction(k,v));else l(S)&&(S=S.apply()),D=new o(this,y,S),this.children.push(D);return this},b.prototype.instructionBefore=function(y,S){var k,v,D;return v=this.parent.children.indexOf(this),D=this.parent.children.splice(v),k=this.parent.instruction(y,S),Array.prototype.push.apply(this.parent.children,D),this},b.prototype.instructionAfter=function(y,S){var k,v,D;return v=this.parent.children.indexOf(this),D=this.parent.children.splice(v+1),k=this.parent.instruction(y,S),Array.prototype.push.apply(this.parent.children,D),this},b.prototype.declaration=function(y,S,k){var v,D;return v=this.document(),D=new t(v,y,S,k),v.children[0]instanceof t?v.children[0]=D:v.children.unshift(D),v.root()||v},b.prototype.doctype=function(y,S){var k,v,D,R,x,F,N,U,J,te;for(v=this.document(),D=new r(v,y,S),J=v.children,R=x=0,N=J.length;x<N;R=++x)if(k=J[R],k instanceof r)return v.children[R]=D,D;for(te=v.children,R=F=0,U=te.length;F<U;R=++F)if(k=te[R],k.isRoot)return v.children.splice(R,0,D),D;return v.children.push(D),D},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var y;for(y=this;y;){if(y.isDocument)return y.rootObject;if(y.isRoot)return y;y=y.parent}},b.prototype.document=function(){var y;for(y=this;y;){if(y.isDocument)return y;y=y.parent}},b.prototype.end=function(y){return this.document().end(y)},b.prototype.prev=function(){var y;if(y=this.parent.children.indexOf(this),y<1)throw new Error("Already at the first node");return this.parent.children[y-1]},b.prototype.next=function(){var y;if(y=this.parent.children.indexOf(this),y===-1||y===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[y+1]},b.prototype.importDocument=function(y){var S;return S=y.root().clone(),S.parent=this,S.isRoot=!1,this.children.push(S),this},b.prototype.ele=function(y,S,k){return this.element(y,S,k)},b.prototype.nod=function(y,S,k){return this.node(y,S,k)},b.prototype.txt=function(y){return this.text(y)},b.prototype.dat=function(y){return this.cdata(y)},b.prototype.com=function(y){return this.comment(y)},b.prototype.ins=function(y,S){return this.instruction(y,S)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(y,S,k){return this.declaration(y,S,k)},b.prototype.dtd=function(y,S){return this.doctype(y,S)},b.prototype.e=function(y,S,k){return this.element(y,S,k)},b.prototype.n=function(y,S,k){return this.node(y,S,k)},b.prototype.t=function(y){return this.text(y)},b.prototype.d=function(y){return this.cdata(y)},b.prototype.c=function(y){return this.comment(y)},b.prototype.r=function(y){return this.raw(y)},b.prototype.i=function(y,S){return this.instruction(y,S)},b.prototype.u=function(){return this.up()},b.prototype.importXMLBuilder=function(y){return this.importDocument(y)},b}()}).call(Yh)});var xu=L((Zh,ep)=>{(function(){var n,e=function(r,i){return function(){return r.apply(i,arguments)}},t={}.hasOwnProperty;ep.exports=n=function(){function r(i){this.assertLegalChar=e(this.assertLegalChar,this);var s,o,a;i||(i={}),this.noDoubleEncoding=i.noDoubleEncoding,o=i.stringify||{};for(s in o)!t.call(o,s)||(a=o[s],this[s]=a)}return r.prototype.eleName=function(i){return i=""+i||"",this.assertLegalChar(i)},r.prototype.eleText=function(i){return i=""+i||"",this.assertLegalChar(this.elEscape(i))},r.prototype.cdata=function(i){return i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i)},r.prototype.comment=function(i){if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},r.prototype.raw=function(i){return""+i||""},r.prototype.attName=function(i){return i=""+i||""},r.prototype.attValue=function(i){return i=""+i||"",this.attEscape(i)},r.prototype.insTarget=function(i){return""+i||""},r.prototype.insValue=function(i){if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return i},r.prototype.xmlVersion=function(i){if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},r.prototype.xmlEncoding=function(i){if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return i},r.prototype.xmlStandalone=function(i){return i?"yes":"no"},r.prototype.dtdPubID=function(i){return""+i||""},r.prototype.dtdSysID=function(i){return""+i||""},r.prototype.dtdElementValue=function(i){return""+i||""},r.prototype.dtdAttType=function(i){return""+i||""},r.prototype.dtdAttDefault=function(i){return i!=null?""+i||"":i},r.prototype.dtdEntityValue=function(i){return""+i||""},r.prototype.dtdNData=function(i){return""+i||""},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(i){var s;if(s=i.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),s)throw new Error("Invalid character in string: "+i+" at index "+s.index);return i},r.prototype.elEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},r.prototype.attEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},r}()}).call(Zh)});var Fu=L((tp,np)=>{(function(){var n,e={}.hasOwnProperty;np.exports=n=function(){function t(r){var i,s,o,a,c,u,l,h,f;r||(r={}),this.pretty=r.pretty||!1,this.allowEmpty=(s=r.allowEmpty)!=null?s:!1,this.pretty?(this.indent=(o=r.indent)!=null?o:"  ",this.newline=(a=r.newline)!=null?a:`
`,this.offset=(c=r.offset)!=null?c:0,this.dontprettytextnodes=(u=r.dontprettytextnodes)!=null?u:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(l=r.spacebeforeslash)!=null?l:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,h=r.writer||{};for(i in h)!e.call(h,i)||(f=h[i],this[i]=f)}return t.prototype.set=function(r){var i,s,o;r||(r={}),"pretty"in r&&(this.pretty=r.pretty),"allowEmpty"in r&&(this.allowEmpty=r.allowEmpty),this.pretty?(this.indent="indent"in r?r.indent:"  ",this.newline="newline"in r?r.newline:`
`,this.offset="offset"in r?r.offset:0,this.dontprettytextnodes="dontprettytextnodes"in r?r.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in r?r.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,s=r.writer||{};for(i in s)!e.call(s,i)||(o=s[i],this[i]=o);return this},t.prototype.space=function(r){var i;return this.pretty?(i=(r||0)+this.offset+1,i>0?new Array(i).join(this.indent):""):""},t}()}).call(tp)});var Ta=L((rp,ip)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b=function(S,k){for(var v in k)y.call(k,v)&&(S[v]=k[v]);function D(){this.constructor=S}return D.prototype=k.prototype,S.prototype=new D,S.__super__=k.prototype,S},y={}.hasOwnProperty;o=eo(),a=so(),n=Js(),e=Zs(),c=Ys(),l=oo(),f=ao(),u=co(),t=to(),r=ro(),i=no(),s=io(),C=Fu(),ip.exports=h=function(S){b(k,S);function k(v){k.__super__.constructor.call(this,v)}return k.prototype.document=function(v){var D,R,x,F,N;for(this.textispresent=!1,F="",N=v.children,R=0,x=N.length;R<x;R++)D=N[R],F+=function(){switch(!1){case!(D instanceof o):return this.declaration(D);case!(D instanceof a):return this.docType(D);case!(D instanceof e):return this.comment(D);case!(D instanceof u):return this.processingInstruction(D);default:return this.element(D,0)}}.call(this);return this.pretty&&F.slice(-this.newline.length)===this.newline&&(F=F.slice(0,-this.newline.length)),F},k.prototype.attribute=function(v){return" "+v.name+'="'+v.value+'"'},k.prototype.cdata=function(v,D){return this.space(D)+"<![CDATA["+v.text+"]]>"+this.newline},k.prototype.comment=function(v,D){return this.space(D)+"<!-- "+v.text+" -->"+this.newline},k.prototype.declaration=function(v,D){var R;return R=this.space(D),R+='<?xml version="'+v.version+'"',v.encoding!=null&&(R+=' encoding="'+v.encoding+'"'),v.standalone!=null&&(R+=' standalone="'+v.standalone+'"'),R+=this.spacebeforeslash+"?>",R+=this.newline,R},k.prototype.docType=function(v,D){var R,x,F,N,U;if(D||(D=0),N=this.space(D),N+="<!DOCTYPE "+v.root().name,v.pubID&&v.sysID?N+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(N+=' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(N+=" [",N+=this.newline,U=v.children,x=0,F=U.length;x<F;x++)R=U[x],N+=function(){switch(!1){case!(R instanceof t):return this.dtdAttList(R,D+1);case!(R instanceof r):return this.dtdElement(R,D+1);case!(R instanceof i):return this.dtdEntity(R,D+1);case!(R instanceof s):return this.dtdNotation(R,D+1);case!(R instanceof n):return this.cdata(R,D+1);case!(R instanceof e):return this.comment(R,D+1);case!(R instanceof u):return this.processingInstruction(R,D+1);default:throw new Error("Unknown DTD node type: "+R.constructor.name)}}.call(this);N+="]"}return N+=this.spacebeforeslash+">",N+=this.newline,N},k.prototype.element=function(v,D){var R,x,F,N,U,J,te,ie,Ee,Dt,ut,lt,ve;D||(D=0),ve=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),lt=this.space(D),ie="",ie+=lt+"<"+v.name,Ee=v.attributes;for(te in Ee)!y.call(Ee,te)||(R=Ee[te],ie+=this.attribute(R));if(v.children.length===0||v.children.every(function(Ze){return Ze.value===""}))this.allowEmpty?ie+="></"+v.name+">"+this.newline:ie+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)ie+=">",ie+=v.children[0].value,ie+="</"+v.name+">"+this.newline;else{if(this.dontprettytextnodes){for(Dt=v.children,F=0,U=Dt.length;F<U;F++)if(x=Dt[F],x.value!=null){this.textispresent++,ve=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,lt=this.space(D)),ie+=">"+this.newline,ut=v.children,N=0,J=ut.length;N<J;N++)x=ut[N],ie+=function(){switch(!1){case!(x instanceof n):return this.cdata(x,D+1);case!(x instanceof e):return this.comment(x,D+1);case!(x instanceof c):return this.element(x,D+1);case!(x instanceof l):return this.raw(x,D+1);case!(x instanceof f):return this.text(x,D+1);case!(x instanceof u):return this.processingInstruction(x,D+1);default:throw new Error("Unknown XML node type: "+x.constructor.name)}}.call(this);ve&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),ie+=lt+"</"+v.name+">"+this.newline}return ie},k.prototype.processingInstruction=function(v,D){var R;return R=this.space(D)+"<?"+v.target,v.value&&(R+=" "+v.value),R+=this.spacebeforeslash+"?>"+this.newline,R},k.prototype.raw=function(v,D){return this.space(D)+v.value+this.newline},k.prototype.text=function(v,D){return this.space(D)+v.value+this.newline},k.prototype.dtdAttList=function(v,D){var R;return R=this.space(D)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType,v.defaultValueType!=="#DEFAULT"&&(R+=" "+v.defaultValueType),v.defaultValue&&(R+=' "'+v.defaultValue+'"'),R+=this.spacebeforeslash+">"+this.newline,R},k.prototype.dtdElement=function(v,D){return this.space(D)+"<!ELEMENT "+v.name+" "+v.value+this.spacebeforeslash+">"+this.newline},k.prototype.dtdEntity=function(v,D){var R;return R=this.space(D)+"<!ENTITY",v.pe&&(R+=" %"),R+=" "+v.name,v.value?R+=' "'+v.value+'"':(v.pubID&&v.sysID?R+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(R+=' SYSTEM "'+v.sysID+'"'),v.nData&&(R+=" NDATA "+v.nData)),R+=this.spacebeforeslash+">"+this.newline,R},k.prototype.dtdNotation=function(v,D){var R;return R=this.space(D)+"<!NOTATION "+v.name,v.pubID&&v.sysID?R+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.pubID?R+=' PUBLIC "'+v.pubID+'"':v.sysID&&(R+=' SYSTEM "'+v.sysID+'"'),R+=this.spacebeforeslash+">"+this.newline,R},k.prototype.openNode=function(v,D){var R,x,F,N;if(D||(D=0),v instanceof c){F=this.space(D)+"<"+v.name,N=v.attributes;for(x in N)!y.call(N,x)||(R=N[x],F+=this.attribute(R));return F+=(v.children?">":"/>")+this.newline,F}else return F=this.space(D)+"<!DOCTYPE "+v.rootNodeName,v.pubID&&v.sysID?F+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(F+=' SYSTEM "'+v.sysID+'"'),F+=(v.children?" [":">")+this.newline,F},k.prototype.closeNode=function(v,D){switch(D||(D=0),!1){case!(v instanceof c):return this.space(D)+"</"+v.name+">"+this.newline;case!(v instanceof a):return this.space(D)+"]>"+this.newline}},k}(C)}).call(rp)});var ap=L((sp,op)=>{(function(){var n,e,t,r,i,s=function(a,c){for(var u in c)o.call(c,u)&&(a[u]=c[u]);function l(){this.constructor=a}return l.prototype=c.prototype,a.prototype=new l,a.__super__=c.prototype,a},o={}.hasOwnProperty;i=Dr().isPlainObject,e=on(),r=xu(),t=Ta(),op.exports=n=function(a){s(c,a);function c(u){c.__super__.constructor.call(this,null),u||(u={}),u.writer||(u.writer=new t),this.options=u,this.stringify=new r(u),this.isDocument=!0}return c.prototype.end=function(u){var l;return u?i(u)&&(l=u,u=this.options.writer.set(l)):u=this.options.writer,u.document(this)},c.prototype.toString=function(u){return this.options.writer.set(u).document(this)},c}(e)}).call(sp)});var lp=L((cp,up)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b,y,S,k,v,D,R={}.hasOwnProperty;D=Dr(),k=D.isObject,S=D.isFunction,v=D.isPlainObject,l=Ys(),e=Js(),t=Zs(),f=oo(),y=ao(),h=co(),a=eo(),c=so(),r=to(),s=no(),i=ro(),o=io(),n=Eu(),b=xu(),C=Ta(),up.exports=u=function(){function x(F,N,U){var J;F||(F={}),F.writer?v(F.writer)&&(J=F.writer,F.writer=new C(J)):F.writer=new C(F),this.options=F,this.writer=F.writer,this.stringify=new b(F),this.onDataCallback=N||function(){},this.onEndCallback=U||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return x.prototype.node=function(F,N,U){var J;if(F==null)throw new Error("Missing node name");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node");return this.openCurrent(),F=F.valueOf(),N==null&&(N={}),N=N.valueOf(),k(N)||(J=[N,U],U=J[0],N=J[1]),this.currentNode=new l(this,F,N),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,U!=null&&this.text(U),this},x.prototype.element=function(F,N,U){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(F,N,U)},x.prototype.attribute=function(F,N){var U,J;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode");if(F!=null&&(F=F.valueOf()),k(F))for(U in F)!R.call(F,U)||(J=F[U],this.attribute(U,J));else S(N)&&(N=N.apply()),(!this.options.skipNullAttributes||N!=null)&&(this.currentNode.attributes[F]=new n(this,F,N));return this},x.prototype.text=function(F){var N;return this.openCurrent(),N=new y(this,F),this.onData(this.writer.text(N,this.currentLevel+1)),this},x.prototype.cdata=function(F){var N;return this.openCurrent(),N=new e(this,F),this.onData(this.writer.cdata(N,this.currentLevel+1)),this},x.prototype.comment=function(F){var N;return this.openCurrent(),N=new t(this,F),this.onData(this.writer.comment(N,this.currentLevel+1)),this},x.prototype.raw=function(F){var N;return this.openCurrent(),N=new f(this,F),this.onData(this.writer.raw(N,this.currentLevel+1)),this},x.prototype.instruction=function(F,N){var U,J,te,ie,Ee;if(this.openCurrent(),F!=null&&(F=F.valueOf()),N!=null&&(N=N.valueOf()),Array.isArray(F))for(U=0,ie=F.length;U<ie;U++)J=F[U],this.instruction(J);else if(k(F))for(J in F)!R.call(F,J)||(te=F[J],this.instruction(J,te));else S(N)&&(N=N.apply()),Ee=new h(this,F,N),this.onData(this.writer.processingInstruction(Ee,this.currentLevel+1));return this},x.prototype.declaration=function(F,N,U){var J;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node");return J=new a(this,F,N,U),this.onData(this.writer.declaration(J,this.currentLevel+1)),this},x.prototype.doctype=function(F,N,U){if(this.openCurrent(),F==null)throw new Error("Missing root node name");if(this.root)throw new Error("dtd() must come before the root node");return this.currentNode=new c(this,N,U),this.currentNode.rootNodeName=F,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},x.prototype.dtdElement=function(F,N){var U;return this.openCurrent(),U=new i(this,F,N),this.onData(this.writer.dtdElement(U,this.currentLevel+1)),this},x.prototype.attList=function(F,N,U,J,te){var ie;return this.openCurrent(),ie=new r(this,F,N,U,J,te),this.onData(this.writer.dtdAttList(ie,this.currentLevel+1)),this},x.prototype.entity=function(F,N){var U;return this.openCurrent(),U=new s(this,!1,F,N),this.onData(this.writer.dtdEntity(U,this.currentLevel+1)),this},x.prototype.pEntity=function(F,N){var U;return this.openCurrent(),U=new s(this,!0,F,N),this.onData(this.writer.dtdEntity(U,this.currentLevel+1)),this},x.prototype.notation=function(F,N){var U;return this.openCurrent(),U=new o(this,F,N),this.onData(this.writer.dtdNotation(U,this.currentLevel+1)),this},x.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},x.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},x.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},x.prototype.openNode=function(F){if(!F.isOpen)return!this.root&&this.currentLevel===0&&F instanceof l&&(this.root=F),this.onData(this.writer.openNode(F,this.currentLevel)),F.isOpen=!0},x.prototype.closeNode=function(F){if(!F.isClosed)return this.onData(this.writer.closeNode(F,this.currentLevel)),F.isClosed=!0},x.prototype.onData=function(F){return this.documentStarted=!0,this.onDataCallback(F)},x.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},x.prototype.ele=function(){return this.element.apply(this,arguments)},x.prototype.nod=function(F,N,U){return this.node(F,N,U)},x.prototype.txt=function(F){return this.text(F)},x.prototype.dat=function(F){return this.cdata(F)},x.prototype.com=function(F){return this.comment(F)},x.prototype.ins=function(F,N){return this.instruction(F,N)},x.prototype.dec=function(F,N,U){return this.declaration(F,N,U)},x.prototype.dtd=function(F,N,U){return this.doctype(F,N,U)},x.prototype.e=function(F,N,U){return this.element(F,N,U)},x.prototype.n=function(F,N,U){return this.node(F,N,U)},x.prototype.t=function(F){return this.text(F)},x.prototype.d=function(F){return this.cdata(F)},x.prototype.c=function(F){return this.comment(F)},x.prototype.r=function(F){return this.raw(F)},x.prototype.i=function(F,N){return this.instruction(F,N)},x.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},x.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},x.prototype.ent=function(F,N){return this.entity(F,N)},x.prototype.pent=function(F,N){return this.pEntity(F,N)},x.prototype.not=function(F,N){return this.notation(F,N)},x}()}).call(cp)});var hp=L((dp,fp)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b=function(S,k){for(var v in k)y.call(k,v)&&(S[v]=k[v]);function D(){this.constructor=S}return D.prototype=k.prototype,S.prototype=new D,S.__super__=k.prototype,S},y={}.hasOwnProperty;o=eo(),a=so(),n=Js(),e=Zs(),c=Ys(),l=oo(),f=ao(),u=co(),t=to(),r=ro(),i=no(),s=io(),C=Fu(),fp.exports=h=function(S){b(k,S);function k(v,D){k.__super__.constructor.call(this,D),this.stream=v}return k.prototype.document=function(v){var D,R,x,F,N,U,J,te;for(U=v.children,R=0,F=U.length;R<F;R++)D=U[R],D.isLastRootNode=!1;for(v.children[v.children.length-1].isLastRootNode=!0,J=v.children,te=[],x=0,N=J.length;x<N;x++)switch(D=J[x],!1){case!(D instanceof o):te.push(this.declaration(D));break;case!(D instanceof a):te.push(this.docType(D));break;case!(D instanceof e):te.push(this.comment(D));break;case!(D instanceof u):te.push(this.processingInstruction(D));break;default:te.push(this.element(D))}return te},k.prototype.attribute=function(v){return this.stream.write(" "+v.name+'="'+v.value+'"')},k.prototype.cdata=function(v,D){return this.stream.write(this.space(D)+"<![CDATA["+v.text+"]]>"+this.endline(v))},k.prototype.comment=function(v,D){return this.stream.write(this.space(D)+"<!-- "+v.text+" -->"+this.endline(v))},k.prototype.declaration=function(v,D){return this.stream.write(this.space(D)),this.stream.write('<?xml version="'+v.version+'"'),v.encoding!=null&&this.stream.write(' encoding="'+v.encoding+'"'),v.standalone!=null&&this.stream.write(' standalone="'+v.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(v))},k.prototype.docType=function(v,D){var R,x,F,N;if(D||(D=0),this.stream.write(this.space(D)),this.stream.write("<!DOCTYPE "+v.root().name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(v)),N=v.children,x=0,F=N.length;x<F;x++)switch(R=N[x],!1){case!(R instanceof t):this.dtdAttList(R,D+1);break;case!(R instanceof r):this.dtdElement(R,D+1);break;case!(R instanceof i):this.dtdEntity(R,D+1);break;case!(R instanceof s):this.dtdNotation(R,D+1);break;case!(R instanceof n):this.cdata(R,D+1);break;case!(R instanceof e):this.comment(R,D+1);break;case!(R instanceof u):this.processingInstruction(R,D+1);break;default:throw new Error("Unknown DTD node type: "+R.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(v))},k.prototype.element=function(v,D){var R,x,F,N,U,J,te,ie;D||(D=0),ie=this.space(D),this.stream.write(ie+"<"+v.name),J=v.attributes;for(U in J)!y.call(J,U)||(R=J[U],this.attribute(R));if(v.children.length===0||v.children.every(function(Ee){return Ee.value===""}))this.allowEmpty?this.stream.write("></"+v.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)this.stream.write(">"),this.stream.write(v.children[0].value),this.stream.write("</"+v.name+">");else{for(this.stream.write(">"+this.newline),te=v.children,F=0,N=te.length;F<N;F++)switch(x=te[F],!1){case!(x instanceof n):this.cdata(x,D+1);break;case!(x instanceof e):this.comment(x,D+1);break;case!(x instanceof c):this.element(x,D+1);break;case!(x instanceof l):this.raw(x,D+1);break;case!(x instanceof f):this.text(x,D+1);break;case!(x instanceof u):this.processingInstruction(x,D+1);break;default:throw new Error("Unknown XML node type: "+x.constructor.name)}this.stream.write(ie+"</"+v.name+">")}return this.stream.write(this.endline(v))},k.prototype.processingInstruction=function(v,D){return this.stream.write(this.space(D)+"<?"+v.target),v.value&&this.stream.write(" "+v.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(v))},k.prototype.raw=function(v,D){return this.stream.write(this.space(D)+v.value+this.endline(v))},k.prototype.text=function(v,D){return this.stream.write(this.space(D)+v.value+this.endline(v))},k.prototype.dtdAttList=function(v,D){return this.stream.write(this.space(D)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType),v.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+v.defaultValueType),v.defaultValue&&this.stream.write(' "'+v.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},k.prototype.dtdElement=function(v,D){return this.stream.write(this.space(D)+"<!ELEMENT "+v.name+" "+v.value),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},k.prototype.dtdEntity=function(v,D){return this.stream.write(this.space(D)+"<!ENTITY"),v.pe&&this.stream.write(" %"),this.stream.write(" "+v.name),v.value?this.stream.write(' "'+v.value+'"'):(v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.nData&&this.stream.write(" NDATA "+v.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},k.prototype.dtdNotation=function(v,D){return this.stream.write(this.space(D)+"<!NOTATION "+v.name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.pubID?this.stream.write(' PUBLIC "'+v.pubID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},k.prototype.endline=function(v){return v.isLastRootNode?"":this.newline},k}(C)}).call(dp)});var gp=L((pp,uo)=>{(function(){var n,e,t,r,i,s,o;o=Dr(),i=o.assign,s=o.isFunction,n=ap(),e=lp(),r=Ta(),t=hp(),uo.exports.create=function(a,c,u,l){var h,f;if(a==null)throw new Error("Root element needs a name");return l=i({},c,u,l),h=new n(l),f=h.element(a),l.headless||(h.declaration(l),(l.pubID!=null||l.sysID!=null)&&h.doctype(l)),f},uo.exports.begin=function(a,c,u){var l;return s(a)&&(l=[a,c],c=l[0],u=l[1],a={}),c?new e(a,c,u):new n(a)},uo.exports.stringWriter=function(a){return new r(a)},uo.exports.streamWriter=function(a,c){return new t(a,c)}}).call(pp)});var wp=L(yp=>{var mp=Th(),OD=gp();yp.build=LD;function ND(n){function e(t){return t<10?"0"+t:t}return n.getUTCFullYear()+"-"+e(n.getUTCMonth()+1)+"-"+e(n.getUTCDate())+"T"+e(n.getUTCHours())+":"+e(n.getUTCMinutes())+":"+e(n.getUTCSeconds())+"Z"}var qD=Object.prototype.toString;function vp(n){var e=qD.call(n).match(/\[object (.*)\]/);return e&&e[1]}function LD(n,e){var t={version:"1.0",encoding:"UTF-8"},r={pubid:"-//Apple//DTD PLIST 1.0//EN",sysid:"http://www.apple.com/DTDs/PropertyList-1.0.dtd"},i=OD.create("plist");return i.dec(t.version,t.encoding,t.standalone),i.dtd(r.pubid,r.sysid),i.att("version","1.0"),Iu(n,i),e||(e={}),e.pretty=e.pretty!==!1,i.end(e)}function Iu(n,e){var t,r,i,s=vp(n);if(s!="Undefined")if(Array.isArray(n))for(e=e.ele("array"),r=0;r<n.length;r++)Iu(n[r],e);else if(Buffer.isBuffer(n))e.ele("data").raw(n.toString("base64"));else if(s=="Object"){e=e.ele("dict");for(i in n)n.hasOwnProperty(i)&&(e.ele("key").txt(i),Iu(n[i],e))}else s=="Number"?(t=n%1==0?"integer":"real",e.ele(t).txt(n.toString())):s=="Date"?e.ele("date").txt(ND(new Date(n))):s=="Boolean"?e.ele(n?"true":"false"):s=="String"?e.ele("string").txt(n):s=="ArrayBuffer"?e.ele("data").raw(mp.fromByteArray(n)):n&&n.buffer&&vp(n.buffer)=="ArrayBuffer"&&e.ele("data").raw(mp.fromByteArray(new Uint8Array(n.buffer),e))}});var Dp=L(Ou=>{var bp=bh();Object.keys(bp).forEach(function(n){Ou[n]=bp[n]});var Cp=wp();Object.keys(Cp).forEach(function(n){Ou[n]=Cp[n]})});var Wp=L((EI,Ku)=>{var jp=require("fs"),zD=require("path"),GD=jp.exists||zD.exists,Uu=function(n,e){var t=[],r;["end_of_record"].concat(n.split(`
`)).forEach(function(i){i=i.trim();var s=i.split(":"),o=[s.shift(),s.join(":")],a,c;switch(o[0].toUpperCase()){case"TN":r.title=o[1].trim();break;case"SF":r.file=o.slice(1).join(":").trim();break;case"FNF":r.functions.found=Number(o[1].trim());break;case"FNH":r.functions.hit=Number(o[1].trim());break;case"LF":r.lines.found=Number(o[1].trim());break;case"LH":r.lines.hit=Number(o[1].trim());break;case"DA":a=o[1].split(","),r.lines.details.push({line:Number(a[0]),hit:Number(a[1])});break;case"FN":c=o[1].split(","),r.functions.details.push({name:c[1],line:Number(c[0])});break;case"FNDA":c=o[1].split(","),r.functions.details.some(function(u,l){if(u.name===c[1]&&u.hit===void 0)return r.functions.details[l].hit=Number(c[0]),!0});break;case"BRDA":c=o[1].split(","),r.branches.details.push({line:Number(c[0]),block:Number(c[1]),branch:Number(c[2]),taken:c[3]==="-"?0:Number(c[3])});break;case"BRF":r.branches.found=Number(o[1]);break;case"BRH":r.branches.hit=Number(o[1]);break}i.indexOf("end_of_record")>-1&&(t.push(r),r={lines:{found:0,hit:0,details:[]},functions:{hit:0,found:0,details:[]},branches:{hit:0,found:0,details:[]}})}),t.shift(),t.length?e(null,t):e("Failed to parse string")},QD=function(n,e){GD(n,function(t){if(!t)return Uu(n,e);jp.readFile(n,"utf8",function(r,i){Uu(i,e)})})};Ku.exports=QD;Ku.exports.source=Uu});var _n=L(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.asPromise=ot.thenable=ot.typedArray=ot.stringArray=ot.array=ot.func=ot.error=ot.number=ot.string=ot.boolean=void 0;function ZD(n){return n===!0||n===!1}ot.boolean=ZD;function Qp(n){return typeof n=="string"||n instanceof String}ot.string=Qp;function eT(n){return typeof n=="number"||n instanceof Number}ot.number=eT;function tT(n){return n instanceof Error}ot.error=tT;function Yp(n){return typeof n=="function"}ot.func=Yp;function Jp(n){return Array.isArray(n)}ot.array=Jp;function nT(n){return Jp(n)&&n.every(e=>Qp(e))}ot.stringArray=nT;function rT(n,e){return Array.isArray(n)&&n.every(e)}ot.typedArray=rT;function Zp(n){return n&&Yp(n.then)}ot.thenable=Zp;function iT(n){return n instanceof Promise?n:Zp(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}ot.asPromise=iT});var rs=L(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.stringArray=Mt.array=Mt.func=Mt.error=Mt.number=Mt.string=Mt.boolean=void 0;function sT(n){return n===!0||n===!1}Mt.boolean=sT;function eg(n){return typeof n=="string"||n instanceof String}Mt.string=eg;function oT(n){return typeof n=="number"||n instanceof Number}Mt.number=oT;function aT(n){return n instanceof Error}Mt.error=aT;function cT(n){return typeof n=="function"}Mt.func=cT;function tg(n){return Array.isArray(n)}Mt.array=tg;function uT(n){return tg(n)&&n.every(e=>eg(e))}Mt.stringArray=uT});var zu=L(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.Message=re.NotificationType9=re.NotificationType8=re.NotificationType7=re.NotificationType6=re.NotificationType5=re.NotificationType4=re.NotificationType3=re.NotificationType2=re.NotificationType1=re.NotificationType0=re.NotificationType=re.RequestType9=re.RequestType8=re.RequestType7=re.RequestType6=re.RequestType5=re.RequestType4=re.RequestType3=re.RequestType2=re.RequestType1=re.RequestType=re.RequestType0=re.AbstractMessageSignature=re.ParameterStructures=re.ResponseError=re.ErrorCodes=void 0;var Di=rs(),ng;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(ng=re.ErrorCodes||(re.ErrorCodes={}));var La=class extends Error{constructor(e,t,r){super(t);this.code=Di.number(e)?e:ng.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,La.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};re.ResponseError=La;var _t=class{constructor(e){this.kind=e}static is(e){return e===_t.auto||e===_t.byName||e===_t.byPosition}toString(){return this.kind}};re.ParameterStructures=_t;_t.auto=new _t("auto");_t.byPosition=new _t("byPosition");_t.byName=new _t("byName");var Qe=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return _t.auto}};re.AbstractMessageSignature=Qe;var rg=class extends Qe{constructor(e){super(e,0)}};re.RequestType0=rg;var ig=class extends Qe{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.RequestType=ig;var sg=class extends Qe{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.RequestType1=sg;var og=class extends Qe{constructor(e){super(e,2)}};re.RequestType2=og;var ag=class extends Qe{constructor(e){super(e,3)}};re.RequestType3=ag;var cg=class extends Qe{constructor(e){super(e,4)}};re.RequestType4=cg;var ug=class extends Qe{constructor(e){super(e,5)}};re.RequestType5=ug;var lg=class extends Qe{constructor(e){super(e,6)}};re.RequestType6=lg;var dg=class extends Qe{constructor(e){super(e,7)}};re.RequestType7=dg;var fg=class extends Qe{constructor(e){super(e,8)}};re.RequestType8=fg;var hg=class extends Qe{constructor(e){super(e,9)}};re.RequestType9=hg;var pg=class extends Qe{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.NotificationType=pg;var gg=class extends Qe{constructor(e){super(e,0)}};re.NotificationType0=gg;var mg=class extends Qe{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.NotificationType1=mg;var vg=class extends Qe{constructor(e){super(e,2)}};re.NotificationType2=vg;var yg=class extends Qe{constructor(e){super(e,3)}};re.NotificationType3=yg;var wg=class extends Qe{constructor(e){super(e,4)}};re.NotificationType4=wg;var bg=class extends Qe{constructor(e){super(e,5)}};re.NotificationType5=bg;var Cg=class extends Qe{constructor(e){super(e,6)}};re.NotificationType6=Cg;var Dg=class extends Qe{constructor(e){super(e,7)}};re.NotificationType7=Dg;var Tg=class extends Qe{constructor(e){super(e,8)}};re.NotificationType8=Tg;var Sg=class extends Qe{constructor(e){super(e,9)}};re.NotificationType9=Sg;var lT;(function(n){function e(i){let s=i;return s&&Di.string(s.method)&&(Di.string(s.id)||Di.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&Di.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(Di.string(s.id)||Di.number(s.id)||s.id===null)}n.isResponse=r})(lT=re.Message||(re.Message={}))});var Qu=L(Sr=>{"use strict";var kg;Object.defineProperty(Sr,"__esModule",{value:!0});Sr.LRUCache=Sr.LinkedMap=Sr.Touch=void 0;var Vt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Vt=Sr.Touch||(Sr.Touch={}));var Gu=class{constructor(){this[kg]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Vt.None){let r=this._map.get(e);if(!!r)return t!==Vt.None&&this.touch(r,t),r.value}set(e,t,r=Vt.None){let i=this._map.get(e);if(i)i.value=t,r!==Vt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Vt.None:this.addItemLast(i);break;case Vt.First:this.addItemFirst(i);break;case Vt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(kg=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Vt.First&&t!==Vt.Last)){if(t===Vt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Vt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};Sr.LinkedMap=Gu;var Rg=class extends Gu{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Vt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Vt.None)}set(e,t){return super.set(e,t,Vt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Sr.LRUCache=Rg});var Pg=L(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.Disposable=void 0;var dT;(function(n){function e(t){return{dispose:t}}n.create=e})(dT=yo.Disposable||(yo.Disposable={}))});var Zr=L(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});var Yu;function Ju(){if(Yu===void 0)throw new Error("No runtime abstraction layer installed");return Yu}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Yu=t}n.install=e})(Ju||(Ju={}));Zu.default=Ju});var is=L(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.Emitter=Ti.Event=void 0;var fT=Zr(),hT;(function(n){let e={dispose(){}};n.None=function(){return e}})(hT=Ti.Event||(Ti.Event={}));var _g=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,fT.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},wo=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new _g),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=wo._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Ti.Emitter=wo;wo._noop=function(){}});var Ma=L(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0});Si.CancellationTokenSource=Si.CancellationToken=void 0;var pT=Zr(),gT=rs(),el=is(),tl;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:el.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:el.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||gT.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(tl=Si.CancellationToken||(Si.CancellationToken={}));var mT=Object.freeze(function(n,e){let t=(0,pT.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),nl=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?mT:(this._emitter||(this._emitter=new el.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Eg=class{get token(){return this._token||(this._token=new nl),this._token}cancel(){this._token?this._token.cancel():this._token=tl.Cancelled}dispose(){this._token?this._token instanceof nl&&this._token.dispose():this._token=tl.None}};Si.CancellationTokenSource=Eg});var Ng=L(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.SharedArrayReceiverStrategy=ss.SharedArraySenderStrategy=void 0;var vT=Ma(),bo;(function(n){n.Continue=0,n.Cancelled=1})(bo||(bo={}));var xg=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=bo.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,bo.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};ss.SharedArraySenderStrategy=xg;var Fg=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===bo.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Ig=class{constructor(e){this.token=new Fg(e)}cancel(){}dispose(){}},Og=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new vT.CancellationTokenSource:new Ig(t)}};ss.SharedArrayReceiverStrategy=Og});var rl=L(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.Semaphore=void 0;var yT=Zr(),qg=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,yT.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Aa.Semaphore=qg});var Mg=L(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.ReadableStreamMessageReader=kr.AbstractMessageReader=kr.MessageReader=void 0;var il=Zr(),os=rs(),sl=is(),wT=rl(),bT;(function(n){function e(t){let r=t;return r&&os.func(r.listen)&&os.func(r.dispose)&&os.func(r.onError)&&os.func(r.onClose)&&os.func(r.onPartialMessage)}n.is=e})(bT=kr.MessageReader||(kr.MessageReader={}));var ol=class{constructor(){this.errorEmitter=new sl.Emitter,this.closeEmitter=new sl.Emitter,this.partialMessageEmitter=new sl.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${os.string(e.message)?e.message:"unknown"}`)}};kr.AbstractMessageReader=ol;var al;(function(n){function e(t){let r,i,s,o=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let u of t.contentDecoders)o.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let u of t.contentTypeDecoders)c.set(u.name,u)}return a===void 0&&(a=(0,il.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(al||(al={}));var Lg=class extends ol{constructor(e,t){super();this.readable=e,this.options=al.fromOptions(t),this.buffer=(0,il.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new wT.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error("Header must provide a Content-Length property."));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error("Content-Length value must be a number."));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,il.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};kr.ReadableStreamMessageReader=Lg});var Hg=L(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.WriteableStreamMessageWriter=Rr.AbstractMessageWriter=Rr.MessageWriter=void 0;var Ag=Zr(),Co=rs(),CT=rl(),$g=is(),DT="Content-Length: ",jg=`\r
`,TT;(function(n){function e(t){let r=t;return r&&Co.func(r.dispose)&&Co.func(r.onClose)&&Co.func(r.onError)&&Co.func(r.write)}n.is=e})(TT=Rr.MessageWriter||(Rr.MessageWriter={}));var cl=class{constructor(){this.errorEmitter=new $g.Emitter,this.closeEmitter=new $g.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Co.string(e.message)?e.message:"unknown"}`)}};Rr.AbstractMessageWriter=cl;var ul;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Ag.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Ag.default)().applicationJson.encoder}}n.fromOptions=e})(ul||(ul={}));var Wg=class extends cl{constructor(e,t){super();this.writable=e,this.options=ul.fromOptions(t),this.errorCount=0,this.writeSemaphore=new CT.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(DT,r.byteLength.toString(),jg),i.push(jg),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Rr.WriteableStreamMessageWriter=Wg});var Kg=L($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.AbstractMessageBuffer=void 0;var ST=13,kT=10,RT=`\r
`,Ug=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let u=this._chunks[r];i=0;t:for(;i<u.length;){switch(u[i]){case ST:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case kT:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=u.byteLength,r++}if(t!==4)return;let o=this._read(s+i),a=new Map,c=this.toString(o,"ascii").split(RT);if(c.length<2)return a;for(let u=0;u<c.length-2;u++){let l=c[u],h=l.indexOf(":");if(h===-1)throw new Error("Message header must separate key and value using :");let f=l.substr(0,h),C=l.substr(h+1).trim();a.set(e?f.toLowerCase():f,C)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};$a.AbstractMessageBuffer=Ug});var Jg=L(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.createMessageConnection=ne.ConnectionOptions=ne.MessageStrategy=ne.CancellationStrategy=ne.CancellationSenderStrategy=ne.CancellationReceiverStrategy=ne.RequestCancellationReceiverStrategy=ne.IdCancellationReceiverStrategy=ne.ConnectionStrategy=ne.ConnectionError=ne.ConnectionErrors=ne.LogTraceNotification=ne.SetTraceNotification=ne.TraceFormat=ne.TraceValues=ne.Trace=ne.NullLogger=ne.ProgressType=ne.ProgressToken=void 0;var Vg=Zr(),et=rs(),oe=zu(),Bg=Qu(),Do=is(),ll=Ma(),To;(function(n){n.type=new oe.NotificationType("$/cancelRequest")})(To||(To={}));var Xg;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Xg=ne.ProgressToken||(ne.ProgressToken={}));var So;(function(n){n.type=new oe.NotificationType("$/progress")})(So||(So={}));var zg=class{constructor(){}};ne.ProgressType=zg;var dl;(function(n){function e(t){return et.func(t)}n.is=e})(dl||(dl={}));ne.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var $e;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})($e=ne.Trace||(ne.Trace={}));var PT;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(PT=ne.TraceValues||(ne.TraceValues={}));(function(n){function e(r){if(!et.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})($e=ne.Trace||(ne.Trace={}));var Wn;(function(n){n.Text="text",n.JSON="json"})(Wn=ne.TraceFormat||(ne.TraceFormat={}));(function(n){function e(t){return et.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Wn=ne.TraceFormat||(ne.TraceFormat={}));var Gg;(function(n){n.type=new oe.NotificationType("$/setTrace")})(Gg=ne.SetTraceNotification||(ne.SetTraceNotification={}));var fl;(function(n){n.type=new oe.NotificationType("$/logTrace")})(fl=ne.LogTraceNotification||(ne.LogTraceNotification={}));var ja;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(ja=ne.ConnectionErrors||(ne.ConnectionErrors={}));var ki=class extends Error{constructor(e,t){super(t);this.code=e,Object.setPrototypeOf(this,ki.prototype)}};ne.ConnectionError=ki;var Qg;(function(n){function e(t){let r=t;return r&&et.func(r.cancelUndispatched)}n.is=e})(Qg=ne.ConnectionStrategy||(ne.ConnectionStrategy={}));var hl;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&et.func(r.createCancellationTokenSource)&&(r.dispose===void 0||et.func(r.dispose))}n.is=e})(hl=ne.IdCancellationReceiverStrategy||(ne.IdCancellationReceiverStrategy={}));var Yg;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&et.func(r.createCancellationTokenSource)&&(r.dispose===void 0||et.func(r.dispose))}n.is=e})(Yg=ne.RequestCancellationReceiverStrategy||(ne.RequestCancellationReceiverStrategy={}));var pl;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new ll.CancellationTokenSource}});function e(t){return hl.is(t)||Yg.is(t)}n.is=e})(pl=ne.CancellationReceiverStrategy||(ne.CancellationReceiverStrategy={}));var gl;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(To.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&et.func(r.sendCancellation)&&et.func(r.cleanup)}n.is=e})(gl=ne.CancellationSenderStrategy||(ne.CancellationSenderStrategy={}));var ml;(function(n){n.Message=Object.freeze({receiver:pl.Message,sender:gl.Message});function e(t){let r=t;return r&&pl.is(r.receiver)&&gl.is(r.sender)}n.is=e})(ml=ne.CancellationStrategy||(ne.CancellationStrategy={}));var vl;(function(n){function e(t){let r=t;return r&&et.func(r.handleMessage)}n.is=e})(vl=ne.MessageStrategy||(ne.MessageStrategy={}));var _T;(function(n){function e(t){let r=t;return r&&(ml.is(r.cancellationStrategy)||Qg.is(r.connectionStrategy)||vl.is(r.messageStrategy))}n.is=e})(_T=ne.ConnectionOptions||(ne.ConnectionOptions={}));var Hn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(Hn||(Hn={}));function ET(n,e,t,r){let i=t!==void 0?t:ne.NullLogger,s=0,o=0,a=0,c="2.0",u,l=new Map,h,f=new Map,C=new Map,b,y=new Bg.LinkedMap,S=new Map,k=new Set,v=new Map,D=$e.Off,R=Wn.Text,x,F=Hn.New,N=new Do.Emitter,U=new Do.Emitter,J=new Do.Emitter,te=new Do.Emitter,ie=new Do.Emitter,Ee=r&&r.cancellationStrategy?r.cancellationStrategy:ml.Message;function Dt(P){if(P===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+P.toString()}function ut(P){return P===null?"res-unknown-"+(++a).toString():"res-"+P.toString()}function lt(){return"not-"+(++o).toString()}function ve(P,j){oe.Message.isRequest(j)?P.set(Dt(j.id),j):oe.Message.isResponse(j)?P.set(ut(j.id),j):P.set(lt(),j)}function Ze(P){}function Ge(){return F===Hn.Listening}function Wt(){return F===Hn.Closed}function Zt(){return F===Hn.Disposed}function tr(){(F===Hn.New||F===Hn.Listening)&&(F=Hn.Closed,U.fire(void 0))}function Ot(P){N.fire([P,void 0,void 0])}function di(P){N.fire(P)}n.onClose(tr),n.onError(Ot),e.onClose(tr),e.onError(di);function $r(){b||y.size===0||(b=(0,Vg.default)().timer.setImmediate(()=>{b=void 0,pr()}))}function hr(P){oe.Message.isRequest(P)?fi(P):oe.Message.isNotification(P)?Wr(P):oe.Message.isResponse(P)?jr(P):mr(P)}function pr(){if(y.size===0)return;let P=y.shift();try{let j=r==null?void 0:r.messageStrategy;vl.is(j)?j.handleMessage(P,hr):hr(P)}finally{$r()}}let gr=P=>{try{if(oe.Message.isNotification(P)&&P.method===To.type.method){let j=P.params.id,B=Dt(j),Y=y.get(B);if(oe.Message.isRequest(Y)){let ke=r==null?void 0:r.connectionStrategy,Re=ke&&ke.cancelUndispatched?ke.cancelUndispatched(Y,Ze):Ze(Y);if(Re&&(Re.error!==void 0||Re.result!==void 0)){y.delete(B),v.delete(j),Re.id=Y.id,Tn(Re,P.method,Date.now()),e.write(Re).catch(()=>i.error("Sending response for canceled message failed."));return}}let xe=v.get(j);if(xe!==void 0){xe.cancel(),Ht(P);return}else k.add(j)}ve(y,P)}finally{$r()}};function fi(P){if(Zt())return;function j(fe,Fe,g){let M={jsonrpc:c,id:P.id};fe instanceof oe.ResponseError?M.error=fe.toJson():M.result=fe===void 0?null:fe,Tn(M,Fe,g),e.write(M).catch(()=>i.error("Sending response failed."))}function B(fe,Fe,g){let M={jsonrpc:c,id:P.id,error:fe.toJson()};Tn(M,Fe,g),e.write(M).catch(()=>i.error("Sending response failed."))}function Y(fe,Fe,g){fe===void 0&&(fe=null);let M={jsonrpc:c,id:P.id,result:fe};Tn(M,Fe,g),e.write(M).catch(()=>i.error("Sending response failed."))}Ur(P);let xe=l.get(P.method),ke,Re;xe&&(ke=xe.type,Re=xe.handler);let We=Date.now();if(Re||u){let fe=P.id??String(Date.now()),Fe=hl.is(Ee.receiver)?Ee.receiver.createCancellationTokenSource(fe):Ee.receiver.createCancellationTokenSource(P);P.id!==null&&k.has(P.id)&&Fe.cancel(),P.id!==null&&v.set(fe,Fe);try{let g;if(Re)if(P.params===void 0){if(ke!==void 0&&ke.numberOfParams!==0){B(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines ${ke.numberOfParams} params but received none.`),P.method,We);return}g=Re(Fe.token)}else if(Array.isArray(P.params)){if(ke!==void 0&&ke.parameterStructures===oe.ParameterStructures.byName){B(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines parameters by name but received parameters by position`),P.method,We);return}g=Re(...P.params,Fe.token)}else{if(ke!==void 0&&ke.parameterStructures===oe.ParameterStructures.byPosition){B(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines parameters by position but received parameters by name`),P.method,We);return}g=Re(P.params,Fe.token)}else u&&(g=u(P.method,P.params,Fe.token));let M=g;g?M.then?M.then(X=>{v.delete(fe),j(X,P.method,We)},X=>{v.delete(fe),X instanceof oe.ResponseError?B(X,P.method,We):X&&et.string(X.message)?B(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed with message: ${X.message}`),P.method,We):B(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed unexpectedly without providing any details.`),P.method,We)}):(v.delete(fe),j(g,P.method,We)):(v.delete(fe),Y(g,P.method,We))}catch(g){v.delete(fe),g instanceof oe.ResponseError?j(g,P.method,We):g&&et.string(g.message)?B(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed with message: ${g.message}`),P.method,We):B(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed unexpectedly without providing any details.`),P.method,We)}}else B(new oe.ResponseError(oe.ErrorCodes.MethodNotFound,`Unhandled method ${P.method}`),P.method,We)}function jr(P){if(!Zt())if(P.id===null)P.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(P.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let j=P.id,B=S.get(j);if(vr(P,B),B!==void 0){S.delete(j);try{if(P.error){let Y=P.error;B.reject(new oe.ResponseError(Y.code,Y.message,Y.data))}else if(P.result!==void 0)B.resolve(P.result);else throw new Error("Should never happen.")}catch(Y){Y.message?i.error(`Response handler '${B.method}' failed with message: ${Y.message}`):i.error(`Response handler '${B.method}' failed unexpectedly.`)}}}}function Wr(P){if(Zt())return;let j,B;if(P.method===To.type.method){let Y=P.params.id;k.delete(Y),Ht(P);return}else{let Y=f.get(P.method);Y&&(B=Y.handler,j=Y.type)}if(B||h)try{if(Ht(P),B)if(P.params===void 0)j!==void 0&&j.numberOfParams!==0&&j.parameterStructures!==oe.ParameterStructures.byName&&i.error(`Notification ${P.method} defines ${j.numberOfParams} params but received none.`),B();else if(Array.isArray(P.params)){let Y=P.params;P.method===So.type.method&&Y.length===2&&Xg.is(Y[0])?B({token:Y[0],value:Y[1]}):(j!==void 0&&(j.parameterStructures===oe.ParameterStructures.byName&&i.error(`Notification ${P.method} defines parameters by name but received parameters by position`),j.numberOfParams!==P.params.length&&i.error(`Notification ${P.method} defines ${j.numberOfParams} params but received ${Y.length} arguments`)),B(...Y))}else j!==void 0&&j.parameterStructures===oe.ParameterStructures.byPosition&&i.error(`Notification ${P.method} defines parameters by position but received parameters by name`),B(P.params);else h&&h(P.method,P.params)}catch(Y){Y.message?i.error(`Notification handler '${P.method}' failed with message: ${Y.message}`):i.error(`Notification handler '${P.method}' failed unexpectedly.`)}else J.fire(P)}function mr(P){if(!P){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(P,null,4)}`);let j=P;if(et.string(j.id)||et.number(j.id)){let B=j.id,Y=S.get(B);Y&&Y.reject(new Error("The received response has neither a result nor an error property."))}}function wt(P){if(P!=null)switch(D){case $e.Verbose:return JSON.stringify(P,null,4);case $e.Compact:return JSON.stringify(P);default:return}}function Hr(P){if(!(D===$e.Off||!x))if(R===Wn.Text){let j;(D===$e.Verbose||D===$e.Compact)&&P.params&&(j=`Params: ${wt(P.params)}

`),x.log(`Sending request '${P.method} - (${P.id})'.`,j)}else dt("send-request",P)}function nr(P){if(!(D===$e.Off||!x))if(R===Wn.Text){let j;(D===$e.Verbose||D===$e.Compact)&&(P.params?j=`Params: ${wt(P.params)}

`:j=`No parameters provided.

`),x.log(`Sending notification '${P.method}'.`,j)}else dt("send-notification",P)}function Tn(P,j,B){if(!(D===$e.Off||!x))if(R===Wn.Text){let Y;(D===$e.Verbose||D===$e.Compact)&&(P.error&&P.error.data?Y=`Error data: ${wt(P.error.data)}

`:P.result?Y=`Result: ${wt(P.result)}

`:P.error===void 0&&(Y=`No result returned.

`)),x.log(`Sending response '${j} - (${P.id})'. Processing request took ${Date.now()-B}ms`,Y)}else dt("send-response",P)}function Ur(P){if(!(D===$e.Off||!x))if(R===Wn.Text){let j;(D===$e.Verbose||D===$e.Compact)&&P.params&&(j=`Params: ${wt(P.params)}

`),x.log(`Received request '${P.method} - (${P.id})'.`,j)}else dt("receive-request",P)}function Ht(P){if(!(D===$e.Off||!x||P.method===fl.type.method))if(R===Wn.Text){let j;(D===$e.Verbose||D===$e.Compact)&&(P.params?j=`Params: ${wt(P.params)}

`:j=`No parameters provided.

`),x.log(`Received notification '${P.method}'.`,j)}else dt("receive-notification",P)}function vr(P,j){if(!(D===$e.Off||!x))if(R===Wn.Text){let B;if((D===$e.Verbose||D===$e.Compact)&&(P.error&&P.error.data?B=`Error data: ${wt(P.error.data)}

`:P.result?B=`Result: ${wt(P.result)}

`:P.error===void 0&&(B=`No result returned.

`)),j){let Y=P.error?` Request failed: ${P.error.message} (${P.error.code}).`:"";x.log(`Received response '${j.method} - (${P.id})' in ${Date.now()-j.timerStart}ms.${Y}`,B)}else x.log(`Received response ${P.id} without active response promise.`,B)}else dt("receive-response",P)}function dt(P,j){if(!x||D===$e.Off)return;let B={isLSPMessage:!0,type:P,message:j,timestamp:Date.now()};x.log(B)}function qn(){if(Wt())throw new ki(ja.Closed,"Connection is closed.");if(Zt())throw new ki(ja.Disposed,"Connection is disposed.")}function Ut(){if(Ge())throw new ki(ja.AlreadyListening,"Connection is already listening")}function yr(){if(!Ge())throw new Error("Call listen() first.")}function hn(P){return P===void 0?null:P}function wr(P){if(P!==null)return P}function Kr(P){return P!=null&&!Array.isArray(P)&&typeof P=="object"}function en(P,j){switch(P){case oe.ParameterStructures.auto:return Kr(j)?wr(j):[hn(j)];case oe.ParameterStructures.byName:if(!Kr(j))throw new Error("Received parameters by name but param is not an object literal.");return wr(j);case oe.ParameterStructures.byPosition:return[hn(j)];default:throw new Error(`Unknown parameter structure ${P.toString()}`)}}function Vr(P,j){let B,Y=P.numberOfParams;switch(Y){case 0:B=void 0;break;case 1:B=en(P.parameterStructures,j[0]);break;default:B=[];for(let xe=0;xe<j.length&&xe<Y;xe++)B.push(hn(j[xe]));if(j.length<Y)for(let xe=j.length;xe<Y;xe++)B.push(null);break}return B}let pn={sendNotification:(P,...j)=>{qn();let B,Y;if(et.string(P)){B=P;let ke=j[0],Re=0,We=oe.ParameterStructures.auto;oe.ParameterStructures.is(ke)&&(Re=1,We=ke);let fe=j.length,Fe=fe-Re;switch(Fe){case 0:Y=void 0;break;case 1:Y=en(We,j[Re]);break;default:if(We===oe.ParameterStructures.byName)throw new Error(`Received ${Fe} parameters for 'by Name' notification parameter structure.`);Y=j.slice(Re,fe).map(g=>hn(g));break}}else{let ke=j;B=P.method,Y=Vr(P,ke)}let xe={jsonrpc:c,method:B,params:Y};return nr(xe),e.write(xe).catch(ke=>{throw i.error("Sending notification failed."),ke})},onNotification:(P,j)=>{qn();let B;return et.func(P)?h=P:j&&(et.string(P)?(B=P,f.set(P,{type:void 0,handler:j})):(B=P.method,f.set(P.method,{type:P,handler:j}))),{dispose:()=>{B!==void 0?f.delete(B):h=void 0}}},onProgress:(P,j,B)=>{if(C.has(j))throw new Error(`Progress handler for token ${j} already registered`);return C.set(j,B),{dispose:()=>{C.delete(j)}}},sendProgress:(P,j,B)=>pn.sendNotification(So.type,{token:j,value:B}),onUnhandledProgress:te.event,sendRequest:(P,...j)=>{qn(),yr();let B,Y,xe;if(et.string(P)){B=P;let fe=j[0],Fe=j[j.length-1],g=0,M=oe.ParameterStructures.auto;oe.ParameterStructures.is(fe)&&(g=1,M=fe);let X=j.length;ll.CancellationToken.is(Fe)&&(X=X-1,xe=Fe);let he=X-g;switch(he){case 0:Y=void 0;break;case 1:Y=en(M,j[g]);break;default:if(M===oe.ParameterStructures.byName)throw new Error(`Received ${he} parameters for 'by Name' request parameter structure.`);Y=j.slice(g,X).map(I=>hn(I));break}}else{let fe=j;B=P.method,Y=Vr(P,fe);let Fe=P.numberOfParams;xe=ll.CancellationToken.is(fe[Fe])?fe[Fe]:void 0}let ke=s++,Re;xe&&(Re=xe.onCancellationRequested(()=>{let fe=Ee.sender.sendCancellation(pn,ke);return fe===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${ke}`),Promise.resolve()):fe.catch(()=>{i.log(`Sending cancellation messages for id ${ke} failed`)})}));let We={jsonrpc:c,id:ke,method:B,params:Y};return Hr(We),typeof Ee.sender.enableCancellation=="function"&&Ee.sender.enableCancellation(We),new Promise(async(fe,Fe)=>{let g=he=>{fe(he),Ee.sender.cleanup(ke),Re==null||Re.dispose()},M=he=>{Fe(he),Ee.sender.cleanup(ke),Re==null||Re.dispose()},X={method:B,timerStart:Date.now(),resolve:g,reject:M};try{await e.write(We),S.set(ke,X)}catch(he){throw i.error("Sending request failed."),X.reject(new oe.ResponseError(oe.ErrorCodes.MessageWriteError,he.message?he.message:"Unknown reason")),he}})},onRequest:(P,j)=>{qn();let B=null;return dl.is(P)?(B=void 0,u=P):et.string(P)?(B=null,j!==void 0&&(B=P,l.set(P,{handler:j,type:void 0}))):j!==void 0&&(B=P.method,l.set(P.method,{type:P,handler:j})),{dispose:()=>{B!==null&&(B!==void 0?l.delete(B):u=void 0)}}},hasPendingResponse:()=>S.size>0,trace:async(P,j,B)=>{let Y=!1,xe=Wn.Text;B!==void 0&&(et.boolean(B)?Y=B:(Y=B.sendNotification||!1,xe=B.traceFormat||Wn.Text)),D=P,R=xe,D===$e.Off?x=void 0:x=j,Y&&!Wt()&&!Zt()&&await pn.sendNotification(Gg.type,{value:$e.toString(P)})},onError:N.event,onClose:U.event,onUnhandledNotification:J.event,onDispose:ie.event,end:()=>{e.end()},dispose:()=>{if(Zt())return;F=Hn.Disposed,ie.fire(void 0);let P=new oe.ResponseError(oe.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let j of S.values())j.reject(P);S=new Map,v=new Map,k=new Set,y=new Bg.LinkedMap,et.func(e.dispose)&&e.dispose(),et.func(n.dispose)&&n.dispose()},listen:()=>{qn(),Ut(),F=Hn.Listening,n.listen(gr)},inspect:()=>{(0,Vg.default)().console.log("inspect")}};return pn.onNotification(fl.type,P=>{if(D===$e.Off||!x)return;let j=D===$e.Verbose||D===$e.Compact;x.log(P.message,j?P.verbose:void 0)}),pn.onNotification(So.type,P=>{let j=C.get(P.token);j?j(P.value):te.fire(P)}),pn}ne.createMessageConnection=ET});var Wa=L(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.ProgressType=A.ProgressToken=A.createMessageConnection=A.NullLogger=A.ConnectionOptions=A.ConnectionStrategy=A.AbstractMessageBuffer=A.WriteableStreamMessageWriter=A.AbstractMessageWriter=A.MessageWriter=A.ReadableStreamMessageReader=A.AbstractMessageReader=A.MessageReader=A.SharedArrayReceiverStrategy=A.SharedArraySenderStrategy=A.CancellationToken=A.CancellationTokenSource=A.Emitter=A.Event=A.Disposable=A.LRUCache=A.Touch=A.LinkedMap=A.ParameterStructures=A.NotificationType9=A.NotificationType8=A.NotificationType7=A.NotificationType6=A.NotificationType5=A.NotificationType4=A.NotificationType3=A.NotificationType2=A.NotificationType1=A.NotificationType0=A.NotificationType=A.ErrorCodes=A.ResponseError=A.RequestType9=A.RequestType8=A.RequestType7=A.RequestType6=A.RequestType5=A.RequestType4=A.RequestType3=A.RequestType2=A.RequestType1=A.RequestType0=A.RequestType=A.Message=A.RAL=void 0;A.MessageStrategy=A.CancellationStrategy=A.CancellationSenderStrategy=A.CancellationReceiverStrategy=A.ConnectionError=A.ConnectionErrors=A.LogTraceNotification=A.SetTraceNotification=A.TraceFormat=A.TraceValues=A.Trace=void 0;var Ke=zu();Object.defineProperty(A,"Message",{enumerable:!0,get:function(){return Ke.Message}});Object.defineProperty(A,"RequestType",{enumerable:!0,get:function(){return Ke.RequestType}});Object.defineProperty(A,"RequestType0",{enumerable:!0,get:function(){return Ke.RequestType0}});Object.defineProperty(A,"RequestType1",{enumerable:!0,get:function(){return Ke.RequestType1}});Object.defineProperty(A,"RequestType2",{enumerable:!0,get:function(){return Ke.RequestType2}});Object.defineProperty(A,"RequestType3",{enumerable:!0,get:function(){return Ke.RequestType3}});Object.defineProperty(A,"RequestType4",{enumerable:!0,get:function(){return Ke.RequestType4}});Object.defineProperty(A,"RequestType5",{enumerable:!0,get:function(){return Ke.RequestType5}});Object.defineProperty(A,"RequestType6",{enumerable:!0,get:function(){return Ke.RequestType6}});Object.defineProperty(A,"RequestType7",{enumerable:!0,get:function(){return Ke.RequestType7}});Object.defineProperty(A,"RequestType8",{enumerable:!0,get:function(){return Ke.RequestType8}});Object.defineProperty(A,"RequestType9",{enumerable:!0,get:function(){return Ke.RequestType9}});Object.defineProperty(A,"ResponseError",{enumerable:!0,get:function(){return Ke.ResponseError}});Object.defineProperty(A,"ErrorCodes",{enumerable:!0,get:function(){return Ke.ErrorCodes}});Object.defineProperty(A,"NotificationType",{enumerable:!0,get:function(){return Ke.NotificationType}});Object.defineProperty(A,"NotificationType0",{enumerable:!0,get:function(){return Ke.NotificationType0}});Object.defineProperty(A,"NotificationType1",{enumerable:!0,get:function(){return Ke.NotificationType1}});Object.defineProperty(A,"NotificationType2",{enumerable:!0,get:function(){return Ke.NotificationType2}});Object.defineProperty(A,"NotificationType3",{enumerable:!0,get:function(){return Ke.NotificationType3}});Object.defineProperty(A,"NotificationType4",{enumerable:!0,get:function(){return Ke.NotificationType4}});Object.defineProperty(A,"NotificationType5",{enumerable:!0,get:function(){return Ke.NotificationType5}});Object.defineProperty(A,"NotificationType6",{enumerable:!0,get:function(){return Ke.NotificationType6}});Object.defineProperty(A,"NotificationType7",{enumerable:!0,get:function(){return Ke.NotificationType7}});Object.defineProperty(A,"NotificationType8",{enumerable:!0,get:function(){return Ke.NotificationType8}});Object.defineProperty(A,"NotificationType9",{enumerable:!0,get:function(){return Ke.NotificationType9}});Object.defineProperty(A,"ParameterStructures",{enumerable:!0,get:function(){return Ke.ParameterStructures}});var yl=Qu();Object.defineProperty(A,"LinkedMap",{enumerable:!0,get:function(){return yl.LinkedMap}});Object.defineProperty(A,"LRUCache",{enumerable:!0,get:function(){return yl.LRUCache}});Object.defineProperty(A,"Touch",{enumerable:!0,get:function(){return yl.Touch}});var xT=Pg();Object.defineProperty(A,"Disposable",{enumerable:!0,get:function(){return xT.Disposable}});var Zg=is();Object.defineProperty(A,"Event",{enumerable:!0,get:function(){return Zg.Event}});Object.defineProperty(A,"Emitter",{enumerable:!0,get:function(){return Zg.Emitter}});var em=Ma();Object.defineProperty(A,"CancellationTokenSource",{enumerable:!0,get:function(){return em.CancellationTokenSource}});Object.defineProperty(A,"CancellationToken",{enumerable:!0,get:function(){return em.CancellationToken}});var tm=Ng();Object.defineProperty(A,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return tm.SharedArraySenderStrategy}});Object.defineProperty(A,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return tm.SharedArrayReceiverStrategy}});var wl=Mg();Object.defineProperty(A,"MessageReader",{enumerable:!0,get:function(){return wl.MessageReader}});Object.defineProperty(A,"AbstractMessageReader",{enumerable:!0,get:function(){return wl.AbstractMessageReader}});Object.defineProperty(A,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return wl.ReadableStreamMessageReader}});var bl=Hg();Object.defineProperty(A,"MessageWriter",{enumerable:!0,get:function(){return bl.MessageWriter}});Object.defineProperty(A,"AbstractMessageWriter",{enumerable:!0,get:function(){return bl.AbstractMessageWriter}});Object.defineProperty(A,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return bl.WriteableStreamMessageWriter}});var FT=Kg();Object.defineProperty(A,"AbstractMessageBuffer",{enumerable:!0,get:function(){return FT.AbstractMessageBuffer}});var Et=Jg();Object.defineProperty(A,"ConnectionStrategy",{enumerable:!0,get:function(){return Et.ConnectionStrategy}});Object.defineProperty(A,"ConnectionOptions",{enumerable:!0,get:function(){return Et.ConnectionOptions}});Object.defineProperty(A,"NullLogger",{enumerable:!0,get:function(){return Et.NullLogger}});Object.defineProperty(A,"createMessageConnection",{enumerable:!0,get:function(){return Et.createMessageConnection}});Object.defineProperty(A,"ProgressToken",{enumerable:!0,get:function(){return Et.ProgressToken}});Object.defineProperty(A,"ProgressType",{enumerable:!0,get:function(){return Et.ProgressType}});Object.defineProperty(A,"Trace",{enumerable:!0,get:function(){return Et.Trace}});Object.defineProperty(A,"TraceValues",{enumerable:!0,get:function(){return Et.TraceValues}});Object.defineProperty(A,"TraceFormat",{enumerable:!0,get:function(){return Et.TraceFormat}});Object.defineProperty(A,"SetTraceNotification",{enumerable:!0,get:function(){return Et.SetTraceNotification}});Object.defineProperty(A,"LogTraceNotification",{enumerable:!0,get:function(){return Et.LogTraceNotification}});Object.defineProperty(A,"ConnectionErrors",{enumerable:!0,get:function(){return Et.ConnectionErrors}});Object.defineProperty(A,"ConnectionError",{enumerable:!0,get:function(){return Et.ConnectionError}});Object.defineProperty(A,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Et.CancellationReceiverStrategy}});Object.defineProperty(A,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Et.CancellationSenderStrategy}});Object.defineProperty(A,"CancellationStrategy",{enumerable:!0,get:function(){return Et.CancellationStrategy}});Object.defineProperty(A,"MessageStrategy",{enumerable:!0,get:function(){return Et.MessageStrategy}});var IT=Zr();A.RAL=IT.default});var om=L(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});var nm=require("util"),Pr=Wa(),ko=class extends Pr.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return ko.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new nm.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};ko.emptyBuffer=Buffer.allocUnsafe(0);var rm=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Pr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Pr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Pr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Pr.Disposable.create(()=>this.stream.off("data",e))}},im=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Pr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Pr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Pr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},sm=Object.freeze({messageBuffer:Object.freeze({create:n=>new ko(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new nm.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new rm(n),asWritableStream:n=>new im(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function Cl(){return sm}(function(n){function e(){Pr.RAL.install(sm)}n.install=e})(Cl||(Cl={}));Dl.default=Cl});var Ri=L(Te=>{"use strict";var OT=Te&&Te.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),NT=Te&&Te.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&OT(e,n,t)};Object.defineProperty(Te,"__esModule",{value:!0});Te.createMessageConnection=Te.createServerSocketTransport=Te.createClientSocketTransport=Te.createServerPipeTransport=Te.createClientPipeTransport=Te.generateRandomPipeName=Te.StreamMessageWriter=Te.StreamMessageReader=Te.SocketMessageWriter=Te.SocketMessageReader=Te.PortMessageWriter=Te.PortMessageReader=Te.IPCMessageWriter=Te.IPCMessageReader=void 0;var as=om();as.default.install();var am=require("path"),qT=require("os"),LT=require("crypto"),Ha=require("net"),vn=Wa();NT(Wa(),Te);var cm=class extends vn.AbstractMessageReader{constructor(e){super();this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),vn.Disposable.create(()=>this.process.off("message",e))}};Te.IPCMessageReader=cm;var um=class extends vn.AbstractMessageWriter{constructor(e){super();this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Te.IPCMessageWriter=um;var lm=class extends vn.AbstractMessageReader{constructor(e){super();this.onData=new vn.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};Te.PortMessageReader=lm;var dm=class extends vn.AbstractMessageWriter{constructor(e){super();this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Te.PortMessageWriter=dm;var cs=class extends vn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,as.default)().stream.asReadableStream(e),t)}};Te.SocketMessageReader=cs;var us=class extends vn.WriteableStreamMessageWriter{constructor(e,t){super((0,as.default)().stream.asWritableStream(e),t);this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};Te.SocketMessageWriter=us;var Tl=class extends vn.ReadableStreamMessageReader{constructor(e,t){super((0,as.default)().stream.asReadableStream(e),t)}};Te.StreamMessageReader=Tl;var Sl=class extends vn.WriteableStreamMessageWriter{constructor(e,t){super((0,as.default)().stream.asWritableStream(e),t)}};Te.StreamMessageWriter=Sl;var fm=process.env.XDG_RUNTIME_DIR,MT=new Map([["linux",107],["darwin",103]]);function AT(){let n=(0,LT.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;fm?e=am.join(fm,`vscode-ipc-${n}.sock`):e=am.join(qT.tmpdir(),`vscode-${n}.sock`);let t=MT.get(process.platform);return t!==void 0&&e.length>t&&(0,as.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}Te.generateRandomPipeName=AT;function $T(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ha.createServer)(a=>{o.close(),t([new cs(a,e),new us(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Te.createClientPipeTransport=$T;function jT(n,e="utf-8"){let t=(0,Ha.createConnection)(n);return[new cs(t,e),new us(t,e)]}Te.createServerPipeTransport=jT;function WT(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ha.createServer)(a=>{o.close(),t([new cs(a,e),new us(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Te.createClientSocketTransport=WT;function HT(n,e="utf-8"){let t=(0,Ha.createConnection)(n,"127.0.0.1");return[new cs(t,e),new us(t,e)]}Te.createServerSocketTransport=HT;function UT(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function KT(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function VT(n,e,t,r){t||(t=vn.NullLogger);let i=UT(n)?new Tl(n):n,s=KT(e)?new Sl(e):e;return vn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,vn.createMessageConnection)(i,s,t,r)}Te.createMessageConnection=VT});var kl=L((fO,hm)=>{"use strict";hm.exports=Ri()});var Ka=L((pm,Ua)=>{(function(n){if(typeof Ua=="object"&&typeof Ua.exports=="object"){var e=n(require,pm);e!==void 0&&(Ua.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(m){function _(E){return typeof E=="string"}m.is=_})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(m){function _(E){return typeof E=="string"}m.is=_})(r=e.URI||(e.URI={}));var i;(function(m){m.MIN_VALUE=-2147483648,m.MAX_VALUE=2147483647;function _(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=_})(i=e.integer||(e.integer={}));var s;(function(m){m.MIN_VALUE=0,m.MAX_VALUE=2147483647;function _(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=_})(s=e.uinteger||(e.uinteger={}));var o;(function(m){function _(T,p){return T===Number.MAX_VALUE&&(T=s.MAX_VALUE),p===Number.MAX_VALUE&&(p=s.MAX_VALUE),{line:T,character:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.uinteger(p.line)&&I.uinteger(p.character)}m.is=E})(o=e.Position||(e.Position={}));var a;(function(m){function _(T,p,q,W){if(I.uinteger(T)&&I.uinteger(p)&&I.uinteger(q)&&I.uinteger(W))return{start:o.create(T,p),end:o.create(q,W)};if(o.is(T)&&o.is(p))return{start:T,end:p};throw new Error("Range#create called with invalid arguments[".concat(T,", ").concat(p,", ").concat(q,", ").concat(W,"]"))}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&o.is(p.start)&&o.is(p.end)}m.is=E})(a=e.Range||(e.Range={}));var c;(function(m){function _(T,p){return{uri:T,range:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&(I.string(p.uri)||I.undefined(p.uri))}m.is=E})(c=e.Location||(e.Location={}));var u;(function(m){function _(T,p,q,W){return{targetUri:T,targetRange:p,targetSelectionRange:q,originSelectionRange:W}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.targetRange)&&I.string(p.targetUri)&&a.is(p.targetSelectionRange)&&(a.is(p.originSelectionRange)||I.undefined(p.originSelectionRange))}m.is=E})(u=e.LocationLink||(e.LocationLink={}));var l;(function(m){function _(T,p,q,W){return{red:T,green:p,blue:q,alpha:W}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.numberRange(p.red,0,1)&&I.numberRange(p.green,0,1)&&I.numberRange(p.blue,0,1)&&I.numberRange(p.alpha,0,1)}m.is=E})(l=e.Color||(e.Color={}));var h;(function(m){function _(T,p){return{range:T,color:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&l.is(p.color)}m.is=E})(h=e.ColorInformation||(e.ColorInformation={}));var f;(function(m){function _(T,p,q){return{label:T,textEdit:p,additionalTextEdits:q}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.string(p.label)&&(I.undefined(p.textEdit)||x.is(p))&&(I.undefined(p.additionalTextEdits)||I.typedArray(p.additionalTextEdits,x.is))}m.is=E})(f=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(m){m.Comment="comment",m.Imports="imports",m.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var b;(function(m){function _(T,p,q,W,ue,Ve){var je={startLine:T,endLine:p};return I.defined(q)&&(je.startCharacter=q),I.defined(W)&&(je.endCharacter=W),I.defined(ue)&&(je.kind=ue),I.defined(Ve)&&(je.collapsedText=Ve),je}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.uinteger(p.startLine)&&I.uinteger(p.startLine)&&(I.undefined(p.startCharacter)||I.uinteger(p.startCharacter))&&(I.undefined(p.endCharacter)||I.uinteger(p.endCharacter))&&(I.undefined(p.kind)||I.string(p.kind))}m.is=E})(b=e.FoldingRange||(e.FoldingRange={}));var y;(function(m){function _(T,p){return{location:T,message:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&c.is(p.location)&&I.string(p.message)}m.is=E})(y=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var S;(function(m){m.Error=1,m.Warning=2,m.Information=3,m.Hint=4})(S=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var k;(function(m){m.Unnecessary=1,m.Deprecated=2})(k=e.DiagnosticTag||(e.DiagnosticTag={}));var v;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&I.string(T.href)}m.is=_})(v=e.CodeDescription||(e.CodeDescription={}));var D;(function(m){function _(T,p,q,W,ue,Ve){var je={range:T,message:p};return I.defined(q)&&(je.severity=q),I.defined(W)&&(je.code=W),I.defined(ue)&&(je.source=ue),I.defined(Ve)&&(je.relatedInformation=Ve),je}m.create=_;function E(T){var p,q=T;return I.defined(q)&&a.is(q.range)&&I.string(q.message)&&(I.number(q.severity)||I.undefined(q.severity))&&(I.integer(q.code)||I.string(q.code)||I.undefined(q.code))&&(I.undefined(q.codeDescription)||I.string((p=q.codeDescription)===null||p===void 0?void 0:p.href))&&(I.string(q.source)||I.undefined(q.source))&&(I.undefined(q.relatedInformation)||I.typedArray(q.relatedInformation,y.is))}m.is=E})(D=e.Diagnostic||(e.Diagnostic={}));var R;(function(m){function _(T,p){for(var q=[],W=2;W<arguments.length;W++)q[W-2]=arguments[W];var ue={title:T,command:p};return I.defined(q)&&q.length>0&&(ue.arguments=q),ue}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.title)&&I.string(p.command)}m.is=E})(R=e.Command||(e.Command={}));var x;(function(m){function _(q,W){return{range:q,newText:W}}m.replace=_;function E(q,W){return{range:{start:q,end:q},newText:W}}m.insert=E;function T(q){return{range:q,newText:""}}m.del=T;function p(q){var W=q;return I.objectLiteral(W)&&I.string(W.newText)&&a.is(W.range)}m.is=p})(x=e.TextEdit||(e.TextEdit={}));var F;(function(m){function _(T,p,q){var W={label:T};return p!==void 0&&(W.needsConfirmation=p),q!==void 0&&(W.description=q),W}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.string(p.label)&&(I.boolean(p.needsConfirmation)||p.needsConfirmation===void 0)&&(I.string(p.description)||p.description===void 0)}m.is=E})(F=e.ChangeAnnotation||(e.ChangeAnnotation={}));var N;(function(m){function _(E){var T=E;return I.string(T)}m.is=_})(N=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var U;(function(m){function _(q,W,ue){return{range:q,newText:W,annotationId:ue}}m.replace=_;function E(q,W,ue){return{range:{start:q,end:q},newText:W,annotationId:ue}}m.insert=E;function T(q,W){return{range:q,newText:"",annotationId:W}}m.del=T;function p(q){var W=q;return x.is(W)&&(F.is(W.annotationId)||N.is(W.annotationId))}m.is=p})(U=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var J;(function(m){function _(T,p){return{textDocument:T,edits:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&Wt.is(p.textDocument)&&Array.isArray(p.edits)}m.is=E})(J=e.TextDocumentEdit||(e.TextDocumentEdit={}));var te;(function(m){function _(T,p,q){var W={kind:"create",uri:T};return p!==void 0&&(p.overwrite!==void 0||p.ignoreIfExists!==void 0)&&(W.options=p),q!==void 0&&(W.annotationId=q),W}m.create=_;function E(T){var p=T;return p&&p.kind==="create"&&I.string(p.uri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(te=e.CreateFile||(e.CreateFile={}));var ie;(function(m){function _(T,p,q,W){var ue={kind:"rename",oldUri:T,newUri:p};return q!==void 0&&(q.overwrite!==void 0||q.ignoreIfExists!==void 0)&&(ue.options=q),W!==void 0&&(ue.annotationId=W),ue}m.create=_;function E(T){var p=T;return p&&p.kind==="rename"&&I.string(p.oldUri)&&I.string(p.newUri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(ie=e.RenameFile||(e.RenameFile={}));var Ee;(function(m){function _(T,p,q){var W={kind:"delete",uri:T};return p!==void 0&&(p.recursive!==void 0||p.ignoreIfNotExists!==void 0)&&(W.options=p),q!==void 0&&(W.annotationId=q),W}m.create=_;function E(T){var p=T;return p&&p.kind==="delete"&&I.string(p.uri)&&(p.options===void 0||(p.options.recursive===void 0||I.boolean(p.options.recursive))&&(p.options.ignoreIfNotExists===void 0||I.boolean(p.options.ignoreIfNotExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(Ee=e.DeleteFile||(e.DeleteFile={}));var Dt;(function(m){function _(E){var T=E;return T&&(T.changes!==void 0||T.documentChanges!==void 0)&&(T.documentChanges===void 0||T.documentChanges.every(function(p){return I.string(p.kind)?te.is(p)||ie.is(p)||Ee.is(p):J.is(p)}))}m.is=_})(Dt=e.WorkspaceEdit||(e.WorkspaceEdit={}));var ut=function(){function m(_,E){this.edits=_,this.changeAnnotations=E}return m.prototype.insert=function(_,E,T){var p,q;if(T===void 0?p=x.insert(_,E):N.is(T)?(q=T,p=U.insert(_,E,T)):(this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(T),p=U.insert(_,E,q)),this.edits.push(p),q!==void 0)return q},m.prototype.replace=function(_,E,T){var p,q;if(T===void 0?p=x.replace(_,E):N.is(T)?(q=T,p=U.replace(_,E,T)):(this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(T),p=U.replace(_,E,q)),this.edits.push(p),q!==void 0)return q},m.prototype.delete=function(_,E){var T,p;if(E===void 0?T=x.del(_):N.is(E)?(p=E,T=U.del(_,E)):(this.assertChangeAnnotations(this.changeAnnotations),p=this.changeAnnotations.manage(E),T=U.del(_,p)),this.edits.push(T),p!==void 0)return p},m.prototype.add=function(_){this.edits.push(_)},m.prototype.all=function(){return this.edits},m.prototype.clear=function(){this.edits.splice(0,this.edits.length)},m.prototype.assertChangeAnnotations=function(_){if(_===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},m}(),lt=function(){function m(_){this._annotations=_===void 0?Object.create(null):_,this._counter=0,this._size=0}return m.prototype.all=function(){return this._annotations},Object.defineProperty(m.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),m.prototype.manage=function(_,E){var T;if(N.is(_)?T=_:(T=this.nextId(),E=_),this._annotations[T]!==void 0)throw new Error("Id ".concat(T," is already in use."));if(E===void 0)throw new Error("No annotation provided for id ".concat(T));return this._annotations[T]=E,this._size++,T},m.prototype.nextId=function(){return this._counter++,this._counter.toString()},m}(),ve=function(){function m(_){var E=this;this._textEditChanges=Object.create(null),_!==void 0?(this._workspaceEdit=_,_.documentChanges?(this._changeAnnotations=new lt(_.changeAnnotations),_.changeAnnotations=this._changeAnnotations.all(),_.documentChanges.forEach(function(T){if(J.is(T)){var p=new ut(T.edits,E._changeAnnotations);E._textEditChanges[T.textDocument.uri]=p}})):_.changes&&Object.keys(_.changes).forEach(function(T){var p=new ut(_.changes[T]);E._textEditChanges[T]=p})):this._workspaceEdit={}}return Object.defineProperty(m.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),m.prototype.getTextEditChange=function(_){if(Wt.is(_)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var E={uri:_.uri,version:_.version},T=this._textEditChanges[E.uri];if(!T){var p=[],q={textDocument:E,edits:p};this._workspaceEdit.documentChanges.push(q),T=new ut(p,this._changeAnnotations),this._textEditChanges[E.uri]=T}return T}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var T=this._textEditChanges[_];if(!T){var p=[];this._workspaceEdit.changes[_]=p,T=new ut(p),this._textEditChanges[_]=T}return T}},m.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new lt,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},m.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},m.prototype.createFile=function(_,E,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;F.is(E)||N.is(E)?p=E:T=E;var q,W;if(p===void 0?q=te.create(_,T):(W=N.is(p)?p:this._changeAnnotations.manage(p),q=te.create(_,T,W)),this._workspaceEdit.documentChanges.push(q),W!==void 0)return W},m.prototype.renameFile=function(_,E,T,p){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var q;F.is(T)||N.is(T)?q=T:p=T;var W,ue;if(q===void 0?W=ie.create(_,E,p):(ue=N.is(q)?q:this._changeAnnotations.manage(q),W=ie.create(_,E,p,ue)),this._workspaceEdit.documentChanges.push(W),ue!==void 0)return ue},m.prototype.deleteFile=function(_,E,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;F.is(E)||N.is(E)?p=E:T=E;var q,W;if(p===void 0?q=Ee.create(_,T):(W=N.is(p)?p:this._changeAnnotations.manage(p),q=Ee.create(_,T,W)),this._workspaceEdit.documentChanges.push(q),W!==void 0)return W},m}();e.WorkspaceChange=ve;var Ze;(function(m){function _(T){return{uri:T}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)}m.is=E})(Ze=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var Ge;(function(m){function _(T,p){return{uri:T,version:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&I.integer(p.version)}m.is=E})(Ge=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var Wt;(function(m){function _(T,p){return{uri:T,version:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&(p.version===null||I.integer(p.version))}m.is=E})(Wt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var Zt;(function(m){function _(T,p,q,W){return{uri:T,languageId:p,version:q,text:W}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&I.string(p.languageId)&&I.integer(p.version)&&I.string(p.text)}m.is=E})(Zt=e.TextDocumentItem||(e.TextDocumentItem={}));var tr;(function(m){m.PlainText="plaintext",m.Markdown="markdown";function _(E){var T=E;return T===m.PlainText||T===m.Markdown}m.is=_})(tr=e.MarkupKind||(e.MarkupKind={}));var Ot;(function(m){function _(E){var T=E;return I.objectLiteral(E)&&tr.is(T.kind)&&I.string(T.value)}m.is=_})(Ot=e.MarkupContent||(e.MarkupContent={}));var di;(function(m){m.Text=1,m.Method=2,m.Function=3,m.Constructor=4,m.Field=5,m.Variable=6,m.Class=7,m.Interface=8,m.Module=9,m.Property=10,m.Unit=11,m.Value=12,m.Enum=13,m.Keyword=14,m.Snippet=15,m.Color=16,m.File=17,m.Reference=18,m.Folder=19,m.EnumMember=20,m.Constant=21,m.Struct=22,m.Event=23,m.Operator=24,m.TypeParameter=25})(di=e.CompletionItemKind||(e.CompletionItemKind={}));var $r;(function(m){m.PlainText=1,m.Snippet=2})($r=e.InsertTextFormat||(e.InsertTextFormat={}));var hr;(function(m){m.Deprecated=1})(hr=e.CompletionItemTag||(e.CompletionItemTag={}));var pr;(function(m){function _(T,p,q){return{newText:T,insert:p,replace:q}}m.create=_;function E(T){var p=T;return p&&I.string(p.newText)&&a.is(p.insert)&&a.is(p.replace)}m.is=E})(pr=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var gr;(function(m){m.asIs=1,m.adjustIndentation=2})(gr=e.InsertTextMode||(e.InsertTextMode={}));var fi;(function(m){function _(E){var T=E;return T&&(I.string(T.detail)||T.detail===void 0)&&(I.string(T.description)||T.description===void 0)}m.is=_})(fi=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var jr;(function(m){function _(E){return{label:E}}m.create=_})(jr=e.CompletionItem||(e.CompletionItem={}));var Wr;(function(m){function _(E,T){return{items:E||[],isIncomplete:!!T}}m.create=_})(Wr=e.CompletionList||(e.CompletionList={}));var mr;(function(m){function _(T){return T.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}m.fromPlainText=_;function E(T){var p=T;return I.string(p)||I.objectLiteral(p)&&I.string(p.language)&&I.string(p.value)}m.is=E})(mr=e.MarkedString||(e.MarkedString={}));var wt;(function(m){function _(E){var T=E;return!!T&&I.objectLiteral(T)&&(Ot.is(T.contents)||mr.is(T.contents)||I.typedArray(T.contents,mr.is))&&(E.range===void 0||a.is(E.range))}m.is=_})(wt=e.Hover||(e.Hover={}));var Hr;(function(m){function _(E,T){return T?{label:E,documentation:T}:{label:E}}m.create=_})(Hr=e.ParameterInformation||(e.ParameterInformation={}));var nr;(function(m){function _(E,T){for(var p=[],q=2;q<arguments.length;q++)p[q-2]=arguments[q];var W={label:E};return I.defined(T)&&(W.documentation=T),I.defined(p)?W.parameters=p:W.parameters=[],W}m.create=_})(nr=e.SignatureInformation||(e.SignatureInformation={}));var Tn;(function(m){m.Text=1,m.Read=2,m.Write=3})(Tn=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var Ur;(function(m){function _(E,T){var p={range:E};return I.number(T)&&(p.kind=T),p}m.create=_})(Ur=e.DocumentHighlight||(e.DocumentHighlight={}));var Ht;(function(m){m.File=1,m.Module=2,m.Namespace=3,m.Package=4,m.Class=5,m.Method=6,m.Property=7,m.Field=8,m.Constructor=9,m.Enum=10,m.Interface=11,m.Function=12,m.Variable=13,m.Constant=14,m.String=15,m.Number=16,m.Boolean=17,m.Array=18,m.Object=19,m.Key=20,m.Null=21,m.EnumMember=22,m.Struct=23,m.Event=24,m.Operator=25,m.TypeParameter=26})(Ht=e.SymbolKind||(e.SymbolKind={}));var vr;(function(m){m.Deprecated=1})(vr=e.SymbolTag||(e.SymbolTag={}));var dt;(function(m){function _(E,T,p,q,W){var ue={name:E,kind:T,location:{uri:q,range:p}};return W&&(ue.containerName=W),ue}m.create=_})(dt=e.SymbolInformation||(e.SymbolInformation={}));var qn;(function(m){function _(E,T,p,q){return q!==void 0?{name:E,kind:T,location:{uri:p,range:q}}:{name:E,kind:T,location:{uri:p}}}m.create=_})(qn=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var Ut;(function(m){function _(T,p,q,W,ue,Ve){var je={name:T,detail:p,kind:q,range:W,selectionRange:ue};return Ve!==void 0&&(je.children=Ve),je}m.create=_;function E(T){var p=T;return p&&I.string(p.name)&&I.number(p.kind)&&a.is(p.range)&&a.is(p.selectionRange)&&(p.detail===void 0||I.string(p.detail))&&(p.deprecated===void 0||I.boolean(p.deprecated))&&(p.children===void 0||Array.isArray(p.children))&&(p.tags===void 0||Array.isArray(p.tags))}m.is=E})(Ut=e.DocumentSymbol||(e.DocumentSymbol={}));var yr;(function(m){m.Empty="",m.QuickFix="quickfix",m.Refactor="refactor",m.RefactorExtract="refactor.extract",m.RefactorInline="refactor.inline",m.RefactorRewrite="refactor.rewrite",m.Source="source",m.SourceOrganizeImports="source.organizeImports",m.SourceFixAll="source.fixAll"})(yr=e.CodeActionKind||(e.CodeActionKind={}));var hn;(function(m){m.Invoked=1,m.Automatic=2})(hn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var wr;(function(m){function _(T,p,q){var W={diagnostics:T};return p!=null&&(W.only=p),q!=null&&(W.triggerKind=q),W}m.create=_;function E(T){var p=T;return I.defined(p)&&I.typedArray(p.diagnostics,D.is)&&(p.only===void 0||I.typedArray(p.only,I.string))&&(p.triggerKind===void 0||p.triggerKind===hn.Invoked||p.triggerKind===hn.Automatic)}m.is=E})(wr=e.CodeActionContext||(e.CodeActionContext={}));var Kr;(function(m){function _(T,p,q){var W={title:T},ue=!0;return typeof p=="string"?(ue=!1,W.kind=p):R.is(p)?W.command=p:W.edit=p,ue&&q!==void 0&&(W.kind=q),W}m.create=_;function E(T){var p=T;return p&&I.string(p.title)&&(p.diagnostics===void 0||I.typedArray(p.diagnostics,D.is))&&(p.kind===void 0||I.string(p.kind))&&(p.edit!==void 0||p.command!==void 0)&&(p.command===void 0||R.is(p.command))&&(p.isPreferred===void 0||I.boolean(p.isPreferred))&&(p.edit===void 0||Dt.is(p.edit))}m.is=E})(Kr=e.CodeAction||(e.CodeAction={}));var en;(function(m){function _(T,p){var q={range:T};return I.defined(p)&&(q.data=p),q}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(p.range)&&(I.undefined(p.command)||R.is(p.command))}m.is=E})(en=e.CodeLens||(e.CodeLens={}));var Vr;(function(m){function _(T,p){return{tabSize:T,insertSpaces:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.uinteger(p.tabSize)&&I.boolean(p.insertSpaces)}m.is=E})(Vr=e.FormattingOptions||(e.FormattingOptions={}));var pn;(function(m){function _(T,p,q){return{range:T,target:p,data:q}}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(p.range)&&(I.undefined(p.target)||I.string(p.target))}m.is=E})(pn=e.DocumentLink||(e.DocumentLink={}));var P;(function(m){function _(T,p){return{range:T,parent:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&(p.parent===void 0||m.is(p.parent))}m.is=E})(P=e.SelectionRange||(e.SelectionRange={}));var j;(function(m){m.namespace="namespace",m.type="type",m.class="class",m.enum="enum",m.interface="interface",m.struct="struct",m.typeParameter="typeParameter",m.parameter="parameter",m.variable="variable",m.property="property",m.enumMember="enumMember",m.event="event",m.function="function",m.method="method",m.macro="macro",m.keyword="keyword",m.modifier="modifier",m.comment="comment",m.string="string",m.number="number",m.regexp="regexp",m.operator="operator",m.decorator="decorator"})(j=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var B;(function(m){m.declaration="declaration",m.definition="definition",m.readonly="readonly",m.static="static",m.deprecated="deprecated",m.abstract="abstract",m.async="async",m.modification="modification",m.documentation="documentation",m.defaultLibrary="defaultLibrary"})(B=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var Y;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&(T.resultId===void 0||typeof T.resultId=="string")&&Array.isArray(T.data)&&(T.data.length===0||typeof T.data[0]=="number")}m.is=_})(Y=e.SemanticTokens||(e.SemanticTokens={}));var xe;(function(m){function _(T,p){return{range:T,text:p}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&I.string(p.text)}m.is=E})(xe=e.InlineValueText||(e.InlineValueText={}));var ke;(function(m){function _(T,p,q){return{range:T,variableName:p,caseSensitiveLookup:q}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&I.boolean(p.caseSensitiveLookup)&&(I.string(p.variableName)||p.variableName===void 0)}m.is=E})(ke=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var Re;(function(m){function _(T,p){return{range:T,expression:p}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&(I.string(p.expression)||p.expression===void 0)}m.is=E})(Re=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var We;(function(m){function _(T,p){return{frameId:T,stoppedLocation:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(T.stoppedLocation)}m.is=E})(We=e.InlineValueContext||(e.InlineValueContext={}));var fe;(function(m){m.Type=1,m.Parameter=2;function _(E){return E===1||E===2}m.is=_})(fe=e.InlayHintKind||(e.InlayHintKind={}));var Fe;(function(m){function _(T){return{value:T}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&(p.tooltip===void 0||I.string(p.tooltip)||Ot.is(p.tooltip))&&(p.location===void 0||c.is(p.location))&&(p.command===void 0||R.is(p.command))}m.is=E})(Fe=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var g;(function(m){function _(T,p,q){var W={position:T,label:p};return q!==void 0&&(W.kind=q),W}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&o.is(p.position)&&(I.string(p.label)||I.typedArray(p.label,Fe.is))&&(p.kind===void 0||fe.is(p.kind))&&p.textEdits===void 0||I.typedArray(p.textEdits,x.is)&&(p.tooltip===void 0||I.string(p.tooltip)||Ot.is(p.tooltip))&&(p.paddingLeft===void 0||I.boolean(p.paddingLeft))&&(p.paddingRight===void 0||I.boolean(p.paddingRight))}m.is=E})(g=e.InlayHint||(e.InlayHint={}));var M;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&r.is(T.uri)&&I.string(T.name)}m.is=_})(M=e.WorkspaceFolder||(e.WorkspaceFolder={})),e.EOL=[`
`,`\r
`,"\r"];var X;(function(m){function _(q,W,ue,Ve){return new he(q,W,ue,Ve)}m.create=_;function E(q){var W=q;return!!(I.defined(W)&&I.string(W.uri)&&(I.undefined(W.languageId)||I.string(W.languageId))&&I.uinteger(W.lineCount)&&I.func(W.getText)&&I.func(W.positionAt)&&I.func(W.offsetAt))}m.is=E;function T(q,W){for(var ue=q.getText(),Ve=p(W,function(Br,Wi){var Ns=Br.range.start.line-Wi.range.start.line;return Ns===0?Br.range.start.character-Wi.range.start.character:Ns}),je=ue.length,gn=Ve.length-1;gn>=0;gn--){var tn=Ve[gn],Ln=q.offsetAt(tn.range.start),Ce=q.offsetAt(tn.range.end);if(Ce<=je)ue=ue.substring(0,Ln)+tn.newText+ue.substring(Ce,ue.length);else throw new Error("Overlapping edit");je=Ln}return ue}m.applyEdits=T;function p(q,W){if(q.length<=1)return q;var ue=q.length/2|0,Ve=q.slice(0,ue),je=q.slice(ue);p(Ve,W),p(je,W);for(var gn=0,tn=0,Ln=0;gn<Ve.length&&tn<je.length;){var Ce=W(Ve[gn],je[tn]);Ce<=0?q[Ln++]=Ve[gn++]:q[Ln++]=je[tn++]}for(;gn<Ve.length;)q[Ln++]=Ve[gn++];for(;tn<je.length;)q[Ln++]=je[tn++];return q}})(X=e.TextDocument||(e.TextDocument={}));var he=function(){function m(_,E,T,p){this._uri=_,this._languageId=E,this._version=T,this._content=p,this._lineOffsets=void 0}return Object.defineProperty(m.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),m.prototype.getText=function(_){if(_){var E=this.offsetAt(_.start),T=this.offsetAt(_.end);return this._content.substring(E,T)}return this._content},m.prototype.update=function(_,E){this._content=_.text,this._version=E,this._lineOffsets=void 0},m.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var _=[],E=this._content,T=!0,p=0;p<E.length;p++){T&&(_.push(p),T=!1);var q=E.charAt(p);T=q==="\r"||q===`
`,q==="\r"&&p+1<E.length&&E.charAt(p+1)===`
`&&p++}T&&E.length>0&&_.push(E.length),this._lineOffsets=_}return this._lineOffsets},m.prototype.positionAt=function(_){_=Math.max(Math.min(_,this._content.length),0);var E=this.getLineOffsets(),T=0,p=E.length;if(p===0)return o.create(0,_);for(;T<p;){var q=Math.floor((T+p)/2);E[q]>_?p=q:T=q+1}var W=T-1;return o.create(W,_-E[W])},m.prototype.offsetAt=function(_){var E=this.getLineOffsets();if(_.line>=E.length)return this._content.length;if(_.line<0)return 0;var T=E[_.line],p=_.line+1<E.length?E[_.line+1]:this._content.length;return Math.max(Math.min(T+_.character,p),T)},Object.defineProperty(m.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),m}(),I;(function(m){var _=Object.prototype.toString;function E(Ce){return typeof Ce!="undefined"}m.defined=E;function T(Ce){return typeof Ce=="undefined"}m.undefined=T;function p(Ce){return Ce===!0||Ce===!1}m.boolean=p;function q(Ce){return _.call(Ce)==="[object String]"}m.string=q;function W(Ce){return _.call(Ce)==="[object Number]"}m.number=W;function ue(Ce,Br,Wi){return _.call(Ce)==="[object Number]"&&Br<=Ce&&Ce<=Wi}m.numberRange=ue;function Ve(Ce){return _.call(Ce)==="[object Number]"&&-2147483648<=Ce&&Ce<=2147483647}m.integer=Ve;function je(Ce){return _.call(Ce)==="[object Number]"&&0<=Ce&&Ce<=2147483647}m.uinteger=je;function gn(Ce){return _.call(Ce)==="[object Function]"}m.func=gn;function tn(Ce){return Ce!==null&&typeof Ce=="object"}m.objectLiteral=tn;function Ln(Ce,Br){return Array.isArray(Ce)&&Ce.every(Br)}m.typedArray=Ln})(I||(I={}))})});var tt=L(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.ProtocolNotificationType=Bt.ProtocolNotificationType0=Bt.ProtocolRequestType=Bt.ProtocolRequestType0=Bt.RegistrationType=Bt.MessageDirection=void 0;var ls=Ri(),BT;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(BT=Bt.MessageDirection||(Bt.MessageDirection={}));var gm=class{constructor(e){this.method=e}};Bt.RegistrationType=gm;var mm=class extends ls.RequestType0{constructor(e){super(e)}};Bt.ProtocolRequestType0=mm;var vm=class extends ls.RequestType{constructor(e){super(e,ls.ParameterStructures.byName)}};Bt.ProtocolRequestType=vm;var ym=class extends ls.NotificationType0{constructor(e){super(e)}};Bt.ProtocolNotificationType0=ym;var wm=class extends ls.NotificationType{constructor(e){super(e,ls.ParameterStructures.byName)}};Bt.ProtocolNotificationType=wm});var Va=L(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.objectLiteral=gt.typedArray=gt.stringArray=gt.array=gt.func=gt.error=gt.number=gt.string=gt.boolean=void 0;function XT(n){return n===!0||n===!1}gt.boolean=XT;function bm(n){return typeof n=="string"||n instanceof String}gt.string=bm;function zT(n){return typeof n=="number"||n instanceof Number}gt.number=zT;function GT(n){return n instanceof Error}gt.error=GT;function QT(n){return typeof n=="function"}gt.func=QT;function Cm(n){return Array.isArray(n)}gt.array=Cm;function YT(n){return Cm(n)&&n.every(e=>bm(e))}gt.stringArray=YT;function JT(n,e){return Array.isArray(n)&&n.every(e)}gt.typedArray=JT;function ZT(n){return n!==null&&typeof n=="object"}gt.objectLiteral=ZT});var Tm=L(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.ImplementationRequest=void 0;var Dm=tt(),eS;(function(n){n.method="textDocument/implementation",n.messageDirection=Dm.MessageDirection.clientToServer,n.type=new Dm.ProtocolRequestType(n.method)})(eS=Ro.ImplementationRequest||(Ro.ImplementationRequest={}))});var km=L(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.TypeDefinitionRequest=void 0;var Sm=tt(),tS;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=Sm.MessageDirection.clientToServer,n.type=new Sm.ProtocolRequestType(n.method)})(tS=Po.TypeDefinitionRequest||(Po.TypeDefinitionRequest={}))});var Rm=L(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.DidChangeWorkspaceFoldersNotification=ei.WorkspaceFoldersRequest=void 0;var Ba=tt(),nS;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=Ba.MessageDirection.serverToClient,n.type=new Ba.ProtocolRequestType0(n.method)})(nS=ei.WorkspaceFoldersRequest||(ei.WorkspaceFoldersRequest={}));var rS;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=Ba.MessageDirection.clientToServer,n.type=new Ba.ProtocolNotificationType(n.method)})(rS=ei.DidChangeWorkspaceFoldersNotification||(ei.DidChangeWorkspaceFoldersNotification={}))});var _m=L(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.ConfigurationRequest=void 0;var Pm=tt(),iS;(function(n){n.method="workspace/configuration",n.messageDirection=Pm.MessageDirection.serverToClient,n.type=new Pm.ProtocolRequestType(n.method)})(iS=_o.ConfigurationRequest||(_o.ConfigurationRequest={}))});var Em=L(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.ColorPresentationRequest=ti.DocumentColorRequest=void 0;var Xa=tt(),sS;(function(n){n.method="textDocument/documentColor",n.messageDirection=Xa.MessageDirection.clientToServer,n.type=new Xa.ProtocolRequestType(n.method)})(sS=ti.DocumentColorRequest||(ti.DocumentColorRequest={}));var oS;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Xa.MessageDirection.clientToServer,n.type=new Xa.ProtocolRequestType(n.method)})(oS=ti.ColorPresentationRequest||(ti.ColorPresentationRequest={}))});var Fm=L(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.FoldingRangeRequest=void 0;var xm=tt(),aS;(function(n){n.method="textDocument/foldingRange",n.messageDirection=xm.MessageDirection.clientToServer,n.type=new xm.ProtocolRequestType(n.method)})(aS=Eo.FoldingRangeRequest||(Eo.FoldingRangeRequest={}))});var Om=L(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.DeclarationRequest=void 0;var Im=tt(),cS;(function(n){n.method="textDocument/declaration",n.messageDirection=Im.MessageDirection.clientToServer,n.type=new Im.ProtocolRequestType(n.method)})(cS=xo.DeclarationRequest||(xo.DeclarationRequest={}))});var qm=L(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.SelectionRangeRequest=void 0;var Nm=tt(),uS;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Nm.MessageDirection.clientToServer,n.type=new Nm.ProtocolRequestType(n.method)})(uS=Fo.SelectionRangeRequest||(Fo.SelectionRangeRequest={}))});var Lm=L(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.WorkDoneProgressCancelNotification=Un.WorkDoneProgressCreateRequest=Un.WorkDoneProgress=void 0;var lS=Ri(),za=tt(),dS;(function(n){n.type=new lS.ProgressType;function e(t){return t===n.type}n.is=e})(dS=Un.WorkDoneProgress||(Un.WorkDoneProgress={}));var fS;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=za.MessageDirection.serverToClient,n.type=new za.ProtocolRequestType(n.method)})(fS=Un.WorkDoneProgressCreateRequest||(Un.WorkDoneProgressCreateRequest={}));var hS;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=za.MessageDirection.clientToServer,n.type=new za.ProtocolNotificationType(n.method)})(hS=Un.WorkDoneProgressCancelNotification||(Un.WorkDoneProgressCancelNotification={}))});var Mm=L(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.CallHierarchyOutgoingCallsRequest=Kn.CallHierarchyIncomingCallsRequest=Kn.CallHierarchyPrepareRequest=void 0;var ds=tt(),pS;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=ds.MessageDirection.clientToServer,n.type=new ds.ProtocolRequestType(n.method)})(pS=Kn.CallHierarchyPrepareRequest||(Kn.CallHierarchyPrepareRequest={}));var gS;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=ds.MessageDirection.clientToServer,n.type=new ds.ProtocolRequestType(n.method)})(gS=Kn.CallHierarchyIncomingCallsRequest||(Kn.CallHierarchyIncomingCallsRequest={}));var mS;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=ds.MessageDirection.clientToServer,n.type=new ds.ProtocolRequestType(n.method)})(mS=Kn.CallHierarchyOutgoingCallsRequest||(Kn.CallHierarchyOutgoingCallsRequest={}))});var Am=L(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.SemanticTokensRefreshRequest=mt.SemanticTokensRangeRequest=mt.SemanticTokensDeltaRequest=mt.SemanticTokensRequest=mt.SemanticTokensRegistrationType=mt.TokenFormat=void 0;var _r=tt(),vS;(function(n){n.Relative="relative"})(vS=mt.TokenFormat||(mt.TokenFormat={}));var Ga;(function(n){n.method="textDocument/semanticTokens",n.type=new _r.RegistrationType(n.method)})(Ga=mt.SemanticTokensRegistrationType||(mt.SemanticTokensRegistrationType={}));var yS;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=_r.MessageDirection.clientToServer,n.type=new _r.ProtocolRequestType(n.method),n.registrationMethod=Ga.method})(yS=mt.SemanticTokensRequest||(mt.SemanticTokensRequest={}));var wS;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=_r.MessageDirection.clientToServer,n.type=new _r.ProtocolRequestType(n.method),n.registrationMethod=Ga.method})(wS=mt.SemanticTokensDeltaRequest||(mt.SemanticTokensDeltaRequest={}));var bS;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=_r.MessageDirection.clientToServer,n.type=new _r.ProtocolRequestType(n.method),n.registrationMethod=Ga.method})(bS=mt.SemanticTokensRangeRequest||(mt.SemanticTokensRangeRequest={}));var CS;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=_r.MessageDirection.serverToClient,n.type=new _r.ProtocolRequestType0(n.method)})(CS=mt.SemanticTokensRefreshRequest||(mt.SemanticTokensRefreshRequest={}))});var jm=L(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.ShowDocumentRequest=void 0;var $m=tt(),DS;(function(n){n.method="window/showDocument",n.messageDirection=$m.MessageDirection.serverToClient,n.type=new $m.ProtocolRequestType(n.method)})(DS=Io.ShowDocumentRequest||(Io.ShowDocumentRequest={}))});var Hm=L(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.LinkedEditingRangeRequest=void 0;var Wm=tt(),TS;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=Wm.MessageDirection.clientToServer,n.type=new Wm.ProtocolRequestType(n.method)})(TS=Oo.LinkedEditingRangeRequest||(Oo.LinkedEditingRangeRequest={}))});var Um=L(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.WillDeleteFilesRequest=nt.DidDeleteFilesNotification=nt.DidRenameFilesNotification=nt.WillRenameFilesRequest=nt.DidCreateFilesNotification=nt.WillCreateFilesRequest=nt.FileOperationPatternKind=void 0;var En=tt(),SS;(function(n){n.file="file",n.folder="folder"})(SS=nt.FileOperationPatternKind||(nt.FileOperationPatternKind={}));var kS;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolRequestType(n.method)})(kS=nt.WillCreateFilesRequest||(nt.WillCreateFilesRequest={}));var RS;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolNotificationType(n.method)})(RS=nt.DidCreateFilesNotification||(nt.DidCreateFilesNotification={}));var PS;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolRequestType(n.method)})(PS=nt.WillRenameFilesRequest||(nt.WillRenameFilesRequest={}));var _S;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolNotificationType(n.method)})(_S=nt.DidRenameFilesNotification||(nt.DidRenameFilesNotification={}));var ES;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolNotificationType(n.method)})(ES=nt.DidDeleteFilesNotification||(nt.DidDeleteFilesNotification={}));var xS;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=En.MessageDirection.clientToServer,n.type=new En.ProtocolRequestType(n.method)})(xS=nt.WillDeleteFilesRequest||(nt.WillDeleteFilesRequest={}))});var Vm=L(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.MonikerRequest=Vn.MonikerKind=Vn.UniquenessLevel=void 0;var Km=tt(),FS;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(FS=Vn.UniquenessLevel||(Vn.UniquenessLevel={}));var IS;(function(n){n.$import="import",n.$export="export",n.local="local"})(IS=Vn.MonikerKind||(Vn.MonikerKind={}));var OS;(function(n){n.method="textDocument/moniker",n.messageDirection=Km.MessageDirection.clientToServer,n.type=new Km.ProtocolRequestType(n.method)})(OS=Vn.MonikerRequest||(Vn.MonikerRequest={}))});var Bm=L(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.TypeHierarchySubtypesRequest=Bn.TypeHierarchySupertypesRequest=Bn.TypeHierarchyPrepareRequest=void 0;var fs=tt(),NS;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=fs.MessageDirection.clientToServer,n.type=new fs.ProtocolRequestType(n.method)})(NS=Bn.TypeHierarchyPrepareRequest||(Bn.TypeHierarchyPrepareRequest={}));var qS;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=fs.MessageDirection.clientToServer,n.type=new fs.ProtocolRequestType(n.method)})(qS=Bn.TypeHierarchySupertypesRequest||(Bn.TypeHierarchySupertypesRequest={}));var LS;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=fs.MessageDirection.clientToServer,n.type=new fs.ProtocolRequestType(n.method)})(LS=Bn.TypeHierarchySubtypesRequest||(Bn.TypeHierarchySubtypesRequest={}))});var Xm=L(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.InlineValueRefreshRequest=ni.InlineValueRequest=void 0;var Qa=tt(),MS;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Qa.MessageDirection.clientToServer,n.type=new Qa.ProtocolRequestType(n.method)})(MS=ni.InlineValueRequest||(ni.InlineValueRequest={}));var AS;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Qa.MessageDirection.serverToClient,n.type=new Qa.ProtocolRequestType0(n.method)})(AS=ni.InlineValueRefreshRequest||(ni.InlineValueRefreshRequest={}))});var zm=L(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.InlayHintRefreshRequest=Xn.InlayHintResolveRequest=Xn.InlayHintRequest=void 0;var hs=tt(),$S;(function(n){n.method="textDocument/inlayHint",n.messageDirection=hs.MessageDirection.clientToServer,n.type=new hs.ProtocolRequestType(n.method)})($S=Xn.InlayHintRequest||(Xn.InlayHintRequest={}));var jS;(function(n){n.method="inlayHint/resolve",n.messageDirection=hs.MessageDirection.clientToServer,n.type=new hs.ProtocolRequestType(n.method)})(jS=Xn.InlayHintResolveRequest||(Xn.InlayHintResolveRequest={}));var WS;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=hs.MessageDirection.serverToClient,n.type=new hs.ProtocolRequestType0(n.method)})(WS=Xn.InlayHintRefreshRequest||(Xn.InlayHintRefreshRequest={}))});var Qm=L(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.DiagnosticRefreshRequest=xt.WorkspaceDiagnosticRequest=xt.DocumentDiagnosticRequest=xt.DocumentDiagnosticReportKind=xt.DiagnosticServerCancellationData=void 0;var Gm=Ri(),HS=Va(),ps=tt(),US;(function(n){function e(t){let r=t;return r&&HS.boolean(r.retriggerRequest)}n.is=e})(US=xt.DiagnosticServerCancellationData||(xt.DiagnosticServerCancellationData={}));var KS;(function(n){n.Full="full",n.Unchanged="unchanged"})(KS=xt.DocumentDiagnosticReportKind||(xt.DocumentDiagnosticReportKind={}));var VS;(function(n){n.method="textDocument/diagnostic",n.messageDirection=ps.MessageDirection.clientToServer,n.type=new ps.ProtocolRequestType(n.method),n.partialResult=new Gm.ProgressType})(VS=xt.DocumentDiagnosticRequest||(xt.DocumentDiagnosticRequest={}));var BS;(function(n){n.method="workspace/diagnostic",n.messageDirection=ps.MessageDirection.clientToServer,n.type=new ps.ProtocolRequestType(n.method),n.partialResult=new Gm.ProgressType})(BS=xt.WorkspaceDiagnosticRequest||(xt.WorkspaceDiagnosticRequest={}));var XS;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=ps.MessageDirection.serverToClient,n.type=new ps.ProtocolRequestType0(n.method)})(XS=xt.DiagnosticRefreshRequest||(xt.DiagnosticRefreshRequest={}))});var Zm=L(Ie=>{"use strict";Object.defineProperty(Ie,"__esModule",{value:!0});Ie.DidCloseNotebookDocumentNotification=Ie.DidSaveNotebookDocumentNotification=Ie.DidChangeNotebookDocumentNotification=Ie.NotebookCellArrayChange=Ie.DidOpenNotebookDocumentNotification=Ie.NotebookDocumentSyncRegistrationType=Ie.NotebookDocument=Ie.NotebookCell=Ie.ExecutionSummary=Ie.NotebookCellKind=void 0;var No=Ka(),zn=Va(),or=tt(),Ym;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(Ym=Ie.NotebookCellKind||(Ie.NotebookCellKind={}));var Jm;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return zn.objectLiteral(s)&&No.uinteger.is(s.executionOrder)&&(s.success===void 0||zn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(Jm=Ie.ExecutionSummary||(Ie.ExecutionSummary={}));var Rl;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return zn.objectLiteral(o)&&Ym.is(o.kind)&&No.DocumentUri.is(o.document)&&(o.metadata===void 0||zn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!Jm.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),c=Array.isArray(o);if(a!==c)return!1;if(a&&c){if(s.length!==o.length)return!1;for(let u=0;u<s.length;u++)if(!i(s[u],o[u]))return!1}if(zn.objectLiteral(s)&&zn.objectLiteral(o)){let u=Object.keys(s),l=Object.keys(o);if(u.length!==l.length||(u.sort(),l.sort(),!i(u,l)))return!1;for(let h=0;h<u.length;h++){let f=u[h];if(!i(s[f],o[f]))return!1}}return!0}})(Rl=Ie.NotebookCell||(Ie.NotebookCell={}));var zS;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return zn.objectLiteral(i)&&zn.string(i.uri)&&No.integer.is(i.version)&&zn.typedArray(i.cells,Rl.is)}n.is=t})(zS=Ie.NotebookDocument||(Ie.NotebookDocument={}));var qo;(function(n){n.method="notebookDocument/sync",n.messageDirection=or.MessageDirection.clientToServer,n.type=new or.RegistrationType(n.method)})(qo=Ie.NotebookDocumentSyncRegistrationType||(Ie.NotebookDocumentSyncRegistrationType={}));var GS;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=or.MessageDirection.clientToServer,n.type=new or.ProtocolNotificationType(n.method),n.registrationMethod=qo.method})(GS=Ie.DidOpenNotebookDocumentNotification||(Ie.DidOpenNotebookDocumentNotification={}));var QS;(function(n){function e(r){let i=r;return zn.objectLiteral(i)&&No.uinteger.is(i.start)&&No.uinteger.is(i.deleteCount)&&(i.cells===void 0||zn.typedArray(i.cells,Rl.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(QS=Ie.NotebookCellArrayChange||(Ie.NotebookCellArrayChange={}));var YS;(function(n){n.method="notebookDocument/didChange",n.messageDirection=or.MessageDirection.clientToServer,n.type=new or.ProtocolNotificationType(n.method),n.registrationMethod=qo.method})(YS=Ie.DidChangeNotebookDocumentNotification||(Ie.DidChangeNotebookDocumentNotification={}));var JS;(function(n){n.method="notebookDocument/didSave",n.messageDirection=or.MessageDirection.clientToServer,n.type=new or.ProtocolNotificationType(n.method),n.registrationMethod=qo.method})(JS=Ie.DidSaveNotebookDocumentNotification||(Ie.DidSaveNotebookDocumentNotification={}));var ZS;(function(n){n.method="notebookDocument/didClose",n.messageDirection=or.MessageDirection.clientToServer,n.type=new or.ProtocolNotificationType(n.method),n.registrationMethod=qo.method})(ZS=Ie.DidCloseNotebookDocumentNotification||(Ie.DidCloseNotebookDocumentNotification={}))});var cv=L(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.WorkspaceSymbolRequest=w.CodeActionResolveRequest=w.CodeActionRequest=w.DocumentSymbolRequest=w.DocumentHighlightRequest=w.ReferencesRequest=w.DefinitionRequest=w.SignatureHelpRequest=w.SignatureHelpTriggerKind=w.HoverRequest=w.CompletionResolveRequest=w.CompletionRequest=w.CompletionTriggerKind=w.PublishDiagnosticsNotification=w.WatchKind=w.RelativePattern=w.FileChangeType=w.DidChangeWatchedFilesNotification=w.WillSaveTextDocumentWaitUntilRequest=w.WillSaveTextDocumentNotification=w.TextDocumentSaveReason=w.DidSaveTextDocumentNotification=w.DidCloseTextDocumentNotification=w.DidChangeTextDocumentNotification=w.TextDocumentContentChangeEvent=w.DidOpenTextDocumentNotification=w.TextDocumentSyncKind=w.TelemetryEventNotification=w.LogMessageNotification=w.ShowMessageRequest=w.ShowMessageNotification=w.MessageType=w.DidChangeConfigurationNotification=w.ExitNotification=w.ShutdownRequest=w.InitializedNotification=w.InitializeErrorCodes=w.InitializeRequest=w.WorkDoneProgressOptions=w.TextDocumentRegistrationOptions=w.StaticRegistrationOptions=w.PositionEncodingKind=w.FailureHandlingKind=w.ResourceOperationKind=w.UnregistrationRequest=w.RegistrationRequest=w.DocumentSelector=w.NotebookCellTextDocumentFilter=w.NotebookDocumentFilter=w.TextDocumentFilter=void 0;w.TypeHierarchySubtypesRequest=w.TypeHierarchyPrepareRequest=w.MonikerRequest=w.MonikerKind=w.UniquenessLevel=w.WillDeleteFilesRequest=w.DidDeleteFilesNotification=w.WillRenameFilesRequest=w.DidRenameFilesNotification=w.WillCreateFilesRequest=w.DidCreateFilesNotification=w.FileOperationPatternKind=w.LinkedEditingRangeRequest=w.ShowDocumentRequest=w.SemanticTokensRegistrationType=w.SemanticTokensRefreshRequest=w.SemanticTokensRangeRequest=w.SemanticTokensDeltaRequest=w.SemanticTokensRequest=w.TokenFormat=w.CallHierarchyPrepareRequest=w.CallHierarchyOutgoingCallsRequest=w.CallHierarchyIncomingCallsRequest=w.WorkDoneProgressCancelNotification=w.WorkDoneProgressCreateRequest=w.WorkDoneProgress=w.SelectionRangeRequest=w.DeclarationRequest=w.FoldingRangeRequest=w.ColorPresentationRequest=w.DocumentColorRequest=w.ConfigurationRequest=w.DidChangeWorkspaceFoldersNotification=w.WorkspaceFoldersRequest=w.TypeDefinitionRequest=w.ImplementationRequest=w.ApplyWorkspaceEditRequest=w.ExecuteCommandRequest=w.PrepareRenameRequest=w.RenameRequest=w.PrepareSupportDefaultBehavior=w.DocumentOnTypeFormattingRequest=w.DocumentRangeFormattingRequest=w.DocumentFormattingRequest=w.DocumentLinkResolveRequest=w.DocumentLinkRequest=w.CodeLensRefreshRequest=w.CodeLensResolveRequest=w.CodeLensRequest=w.WorkspaceSymbolResolveRequest=void 0;w.DidCloseNotebookDocumentNotification=w.DidSaveNotebookDocumentNotification=w.DidChangeNotebookDocumentNotification=w.NotebookCellArrayChange=w.DidOpenNotebookDocumentNotification=w.NotebookDocumentSyncRegistrationType=w.NotebookDocument=w.NotebookCell=w.ExecutionSummary=w.NotebookCellKind=w.DiagnosticRefreshRequest=w.WorkspaceDiagnosticRequest=w.DocumentDiagnosticRequest=w.DocumentDiagnosticReportKind=w.DiagnosticServerCancellationData=w.InlayHintRefreshRequest=w.InlayHintResolveRequest=w.InlayHintRequest=w.InlineValueRefreshRequest=w.InlineValueRequest=w.TypeHierarchySupertypesRequest=void 0;var V=tt(),ev=Ka(),Ft=Va(),ek=Tm();Object.defineProperty(w,"ImplementationRequest",{enumerable:!0,get:function(){return ek.ImplementationRequest}});var tk=km();Object.defineProperty(w,"TypeDefinitionRequest",{enumerable:!0,get:function(){return tk.TypeDefinitionRequest}});var tv=Rm();Object.defineProperty(w,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return tv.WorkspaceFoldersRequest}});Object.defineProperty(w,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return tv.DidChangeWorkspaceFoldersNotification}});var nk=_m();Object.defineProperty(w,"ConfigurationRequest",{enumerable:!0,get:function(){return nk.ConfigurationRequest}});var nv=Em();Object.defineProperty(w,"DocumentColorRequest",{enumerable:!0,get:function(){return nv.DocumentColorRequest}});Object.defineProperty(w,"ColorPresentationRequest",{enumerable:!0,get:function(){return nv.ColorPresentationRequest}});var rk=Fm();Object.defineProperty(w,"FoldingRangeRequest",{enumerable:!0,get:function(){return rk.FoldingRangeRequest}});var ik=Om();Object.defineProperty(w,"DeclarationRequest",{enumerable:!0,get:function(){return ik.DeclarationRequest}});var sk=qm();Object.defineProperty(w,"SelectionRangeRequest",{enumerable:!0,get:function(){return sk.SelectionRangeRequest}});var Pl=Lm();Object.defineProperty(w,"WorkDoneProgress",{enumerable:!0,get:function(){return Pl.WorkDoneProgress}});Object.defineProperty(w,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return Pl.WorkDoneProgressCreateRequest}});Object.defineProperty(w,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return Pl.WorkDoneProgressCancelNotification}});var _l=Mm();Object.defineProperty(w,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return _l.CallHierarchyIncomingCallsRequest}});Object.defineProperty(w,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return _l.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(w,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return _l.CallHierarchyPrepareRequest}});var gs=Am();Object.defineProperty(w,"TokenFormat",{enumerable:!0,get:function(){return gs.TokenFormat}});Object.defineProperty(w,"SemanticTokensRequest",{enumerable:!0,get:function(){return gs.SemanticTokensRequest}});Object.defineProperty(w,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return gs.SemanticTokensDeltaRequest}});Object.defineProperty(w,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return gs.SemanticTokensRangeRequest}});Object.defineProperty(w,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return gs.SemanticTokensRefreshRequest}});Object.defineProperty(w,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return gs.SemanticTokensRegistrationType}});var ok=jm();Object.defineProperty(w,"ShowDocumentRequest",{enumerable:!0,get:function(){return ok.ShowDocumentRequest}});var ak=Hm();Object.defineProperty(w,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return ak.LinkedEditingRangeRequest}});var Pi=Um();Object.defineProperty(w,"FileOperationPatternKind",{enumerable:!0,get:function(){return Pi.FileOperationPatternKind}});Object.defineProperty(w,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Pi.DidCreateFilesNotification}});Object.defineProperty(w,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Pi.WillCreateFilesRequest}});Object.defineProperty(w,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Pi.DidRenameFilesNotification}});Object.defineProperty(w,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Pi.WillRenameFilesRequest}});Object.defineProperty(w,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Pi.DidDeleteFilesNotification}});Object.defineProperty(w,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Pi.WillDeleteFilesRequest}});var El=Vm();Object.defineProperty(w,"UniquenessLevel",{enumerable:!0,get:function(){return El.UniquenessLevel}});Object.defineProperty(w,"MonikerKind",{enumerable:!0,get:function(){return El.MonikerKind}});Object.defineProperty(w,"MonikerRequest",{enumerable:!0,get:function(){return El.MonikerRequest}});var xl=Bm();Object.defineProperty(w,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return xl.TypeHierarchyPrepareRequest}});Object.defineProperty(w,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return xl.TypeHierarchySubtypesRequest}});Object.defineProperty(w,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return xl.TypeHierarchySupertypesRequest}});var rv=Xm();Object.defineProperty(w,"InlineValueRequest",{enumerable:!0,get:function(){return rv.InlineValueRequest}});Object.defineProperty(w,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return rv.InlineValueRefreshRequest}});var Fl=zm();Object.defineProperty(w,"InlayHintRequest",{enumerable:!0,get:function(){return Fl.InlayHintRequest}});Object.defineProperty(w,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Fl.InlayHintResolveRequest}});Object.defineProperty(w,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Fl.InlayHintRefreshRequest}});var Lo=Qm();Object.defineProperty(w,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Lo.DiagnosticServerCancellationData}});Object.defineProperty(w,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Lo.DocumentDiagnosticReportKind}});Object.defineProperty(w,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Lo.DocumentDiagnosticRequest}});Object.defineProperty(w,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Lo.WorkspaceDiagnosticRequest}});Object.defineProperty(w,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Lo.DiagnosticRefreshRequest}});var ar=Zm();Object.defineProperty(w,"NotebookCellKind",{enumerable:!0,get:function(){return ar.NotebookCellKind}});Object.defineProperty(w,"ExecutionSummary",{enumerable:!0,get:function(){return ar.ExecutionSummary}});Object.defineProperty(w,"NotebookCell",{enumerable:!0,get:function(){return ar.NotebookCell}});Object.defineProperty(w,"NotebookDocument",{enumerable:!0,get:function(){return ar.NotebookDocument}});Object.defineProperty(w,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return ar.NotebookDocumentSyncRegistrationType}});Object.defineProperty(w,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return ar.DidOpenNotebookDocumentNotification}});Object.defineProperty(w,"NotebookCellArrayChange",{enumerable:!0,get:function(){return ar.NotebookCellArrayChange}});Object.defineProperty(w,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return ar.DidChangeNotebookDocumentNotification}});Object.defineProperty(w,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return ar.DidSaveNotebookDocumentNotification}});Object.defineProperty(w,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return ar.DidCloseNotebookDocumentNotification}});var iv;(function(n){function e(t){let r=t;return Ft.string(r.language)||Ft.string(r.scheme)||Ft.string(r.pattern)}n.is=e})(iv=w.TextDocumentFilter||(w.TextDocumentFilter={}));var sv;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(Ft.string(r.notebookType)||Ft.string(r.scheme)||Ft.string(r.pattern))}n.is=e})(sv=w.NotebookDocumentFilter||(w.NotebookDocumentFilter={}));var ov;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(Ft.string(r.notebook)||sv.is(r.notebook))&&(r.language===void 0||Ft.string(r.language))}n.is=e})(ov=w.NotebookCellTextDocumentFilter||(w.NotebookCellTextDocumentFilter={}));var av;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!Ft.string(r)&&!iv.is(r)&&!ov.is(r))return!1;return!0}n.is=e})(av=w.DocumentSelector||(w.DocumentSelector={}));var ck;(function(n){n.method="client/registerCapability",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(ck=w.RegistrationRequest||(w.RegistrationRequest={}));var uk;(function(n){n.method="client/unregisterCapability",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(uk=w.UnregistrationRequest||(w.UnregistrationRequest={}));var lk;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(lk=w.ResourceOperationKind||(w.ResourceOperationKind={}));var dk;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(dk=w.FailureHandlingKind||(w.FailureHandlingKind={}));var fk;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(fk=w.PositionEncodingKind||(w.PositionEncodingKind={}));var hk;(function(n){function e(t){let r=t;return r&&Ft.string(r.id)&&r.id.length>0}n.hasId=e})(hk=w.StaticRegistrationOptions||(w.StaticRegistrationOptions={}));var pk;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||av.is(r.documentSelector))}n.is=e})(pk=w.TextDocumentRegistrationOptions||(w.TextDocumentRegistrationOptions={}));var gk;(function(n){function e(r){let i=r;return Ft.objectLiteral(i)&&(i.workDoneProgress===void 0||Ft.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&Ft.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(gk=w.WorkDoneProgressOptions||(w.WorkDoneProgressOptions={}));var mk;(function(n){n.method="initialize",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(mk=w.InitializeRequest||(w.InitializeRequest={}));var vk;(function(n){n.unknownProtocolVersion=1})(vk=w.InitializeErrorCodes||(w.InitializeErrorCodes={}));var yk;(function(n){n.method="initialized",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(yk=w.InitializedNotification||(w.InitializedNotification={}));var wk;(function(n){n.method="shutdown",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType0(n.method)})(wk=w.ShutdownRequest||(w.ShutdownRequest={}));var bk;(function(n){n.method="exit",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType0(n.method)})(bk=w.ExitNotification||(w.ExitNotification={}));var Ck;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(Ck=w.DidChangeConfigurationNotification||(w.DidChangeConfigurationNotification={}));var Dk;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(Dk=w.MessageType||(w.MessageType={}));var Tk;(function(n){n.method="window/showMessage",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(Tk=w.ShowMessageNotification||(w.ShowMessageNotification={}));var Sk;(function(n){n.method="window/showMessageRequest",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(Sk=w.ShowMessageRequest||(w.ShowMessageRequest={}));var kk;(function(n){n.method="window/logMessage",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(kk=w.LogMessageNotification||(w.LogMessageNotification={}));var Rk;(function(n){n.method="telemetry/event",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(Rk=w.TelemetryEventNotification||(w.TelemetryEventNotification={}));var Pk;(function(n){n.None=0,n.Full=1,n.Incremental=2})(Pk=w.TextDocumentSyncKind||(w.TextDocumentSyncKind={}));var _k;(function(n){n.method="textDocument/didOpen",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(_k=w.DidOpenTextDocumentNotification||(w.DidOpenTextDocumentNotification={}));var Ek;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(Ek=w.TextDocumentContentChangeEvent||(w.TextDocumentContentChangeEvent={}));var xk;(function(n){n.method="textDocument/didChange",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(xk=w.DidChangeTextDocumentNotification||(w.DidChangeTextDocumentNotification={}));var Fk;(function(n){n.method="textDocument/didClose",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(Fk=w.DidCloseTextDocumentNotification||(w.DidCloseTextDocumentNotification={}));var Ik;(function(n){n.method="textDocument/didSave",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(Ik=w.DidSaveTextDocumentNotification||(w.DidSaveTextDocumentNotification={}));var Ok;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(Ok=w.TextDocumentSaveReason||(w.TextDocumentSaveReason={}));var Nk;(function(n){n.method="textDocument/willSave",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(Nk=w.WillSaveTextDocumentNotification||(w.WillSaveTextDocumentNotification={}));var qk;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(qk=w.WillSaveTextDocumentWaitUntilRequest||(w.WillSaveTextDocumentWaitUntilRequest={}));var Lk;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(Lk=w.DidChangeWatchedFilesNotification||(w.DidChangeWatchedFilesNotification={}));var Mk;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(Mk=w.FileChangeType||(w.FileChangeType={}));var Ak;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(ev.URI.is(r.baseUri)||ev.WorkspaceFolder.is(r.baseUri))&&Ft.string(r.pattern)}n.is=e})(Ak=w.RelativePattern||(w.RelativePattern={}));var $k;(function(n){n.Create=1,n.Change=2,n.Delete=4})($k=w.WatchKind||(w.WatchKind={}));var jk;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(jk=w.PublishDiagnosticsNotification||(w.PublishDiagnosticsNotification={}));var Wk;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(Wk=w.CompletionTriggerKind||(w.CompletionTriggerKind={}));var Hk;(function(n){n.method="textDocument/completion",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Hk=w.CompletionRequest||(w.CompletionRequest={}));var Uk;(function(n){n.method="completionItem/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Uk=w.CompletionResolveRequest||(w.CompletionResolveRequest={}));var Kk;(function(n){n.method="textDocument/hover",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Kk=w.HoverRequest||(w.HoverRequest={}));var Vk;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(Vk=w.SignatureHelpTriggerKind||(w.SignatureHelpTriggerKind={}));var Bk;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Bk=w.SignatureHelpRequest||(w.SignatureHelpRequest={}));var Xk;(function(n){n.method="textDocument/definition",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Xk=w.DefinitionRequest||(w.DefinitionRequest={}));var zk;(function(n){n.method="textDocument/references",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(zk=w.ReferencesRequest||(w.ReferencesRequest={}));var Gk;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Gk=w.DocumentHighlightRequest||(w.DocumentHighlightRequest={}));var Qk;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Qk=w.DocumentSymbolRequest||(w.DocumentSymbolRequest={}));var Yk;(function(n){n.method="textDocument/codeAction",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Yk=w.CodeActionRequest||(w.CodeActionRequest={}));var Jk;(function(n){n.method="codeAction/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Jk=w.CodeActionResolveRequest||(w.CodeActionResolveRequest={}));var Zk;(function(n){n.method="workspace/symbol",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(Zk=w.WorkspaceSymbolRequest||(w.WorkspaceSymbolRequest={}));var eR;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(eR=w.WorkspaceSymbolResolveRequest||(w.WorkspaceSymbolResolveRequest={}));var tR;(function(n){n.method="textDocument/codeLens",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(tR=w.CodeLensRequest||(w.CodeLensRequest={}));var nR;(function(n){n.method="codeLens/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(nR=w.CodeLensResolveRequest||(w.CodeLensResolveRequest={}));var rR;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType0(n.method)})(rR=w.CodeLensRefreshRequest||(w.CodeLensRefreshRequest={}));var iR;(function(n){n.method="textDocument/documentLink",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(iR=w.DocumentLinkRequest||(w.DocumentLinkRequest={}));var sR;(function(n){n.method="documentLink/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(sR=w.DocumentLinkResolveRequest||(w.DocumentLinkResolveRequest={}));var oR;(function(n){n.method="textDocument/formatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(oR=w.DocumentFormattingRequest||(w.DocumentFormattingRequest={}));var aR;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(aR=w.DocumentRangeFormattingRequest||(w.DocumentRangeFormattingRequest={}));var cR;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(cR=w.DocumentOnTypeFormattingRequest||(w.DocumentOnTypeFormattingRequest={}));var uR;(function(n){n.Identifier=1})(uR=w.PrepareSupportDefaultBehavior||(w.PrepareSupportDefaultBehavior={}));var lR;(function(n){n.method="textDocument/rename",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(lR=w.RenameRequest||(w.RenameRequest={}));var dR;(function(n){n.method="textDocument/prepareRename",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(dR=w.PrepareRenameRequest||(w.PrepareRenameRequest={}));var fR;(function(n){n.method="workspace/executeCommand",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(fR=w.ExecuteCommandRequest||(w.ExecuteCommandRequest={}));var hR;(function(n){n.method="workspace/applyEdit",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType("workspace/applyEdit")})(hR=w.ApplyWorkspaceEditRequest||(w.ApplyWorkspaceEditRequest={}))});var lv=L(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.createProtocolConnection=void 0;var uv=Ri();function pR(n,e,t,r){return uv.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,uv.createMessageConnection)(n,e,t,r)}Ya.createProtocolConnection=pR});var dv=L(Xt=>{"use strict";var gR=Xt&&Xt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ja=Xt&&Xt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&gR(e,n,t)};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.LSPErrorCodes=Xt.createProtocolConnection=void 0;Ja(Ri(),Xt);Ja(Ka(),Xt);Ja(tt(),Xt);Ja(cv(),Xt);var mR=lv();Object.defineProperty(Xt,"createProtocolConnection",{enumerable:!0,get:function(){return mR.createProtocolConnection}});var vR;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(vR=Xt.LSPErrorCodes||(Xt.LSPErrorCodes={}))});var le=L(cr=>{"use strict";var yR=cr&&cr.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),fv=cr&&cr.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&yR(e,n,t)};Object.defineProperty(cr,"__esModule",{value:!0});cr.createProtocolConnection=void 0;var wR=kl();fv(kl(),cr);fv(dv(),cr);function bR(n,e,t,r){return(0,wR.createMessageConnection)(n,e,t,r)}cr.createProtocolConnection=bR});var ec=L(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.forEach=At.mapAsync=At.map=At.clearTestMode=At.setTestMode=At.Semaphore=At.Delayer=void 0;var Mo=le(),hv=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Mo.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};At.Delayer=hv;var pv=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Mo.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};At.Semaphore=pv;var Il=!1;function CR(){Il=!0}At.setTestMode=CR;function DR(){Il=!1}At.clearTestMode=DR;var gv=15,Za=class{constructor(e=gv){this.yieldAfter=Il===!0?Math.max(e,2):Math.max(e,gv),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function TR(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Za(r==null?void 0:r.yieldAfter);function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=e(n[u]),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Mo.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}At.map=TR;async function SR(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new Za(r==null?void 0:r.yieldAfter);async function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=await e(n[u],t),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Mo.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}At.mapAsync=SR;async function kR(n,e,t,r){if(n.length===0)return;let i=new Za(r==null?void 0:r.yieldAfter);function s(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),c+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,Mo.RAL)().timer.setImmediate(()=>{a(s(o))})})}At.forEach=kR});var Nl=L(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});var RR=require("vscode"),mv=class extends RR.CompletionItem{constructor(e){super(e)}};Ol.default=mv});var Ll=L(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});var PR=require("vscode"),vv=class extends PR.CodeLens{constructor(e){super(e)}};ql.default=vv});var Al=L(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});var _R=require("vscode"),yv=class extends _R.DocumentLink{constructor(e,t){super(e,t)}};Ml.default=yv});var jl=L($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});var ER=require("vscode"),wv=class extends ER.CodeAction{constructor(e,t){super(e);this.data=t}};$l.default=wv});var Hl=L(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.ProtocolDiagnostic=_i.DiagnosticCode=void 0;var xR=require("vscode"),Wl=_n(),FR;(function(n){function e(t){let r=t;return r!=null&&(Wl.number(r.value)||Wl.string(r.value))&&Wl.string(r.target)}n.is=e})(FR=_i.DiagnosticCode||(_i.DiagnosticCode={}));var bv=class extends xR.Diagnostic{constructor(e,t,r,i){super(e,t,r);this.data=i,this.hasDiagnosticCode=!1}};_i.ProtocolDiagnostic=bv});var Kl=L(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});var IR=require("vscode"),Cv=class extends IR.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};Ul.default=Cv});var Bl=L(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});var OR=require("vscode"),Dv=class extends OR.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};Vl.default=Dv});var zl=L(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});var tc=require("vscode"),Tv=class extends tc.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof tc.Uri);super(e,t,r,o?i:new tc.Location(i,new tc.Range(0,0,0,0)));this.hasRange=o,s!==void 0&&(this.data=s)}};Xl.default=Tv});var Ql=L(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});var NR=require("vscode"),Sv=class extends NR.InlayHint{constructor(e,t,r){super(e,t,r)}};Gl.default=Sv});var Pv=L(nc=>{"use strict";Object.defineProperty(nc,"__esModule",{value:!0});nc.createConverter=void 0;var vt=require("vscode"),pe=le(),ms=_n(),kv=ec(),qR=Nl(),LR=Ll(),MR=Al(),AR=jl(),Rv=Hl(),$R=Kl(),jR=Bl(),WR=zl(),HR=Ql(),Yl;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Yl||(Yl={}));function UR(n){let t=n||(g=>g.toString());function r(g){return t(g)}function i(g){return{uri:t(g.uri)}}function s(g){return{uri:t(g.uri),languageId:g.languageId,version:g.version,text:g.getText()}}function o(g){return{uri:t(g.uri),version:g.version}}function a(g){return{textDocument:s(g)}}function c(g){let M=g;return!!M.document&&!!M.contentChanges}function u(g){let M=g;return!!M.uri&&!!M.version}function l(g,M,X){if(u(g))return{textDocument:{uri:t(g.uri),version:g.version},contentChanges:[{text:g.getText()}]};if(c(g)){let he=M,I=X;return{textDocument:{uri:t(he),version:I},contentChanges:g.contentChanges.map(_=>{let E=_.range;return{range:{start:{line:E.start.line,character:E.start.character},end:{line:E.end.line,character:E.end.character}},rangeLength:_.rangeLength,text:_.text}})}}else throw Error("Unsupported text document change parameter")}function h(g){return{textDocument:i(g)}}function f(g,M=!1){let X={textDocument:i(g)};return M&&(X.text=g.getText()),X}function C(g){switch(g){case vt.TextDocumentSaveReason.Manual:return pe.TextDocumentSaveReason.Manual;case vt.TextDocumentSaveReason.AfterDelay:return pe.TextDocumentSaveReason.AfterDelay;case vt.TextDocumentSaveReason.FocusOut:return pe.TextDocumentSaveReason.FocusOut}return pe.TextDocumentSaveReason.Manual}function b(g){return{textDocument:i(g.document),reason:C(g.reason)}}function y(g){return{files:g.files.map(M=>({uri:t(M)}))}}function S(g){return{files:g.files.map(M=>({oldUri:t(M.oldUri),newUri:t(M.newUri)}))}}function k(g){return{files:g.files.map(M=>({uri:t(M)}))}}function v(g){return{files:g.files.map(M=>({uri:t(M)}))}}function D(g){return{files:g.files.map(M=>({oldUri:t(M.oldUri),newUri:t(M.newUri)}))}}function R(g){return{files:g.files.map(M=>({uri:t(M)}))}}function x(g,M){return{textDocument:i(g),position:lt(M)}}function F(g){switch(g){case vt.CompletionTriggerKind.TriggerCharacter:return pe.CompletionTriggerKind.TriggerCharacter;case vt.CompletionTriggerKind.TriggerForIncompleteCompletions:return pe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return pe.CompletionTriggerKind.Invoked}}function N(g,M,X){return{textDocument:i(g),position:lt(M),context:{triggerKind:F(X.triggerKind),triggerCharacter:X.triggerCharacter}}}function U(g){switch(g){case vt.SignatureHelpTriggerKind.Invoke:return pe.SignatureHelpTriggerKind.Invoked;case vt.SignatureHelpTriggerKind.TriggerCharacter:return pe.SignatureHelpTriggerKind.TriggerCharacter;case vt.SignatureHelpTriggerKind.ContentChange:return pe.SignatureHelpTriggerKind.ContentChange}}function J(g){return{label:g.label}}function te(g){return g.map(J)}function ie(g){return{label:g.label,parameters:te(g.parameters)}}function Ee(g){return g.map(ie)}function Dt(g){return g===void 0?g:{signatures:Ee(g.signatures),activeSignature:g.activeSignature,activeParameter:g.activeParameter}}function ut(g,M,X){return{textDocument:i(g),position:lt(M),context:{isRetrigger:X.isRetrigger,triggerCharacter:X.triggerCharacter,triggerKind:U(X.triggerKind),activeSignatureHelp:Dt(X.activeSignatureHelp)}}}function lt(g){return{line:g.line,character:g.character}}function ve(g){return g==null?g:{line:g.line>pe.uinteger.MAX_VALUE?pe.uinteger.MAX_VALUE:g.line,character:g.character>pe.uinteger.MAX_VALUE?pe.uinteger.MAX_VALUE:g.character}}function Ze(g,M){return kv.map(g,ve,M)}function Ge(g){return g==null?g:{start:ve(g.start),end:ve(g.end)}}function Wt(g){return g==null?g:pe.Location.create(r(g.uri),Ge(g.range))}function Zt(g){switch(g){case vt.DiagnosticSeverity.Error:return pe.DiagnosticSeverity.Error;case vt.DiagnosticSeverity.Warning:return pe.DiagnosticSeverity.Warning;case vt.DiagnosticSeverity.Information:return pe.DiagnosticSeverity.Information;case vt.DiagnosticSeverity.Hint:return pe.DiagnosticSeverity.Hint}}function tr(g){if(!g)return;let M=[];for(let X of g){let he=Ot(X);he!==void 0&&M.push(he)}return M.length>0?M:void 0}function Ot(g){switch(g){case vt.DiagnosticTag.Unnecessary:return pe.DiagnosticTag.Unnecessary;case vt.DiagnosticTag.Deprecated:return pe.DiagnosticTag.Deprecated;default:return}}function di(g){return{message:g.message,location:Wt(g.location)}}function $r(g){return g.map(di)}function hr(g){if(g!=null)return ms.number(g)||ms.string(g)?g:{value:g.value,target:r(g.target)}}function pr(g){let M=pe.Diagnostic.create(Ge(g.range),g.message),X=g instanceof Rv.ProtocolDiagnostic?g:void 0;X!==void 0&&X.data!==void 0&&(M.data=X.data);let he=hr(g.code);return Rv.DiagnosticCode.is(he)?X!==void 0&&X.hasDiagnosticCode?M.code=he:(M.code=he.value,M.codeDescription={href:he.target}):M.code=he,ms.number(g.severity)&&(M.severity=Zt(g.severity)),Array.isArray(g.tags)&&(M.tags=tr(g.tags)),g.relatedInformation&&(M.relatedInformation=$r(g.relatedInformation)),g.source&&(M.source=g.source),M}function gr(g,M){return g==null?g:kv.map(g,pr,M)}function fi(g,M){switch(g){case"$string":return M;case pe.MarkupKind.PlainText:return{kind:g,value:M};case pe.MarkupKind.Markdown:return{kind:g,value:M.value};default:return`Unsupported Markup content received. Kind is: ${g}`}}function jr(g){switch(g){case vt.CompletionItemTag.Deprecated:return pe.CompletionItemTag.Deprecated}}function Wr(g){if(g===void 0)return g;let M=[];for(let X of g){let he=jr(X);he!==void 0&&M.push(he)}return M}function mr(g,M){return M!==void 0?M:g+1}function wt(g,M=!1){let X,he;ms.string(g.label)?X=g.label:(X=g.label.label,M&&(g.label.detail!==void 0||g.label.description!==void 0)&&(he={detail:g.label.detail,description:g.label.description}));let I={label:X};he!==void 0&&(I.labelDetails=he);let m=g instanceof qR.default?g:void 0;g.detail&&(I.detail=g.detail),g.documentation&&(!m||m.documentationFormat==="$string"?I.documentation=g.documentation:I.documentation=fi(m.documentationFormat,g.documentation)),g.filterText&&(I.filterText=g.filterText),Hr(I,g),ms.number(g.kind)&&(I.kind=mr(g.kind,m&&m.originalItemKind)),g.sortText&&(I.sortText=g.sortText),g.additionalTextEdits&&(I.additionalTextEdits=Ur(g.additionalTextEdits)),g.commitCharacters&&(I.commitCharacters=g.commitCharacters.slice()),g.command&&(I.command=en(g.command)),(g.preselect===!0||g.preselect===!1)&&(I.preselect=g.preselect);let _=Wr(g.tags);if(m){if(m.data!==void 0&&(I.data=m.data),m.deprecated===!0||m.deprecated===!1){if(m.deprecated===!0&&_!==void 0&&_.length>0){let E=_.indexOf(vt.CompletionItemTag.Deprecated);E!==-1&&_.splice(E,1)}I.deprecated=m.deprecated}m.insertTextMode!==void 0&&(I.insertTextMode=m.insertTextMode)}return _!==void 0&&_.length>0&&(I.tags=_),I.insertTextMode===void 0&&g.keepWhitespace===!0&&(I.insertTextMode=pe.InsertTextMode.adjustIndentation),I}function Hr(g,M){let X=pe.InsertTextFormat.PlainText,he,I;M.textEdit?(he=M.textEdit.newText,I=M.textEdit.range):M.insertText instanceof vt.SnippetString?(X=pe.InsertTextFormat.Snippet,he=M.insertText.value):he=M.insertText,M.range&&(I=M.range),g.insertTextFormat=X,M.fromEdit&&he!==void 0&&I!==void 0?g.textEdit=nr(he,I):g.insertText=he}function nr(g,M){return Yl.is(M)?pe.InsertReplaceEdit.create(g,Ge(M.inserting),Ge(M.replacing)):{newText:g,range:Ge(M)}}function Tn(g){return{range:Ge(g.range),newText:g.newText}}function Ur(g){return g==null?g:g.map(Tn)}function Ht(g){return g<=vt.SymbolKind.TypeParameter?g+1:pe.SymbolKind.Property}function vr(g){return g}function dt(g){return g.map(vr)}function qn(g,M,X){return{textDocument:i(g),position:lt(M),context:{includeDeclaration:X.includeDeclaration}}}async function Ut(g,M){let X=pe.CodeAction.create(g.title);if(g instanceof AR.default&&g.data!==void 0&&(X.data=g.data),g.kind!==void 0&&(X.kind=wr(g.kind)),g.diagnostics!==void 0&&(X.diagnostics=await gr(g.diagnostics,M)),g.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return g.command!==void 0&&(X.command=en(g.command)),g.isPreferred!==void 0&&(X.isPreferred=g.isPreferred),g.disabled!==void 0&&(X.disabled={reason:g.disabled.reason}),X}async function yr(g,M){if(g==null)return g;let X;return g.only&&ms.string(g.only.value)&&(X=[g.only.value]),pe.CodeActionContext.create(await gr(g.diagnostics,M),X,hn(g.triggerKind))}function hn(g){switch(g){case vt.CodeActionTriggerKind.Invoke:return pe.CodeActionTriggerKind.Invoked;case vt.CodeActionTriggerKind.Automatic:return pe.CodeActionTriggerKind.Automatic;default:return}}function wr(g){if(g!=null)return g.value}function Kr(g){return g==null?g:pe.InlineValueContext.create(g.frameId,Ge(g.stoppedLocation))}function en(g){let M=pe.Command.create(g.title,g.command);return g.arguments&&(M.arguments=g.arguments),M}function Vr(g){let M=pe.CodeLens.create(Ge(g.range));return g.command&&(M.command=en(g.command)),g instanceof LR.default&&g.data&&(M.data=g.data),M}function pn(g,M){let X={tabSize:g.tabSize,insertSpaces:g.insertSpaces};return M.trimTrailingWhitespace&&(X.trimTrailingWhitespace=!0),M.trimFinalNewlines&&(X.trimFinalNewlines=!0),M.insertFinalNewline&&(X.insertFinalNewline=!0),X}function P(g){return{textDocument:i(g)}}function j(g){return{textDocument:i(g)}}function B(g){let M=pe.DocumentLink.create(Ge(g.range));g.target&&(M.target=r(g.target)),g.tooltip!==void 0&&(M.tooltip=g.tooltip);let X=g instanceof MR.default?g:void 0;return X&&X.data&&(M.data=X.data),M}function Y(g){return{textDocument:i(g)}}function xe(g){let M={name:g.name,kind:Ht(g.kind),uri:r(g.uri),range:Ge(g.range),selectionRange:Ge(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(M.detail=g.detail),g.tags!==void 0&&(M.tags=dt(g.tags)),g instanceof $R.default&&g.data!==void 0&&(M.data=g.data),M}function ke(g){let M={name:g.name,kind:Ht(g.kind),uri:r(g.uri),range:Ge(g.range),selectionRange:Ge(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(M.detail=g.detail),g.tags!==void 0&&(M.tags=dt(g.tags)),g instanceof jR.default&&g.data!==void 0&&(M.data=g.data),M}function Re(g){let M=g instanceof WR.default?{name:g.name,kind:Ht(g.kind),location:g.hasRange?Wt(g.location):{uri:t(g.location.uri)},data:g.data}:{name:g.name,kind:Ht(g.kind),location:Wt(g.location)};return g.tags!==void 0&&(M.tags=dt(g.tags)),g.containerName!==""&&(M.containerName=g.containerName),M}function We(g){let M=typeof g.label=="string"?g.label:g.label.map(fe),X=pe.InlayHint.create(ve(g.position),M);return g.kind!==void 0&&(X.kind=g.kind),g.textEdits!==void 0&&(X.textEdits=Ur(g.textEdits)),g.tooltip!==void 0&&(X.tooltip=Fe(g.tooltip)),g.paddingLeft!==void 0&&(X.paddingLeft=g.paddingLeft),g.paddingRight!==void 0&&(X.paddingRight=g.paddingRight),g instanceof HR.default&&g.data!==void 0&&(X.data=g.data),X}function fe(g){let M=pe.InlayHintLabelPart.create(g.value);return g.location!==void 0&&(M.location=Wt(g.location)),g.command!==void 0&&(M.command=en(g.command)),g.tooltip!==void 0&&(M.tooltip=Fe(g.tooltip)),M}function Fe(g){return typeof g=="string"?g:{kind:pe.MarkupKind.Markdown,value:g.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:l,asCloseTextDocumentParams:h,asSaveTextDocumentParams:f,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:y,asDidRenameFilesParams:S,asDidDeleteFilesParams:k,asWillCreateFilesParams:v,asWillRenameFilesParams:D,asWillDeleteFilesParams:R,asTextDocumentPositionParams:x,asCompletionParams:N,asSignatureHelpParams:ut,asWorkerPosition:lt,asRange:Ge,asPosition:ve,asPositions:Ze,asLocation:Wt,asDiagnosticSeverity:Zt,asDiagnosticTag:Ot,asDiagnostic:pr,asDiagnostics:gr,asCompletionItem:wt,asTextEdit:Tn,asSymbolKind:Ht,asSymbolTag:vr,asSymbolTags:dt,asReferenceParams:qn,asCodeAction:Ut,asCodeActionContext:yr,asInlineValueContext:Kr,asCommand:en,asCodeLens:Vr,asFormattingOptions:pn,asDocumentSymbolParams:P,asCodeLensParams:j,asDocumentLink:B,asDocumentLinkParams:Y,asCallHierarchyItem:xe,asTypeHierarchyItem:ke,asInlayHint:We,asWorkspaceSymbol:Re}}nc.createConverter=UR});var xv=L(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0});ic.createConverter=void 0;var G=require("vscode"),ae=le(),xn=_n(),Ne=ec(),KR=Nl(),VR=Ll(),BR=Al(),XR=jl(),_v=Hl(),zR=Kl(),GR=Bl(),QR=zl(),YR=Ql(),Ev=le(),rc;(function(n){function e(t){let r=t;return r&&xn.string(r.language)&&xn.string(r.value)}n.is=e})(rc||(rc={}));function JR(n,e,t){let i=n||(d=>G.Uri.parse(d));function s(d){return i(d)}function o(d){let O=[];for(let H of d)if(typeof H=="string")O.push(H);else if(Ev.NotebookCellTextDocumentFilter.is(H))if(typeof H.notebook=="string")O.push({notebookType:H.notebook,language:H.language});else{let se=H.notebook.notebookType??"*";O.push({notebookType:se,scheme:H.notebook.scheme,pattern:H.notebook.pattern,language:H.language})}else Ev.TextDocumentFilter.is(H)&&O.push({language:H.language,scheme:H.scheme,pattern:H.pattern});return O}async function a(d,O){return Ne.map(d,u,O)}function c(d){let O=new Array(d.length);for(let H=0;H<d.length;H++)O[H]=u(d[H]);return O}function u(d){let O=new _v.ProtocolDiagnostic(b(d.range),d.message,S(d.severity),d.data);if(d.code!==void 0){if(typeof d.code=="string"||typeof d.code=="number")ae.CodeDescription.is(d.codeDescription)?O.code={value:d.code,target:s(d.codeDescription.href)}:O.code=d.code;else if(_v.DiagnosticCode.is(d.code)){O.hasDiagnosticCode=!0;let H=d.code;O.code={value:H.value,target:s(H.target)}}}return d.source&&(O.source=d.source),d.relatedInformation&&(O.relatedInformation=l(d.relatedInformation)),Array.isArray(d.tags)&&(O.tags=h(d.tags)),O}function l(d){let O=new Array(d.length);for(let H=0;H<d.length;H++){let se=d[H];O[H]=new G.DiagnosticRelatedInformation(Ot(se.location),se.message)}return O}function h(d){if(!d)return;let O=[];for(let H of d){let se=f(H);se!==void 0&&O.push(se)}return O.length>0?O:void 0}function f(d){switch(d){case ae.DiagnosticTag.Unnecessary:return G.DiagnosticTag.Unnecessary;case ae.DiagnosticTag.Deprecated:return G.DiagnosticTag.Deprecated;default:return}}function C(d){return d?new G.Position(d.line,d.character):void 0}function b(d){return d?new G.Range(d.start.line,d.start.character,d.end.line,d.end.character):void 0}async function y(d,O){return Ne.map(d,H=>new G.Range(H.start.line,H.start.character,H.end.line,H.end.character),O)}function S(d){if(d==null)return G.DiagnosticSeverity.Error;switch(d){case ae.DiagnosticSeverity.Error:return G.DiagnosticSeverity.Error;case ae.DiagnosticSeverity.Warning:return G.DiagnosticSeverity.Warning;case ae.DiagnosticSeverity.Information:return G.DiagnosticSeverity.Information;case ae.DiagnosticSeverity.Hint:return G.DiagnosticSeverity.Hint}return G.DiagnosticSeverity.Error}function k(d){if(xn.string(d))return D(d);if(rc.is(d))return D().appendCodeblock(d.value,d.language);if(Array.isArray(d)){let O=[];for(let H of d){let se=D();rc.is(H)?se.appendCodeblock(H.value,H.language):se.appendMarkdown(H),O.push(se)}return O}else return D(d)}function v(d){if(xn.string(d))return d;switch(d.kind){case ae.MarkupKind.Markdown:return D(d.value);case ae.MarkupKind.PlainText:return d.value;default:return`Unsupported Markup content received. Kind is: ${d.kind}`}}function D(d){let O;if(d===void 0||typeof d=="string")O=new G.MarkdownString(d);else switch(d.kind){case ae.MarkupKind.Markdown:O=new G.MarkdownString(d.value);break;case ae.MarkupKind.PlainText:O=new G.MarkdownString,O.appendText(d.value);break;default:O=new G.MarkdownString,O.appendText(`Unsupported Markup content received. Kind is: ${d.kind}`);break}return O.isTrusted=e,O.supportHtml=t,O}function R(d){if(!!d)return new G.Hover(k(d.contents),b(d.range))}async function x(d,O,H){if(!d)return;if(Array.isArray(d))return Ne.map(d,rr=>te(rr,O),H);let se=d,{defaultRange:Pt,commitCharacters:pt}=F(se,O),Ae=await Ne.map(se.items,rr=>{var Le,hi,qs;return te(rr,pt,Pt,(Le=se.itemDefaults)==null?void 0:Le.insertTextMode,(hi=se.itemDefaults)==null?void 0:hi.insertTextFormat,(qs=se.itemDefaults)==null?void 0:qs.data)},H);return new G.CompletionList(Ae,se.isIncomplete)}function F(d,O){var Pt,pt;let H=(Pt=d.itemDefaults)==null?void 0:Pt.editRange,se=((pt=d.itemDefaults)==null?void 0:pt.commitCharacters)??O;return ae.Range.is(H)?{defaultRange:b(H),commitCharacters:se}:H!==void 0?{defaultRange:{inserting:b(H.insert),replacing:b(H.replace)},commitCharacters:se}:{defaultRange:void 0,commitCharacters:se}}function N(d){return ae.CompletionItemKind.Text<=d&&d<=ae.CompletionItemKind.TypeParameter?[d-1,void 0]:[G.CompletionItemKind.Text,d]}function U(d){switch(d){case ae.CompletionItemTag.Deprecated:return G.CompletionItemTag.Deprecated}}function J(d){if(d==null)return[];let O=[];for(let H of d){let se=U(H);se!==void 0&&O.push(se)}return O}function te(d,O,H,se,Pt,pt){let Ae=J(d.tags),rr=ie(d),Le=new KR.default(rr);d.detail&&(Le.detail=d.detail),d.documentation&&(Le.documentation=v(d.documentation),Le.documentationFormat=xn.string(d.documentation)?"$string":d.documentation.kind),d.filterText&&(Le.filterText=d.filterText);let hi=Ee(d,H,Pt);if(hi&&(Le.insertText=hi.text,Le.range=hi.range,Le.fromEdit=hi.fromEdit),xn.number(d.kind)){let[BC,Rf]=N(d.kind);Le.kind=BC,Rf&&(Le.originalItemKind=Rf)}d.sortText&&(Le.sortText=d.sortText),d.additionalTextEdits&&(Le.additionalTextEdits=ve(d.additionalTextEdits));let qs=d.commitCharacters!==void 0?xn.stringArray(d.commitCharacters)?d.commitCharacters:void 0:O;qs&&(Le.commitCharacters=qs.slice()),d.command&&(Le.command=dt(d.command)),(d.deprecated===!0||d.deprecated===!1)&&(Le.deprecated=d.deprecated,d.deprecated===!0&&Ae.push(G.CompletionItemTag.Deprecated)),(d.preselect===!0||d.preselect===!1)&&(Le.preselect=d.preselect);let kf=d.data??pt;kf!==void 0&&(Le.data=kf),Ae.length>0&&(Le.tags=Ae);let uu=d.insertTextMode??se;return uu!==void 0&&(Le.insertTextMode=uu,uu===ae.InsertTextMode.asIs&&(Le.keepWhitespace=!0)),Le}function ie(d){return ae.CompletionItemLabelDetails.is(d.labelDetails)?{label:d.label,detail:d.labelDetails.detail,description:d.labelDetails.description}:d.label}function Ee(d,O,H){let se=d.insertTextFormat??H;if(d.textEdit!==void 0||O!==void 0){let[Pt,pt]=d.textEdit!==void 0?Dt(d.textEdit):[O,d.textEditText??d.label];return se===ae.InsertTextFormat.Snippet?{text:new G.SnippetString(pt),range:Pt,fromEdit:!0}:{text:pt,range:Pt,fromEdit:!0}}else return d.insertText?se===ae.InsertTextFormat.Snippet?{text:new G.SnippetString(d.insertText),fromEdit:!1}:{text:d.insertText,fromEdit:!1}:void 0}function Dt(d){return ae.InsertReplaceEdit.is(d)?[{inserting:b(d.insert),replacing:b(d.replace)},d.newText]:[b(d.range),d.newText]}function ut(d){if(!!d)return new G.TextEdit(b(d.range),d.newText)}async function lt(d,O){if(!!d)return Ne.map(d,ut,O)}function ve(d){if(!d)return;let O=new Array(d.length);for(let H=0;H<d.length;H++)O[H]=ut(d[H]);return O}async function Ze(d,O){if(!d)return;let H=new G.SignatureHelp;return xn.number(d.activeSignature)?H.activeSignature=d.activeSignature:H.activeSignature=0,xn.number(d.activeParameter)?H.activeParameter=d.activeParameter:H.activeParameter=0,d.signatures&&(H.signatures=await Ge(d.signatures,O)),H}async function Ge(d,O){return Ne.mapAsync(d,Wt,O)}async function Wt(d,O){let H=new G.SignatureInformation(d.label);return d.documentation!==void 0&&(H.documentation=v(d.documentation)),d.parameters!==void 0&&(H.parameters=await Zt(d.parameters,O)),d.activeParameter!==void 0&&(H.activeParameter=d.activeParameter),H}function Zt(d,O){return Ne.map(d,tr,O)}function tr(d){let O=new G.ParameterInformation(d.label);return d.documentation&&(O.documentation=v(d.documentation)),O}function Ot(d){return d?new G.Location(i(d.uri),b(d.range)):void 0}async function di(d,O){if(!!d)return pr(d,O)}async function $r(d,O){if(!!d)return pr(d,O)}function hr(d){if(!d)return;let O={targetUri:i(d.targetUri),targetRange:b(d.targetRange),originSelectionRange:b(d.originSelectionRange),targetSelectionRange:b(d.targetSelectionRange)};if(!O.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return O}async function pr(d,O){if(!!d)if(xn.array(d)){if(d.length===0)return[];if(ae.LocationLink.is(d[0])){let H=d;return Ne.map(H,hr,O)}else{let H=d;return Ne.map(H,Ot,O)}}else return ae.LocationLink.is(d)?[hr(d)]:Ot(d)}async function gr(d,O){if(!!d)return Ne.map(d,Ot,O)}async function fi(d,O){if(!!d)return Ne.map(d,jr,O)}function jr(d){let O=new G.DocumentHighlight(b(d.range));return xn.number(d.kind)&&(O.kind=Wr(d.kind)),O}function Wr(d){switch(d){case ae.DocumentHighlightKind.Text:return G.DocumentHighlightKind.Text;case ae.DocumentHighlightKind.Read:return G.DocumentHighlightKind.Read;case ae.DocumentHighlightKind.Write:return G.DocumentHighlightKind.Write}return G.DocumentHighlightKind.Text}async function mr(d,O){if(!!d)return Ne.map(d,Tn,O)}function wt(d){return d<=ae.SymbolKind.TypeParameter?d-1:G.SymbolKind.Property}function Hr(d){switch(d){case ae.SymbolTag.Deprecated:return G.SymbolTag.Deprecated;default:return}}function nr(d){if(d==null)return;let O=[];for(let H of d){let se=Hr(H);se!==void 0&&O.push(se)}return O.length===0?void 0:O}function Tn(d){let O=d.data,H=d.location,se=H.range===void 0||O!==void 0?new QR.default(d.name,wt(d.kind),d.containerName??"",H.range===void 0?i(H.uri):new G.Location(i(d.location.uri),b(H.range)),O):new G.SymbolInformation(d.name,wt(d.kind),d.containerName??"",new G.Location(i(d.location.uri),b(H.range)));return vr(se,d),se}async function Ur(d,O){if(d!=null)return Ne.map(d,Ht,O)}function Ht(d){let O=new G.DocumentSymbol(d.name,d.detail||"",wt(d.kind),b(d.range),b(d.selectionRange));if(vr(O,d),d.children!==void 0&&d.children.length>0){let H=[];for(let se of d.children)H.push(Ht(se));O.children=H}return O}function vr(d,O){d.tags=nr(O.tags),O.deprecated&&(d.tags?d.tags.includes(G.SymbolTag.Deprecated)||(d.tags=d.tags.concat(G.SymbolTag.Deprecated)):d.tags=[G.SymbolTag.Deprecated])}function dt(d){let O={title:d.title,command:d.command};return d.arguments&&(O.arguments=d.arguments),O}async function qn(d,O){if(!!d)return Ne.map(d,dt,O)}let Ut=new Map;Ut.set(ae.CodeActionKind.Empty,G.CodeActionKind.Empty),Ut.set(ae.CodeActionKind.QuickFix,G.CodeActionKind.QuickFix),Ut.set(ae.CodeActionKind.Refactor,G.CodeActionKind.Refactor),Ut.set(ae.CodeActionKind.RefactorExtract,G.CodeActionKind.RefactorExtract),Ut.set(ae.CodeActionKind.RefactorInline,G.CodeActionKind.RefactorInline),Ut.set(ae.CodeActionKind.RefactorRewrite,G.CodeActionKind.RefactorRewrite),Ut.set(ae.CodeActionKind.Source,G.CodeActionKind.Source),Ut.set(ae.CodeActionKind.SourceOrganizeImports,G.CodeActionKind.SourceOrganizeImports);function yr(d){if(d==null)return;let O=Ut.get(d);if(O)return O;let H=d.split(".");O=G.CodeActionKind.Empty;for(let se of H)O=O.append(se);return O}function hn(d){if(d!=null)return d.map(O=>yr(O))}async function wr(d,O){if(d==null)return;let H=new XR.default(d.title,d.data);return d.kind!==void 0&&(H.kind=yr(d.kind)),d.diagnostics!==void 0&&(H.diagnostics=c(d.diagnostics)),d.edit!==void 0&&(H.edit=await pn(d.edit,O)),d.command!==void 0&&(H.command=dt(d.command)),d.isPreferred!==void 0&&(H.isPreferred=d.isPreferred),d.disabled!==void 0&&(H.disabled={reason:d.disabled.reason}),H}function Kr(d,O){return Ne.mapAsync(d,async H=>ae.Command.is(H)?dt(H):wr(H,O),O)}function en(d){if(!d)return;let O=new VR.default(b(d.range));return d.command&&(O.command=dt(d.command)),d.data!==void 0&&d.data!==null&&(O.data=d.data),O}async function Vr(d,O){if(!!d)return Ne.map(d,en,O)}async function pn(d,O){if(!d)return;let H=new Map;if(d.changeAnnotations!==void 0){let pt=d.changeAnnotations;await Ne.forEach(Object.keys(pt),Ae=>{let rr=P(pt[Ae]);H.set(Ae,rr)},O)}let se=pt=>{if(pt!==void 0)return H.get(pt)},Pt=new G.WorkspaceEdit;if(d.documentChanges){let pt=d.documentChanges;await Ne.forEach(pt,Ae=>{if(ae.CreateFile.is(Ae))Pt.createFile(i(Ae.uri),Ae.options,se(Ae.annotationId));else if(ae.RenameFile.is(Ae))Pt.renameFile(i(Ae.oldUri),i(Ae.newUri),Ae.options,se(Ae.annotationId));else if(ae.DeleteFile.is(Ae))Pt.deleteFile(i(Ae.uri),Ae.options,se(Ae.annotationId));else if(ae.TextDocumentEdit.is(Ae)){let rr=i(Ae.textDocument.uri);for(let Le of Ae.edits)ae.AnnotatedTextEdit.is(Le)?Pt.replace(rr,b(Le.range),Le.newText,se(Le.annotationId)):Pt.replace(rr,b(Le.range),Le.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Ae,void 0,4)}`)},O)}else if(d.changes){let pt=d.changes;await Ne.forEach(Object.keys(pt),Ae=>{Pt.set(i(Ae),ve(pt[Ae]))},O)}return Pt}function P(d){if(d!==void 0)return{label:d.label,needsConfirmation:!!d.needsConfirmation,description:d.description}}function j(d){let O=b(d.range),H=d.target?s(d.target):void 0,se=new BR.default(O,H);return d.tooltip!==void 0&&(se.tooltip=d.tooltip),d.data!==void 0&&d.data!==null&&(se.data=d.data),se}async function B(d,O){if(!!d)return Ne.map(d,j,O)}function Y(d){return new G.Color(d.red,d.green,d.blue,d.alpha)}function xe(d){return new G.ColorInformation(b(d.range),Y(d.color))}async function ke(d,O){if(!!d)return Ne.map(d,xe,O)}function Re(d){let O=new G.ColorPresentation(d.label);return O.additionalTextEdits=ve(d.additionalTextEdits),d.textEdit&&(O.textEdit=ut(d.textEdit)),O}async function We(d,O){if(!!d)return Ne.map(d,Re,O)}function fe(d){if(d)switch(d){case ae.FoldingRangeKind.Comment:return G.FoldingRangeKind.Comment;case ae.FoldingRangeKind.Imports:return G.FoldingRangeKind.Imports;case ae.FoldingRangeKind.Region:return G.FoldingRangeKind.Region}}function Fe(d){return new G.FoldingRange(d.startLine,d.endLine,fe(d.kind))}async function g(d,O){if(!!d)return Ne.map(d,Fe,O)}function M(d){return new G.SelectionRange(b(d.range),d.parent?M(d.parent):void 0)}async function X(d,O){return Array.isArray(d)?Ne.map(d,M,O):[]}function he(d){return ae.InlineValueText.is(d)?new G.InlineValueText(b(d.range),d.text):ae.InlineValueVariableLookup.is(d)?new G.InlineValueVariableLookup(b(d.range),d.variableName,d.caseSensitiveLookup):new G.InlineValueEvaluatableExpression(b(d.range),d.expression)}async function I(d,O){return Array.isArray(d)?Ne.map(d,he,O):[]}async function m(d,O){let H=typeof d.label=="string"?d.label:await Ne.map(d.label,_,O),se=new YR.default(C(d.position),H);return d.kind!==void 0&&(se.kind=d.kind),d.textEdits!==void 0&&(se.textEdits=await lt(d.textEdits,O)),d.tooltip!==void 0&&(se.tooltip=E(d.tooltip)),d.paddingLeft!==void 0&&(se.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(se.paddingRight=d.paddingRight),d.data!==void 0&&(se.data=d.data),se}function _(d){let O=new G.InlayHintLabelPart(d.value);return d.location!==void 0&&(O.location=Ot(d.location)),d.tooltip!==void 0&&(O.tooltip=E(d.tooltip)),d.command!==void 0&&(O.command=dt(d.command)),O}function E(d){return typeof d=="string"?d:D(d)}async function T(d,O){if(!!Array.isArray(d))return Ne.mapAsync(d,m,O)}function p(d){if(d===null)return;let O=new zR.default(wt(d.kind),d.name,d.detail||"",s(d.uri),b(d.range),b(d.selectionRange),d.data);return d.tags!==void 0&&(O.tags=nr(d.tags)),O}async function q(d,O){if(d!==null)return Ne.map(d,p,O)}async function W(d,O){return new G.CallHierarchyIncomingCall(p(d.from),await y(d.fromRanges,O))}async function ue(d,O){if(d!==null)return Ne.mapAsync(d,W,O)}async function Ve(d,O){return new G.CallHierarchyOutgoingCall(p(d.to),await y(d.fromRanges,O))}async function je(d,O){if(d!==null)return Ne.mapAsync(d,Ve,O)}async function gn(d,O){if(d!=null)return new G.SemanticTokens(new Uint32Array(d.data),d.resultId)}function tn(d){return new G.SemanticTokensEdit(d.start,d.deleteCount,d.data!==void 0?new Uint32Array(d.data):void 0)}async function Ln(d,O){if(d!=null)return new G.SemanticTokensEdits(d.edits.map(tn),d.resultId)}function Ce(d){return d}async function Br(d,O){if(d!=null)return new G.LinkedEditingRanges(await y(d.ranges,O),Wi(d.wordPattern))}function Wi(d){if(d!=null)return new RegExp(d)}function Ns(d){if(d===null)return;let O=new GR.default(wt(d.kind),d.name,d.detail||"",s(d.uri),b(d.range),b(d.selectionRange),d.data);return d.tags!==void 0&&(O.tags=nr(d.tags)),O}async function KC(d,O){if(d!==null)return Ne.map(d,Ns,O)}function VC(d){if(xn.string(d))return d;if(ae.RelativePattern.is(d)){if(ae.URI.is(d.baseUri))return new G.RelativePattern(s(d.baseUri),d.pattern);if(ae.WorkspaceFolder.is(d.baseUri)){let O=G.workspace.getWorkspaceFolder(s(d.baseUri.uri));return O!==void 0?new G.RelativePattern(O,d.pattern):void 0}}}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:u,asRange:b,asRanges:y,asPosition:C,asDiagnosticSeverity:S,asDiagnosticTag:f,asHover:R,asCompletionResult:x,asCompletionItem:te,asTextEdit:ut,asTextEdits:lt,asSignatureHelp:Ze,asSignatureInformations:Ge,asSignatureInformation:Wt,asParameterInformations:Zt,asParameterInformation:tr,asDeclarationResult:di,asDefinitionResult:$r,asLocation:Ot,asReferences:gr,asDocumentHighlights:fi,asDocumentHighlight:jr,asDocumentHighlightKind:Wr,asSymbolKind:wt,asSymbolTag:Hr,asSymbolTags:nr,asSymbolInformations:mr,asSymbolInformation:Tn,asDocumentSymbols:Ur,asDocumentSymbol:Ht,asCommand:dt,asCommands:qn,asCodeAction:wr,asCodeActionKind:yr,asCodeActionKinds:hn,asCodeActionResult:Kr,asCodeLens:en,asCodeLenses:Vr,asWorkspaceEdit:pn,asDocumentLink:j,asDocumentLinks:B,asFoldingRangeKind:fe,asFoldingRange:Fe,asFoldingRanges:g,asColor:Y,asColorInformation:xe,asColorInformations:ke,asColorPresentation:Re,asColorPresentations:We,asSelectionRange:M,asSelectionRanges:X,asInlineValue:he,asInlineValues:I,asInlayHint:m,asInlayHints:T,asSemanticTokensLegend:Ce,asSemanticTokens:gn,asSemanticTokensEdit:tn,asSemanticTokensEdits:Ln,asCallHierarchyItem:p,asCallHierarchyItems:q,asCallHierarchyIncomingCall:W,asCallHierarchyIncomingCalls:ue,asCallHierarchyOutgoingCall:Ve,asCallHierarchyOutgoingCalls:je,asLinkedEditingRanges:Br,asTypeHierarchyItem:Ns,asTypeHierarchyItems:KC,asGlobPattern:VC}}ic.createConverter=JR});var rt=L(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.generateUuid=Fn.parse=Fn.isUUID=Fn.v4=Fn.empty=void 0;var sc=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},ye=class extends sc{constructor(){super([ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),"-",ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),"-","4",ye._randomHex(),ye._randomHex(),ye._randomHex(),"-",ye._oneOf(ye._timeHighBits),ye._randomHex(),ye._randomHex(),ye._randomHex(),"-",ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex(),ye._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ye._oneOf(ye._chars)}};ye._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ye._timeHighBits=["8","9","a","b"];Fn.empty=new sc("00000000-0000-0000-0000-000000000000");function Fv(){return new ye}Fn.v4=Fv;var ZR=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Iv(n){return ZR.test(n)}Fn.isUUID=Iv;function eP(n){if(!Iv(n))throw new Error("invalid uuid");return new sc(n)}Fn.parse=eP;function tP(){return Fv().asHex()}Fn.generateUuid=tP});var Jl=L(oc=>{"use strict";Object.defineProperty(oc,"__esModule",{value:!0});oc.ProgressPart=void 0;var Ov=require("vscode"),Nv=le(),qv=_n(),Lv=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Nv.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Ov.window.withProgress({location:Ov.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Nv.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&qv.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(qv.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};oc.ProgressPart=Lv});var _e=L(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.WorkspaceFeature=yt.TextDocumentLanguageFeature=yt.TextDocumentEventFeature=yt.DynamicDocumentFeature=yt.DynamicFeature=yt.StaticFeature=yt.ensure=yt.LSPCancellationError=void 0;var Ei=require("vscode"),Zl=le(),zt=_n(),Mv=rt(),Av=class extends Ei.CancellationError{constructor(e){super();this.data=e}};yt.LSPCancellationError=Av;function nP(n,e){return n[e]===void 0&&(n[e]={}),n[e]}yt.ensure=nP;var rP;(function(n){function e(t){let r=t;return r!=null&&zt.func(r.fillClientCapabilities)&&zt.func(r.initialize)&&zt.func(r.getState)&&zt.func(r.dispose)&&(r.fillInitializeParams===void 0||zt.func(r.fillInitializeParams))}n.is=e})(rP=yt.StaticFeature||(yt.StaticFeature={}));var iP;(function(n){function e(t){let r=t;return r!=null&&zt.func(r.fillClientCapabilities)&&zt.func(r.initialize)&&zt.func(r.getState)&&zt.func(r.dispose)&&(r.fillInitializeParams===void 0||zt.func(r.fillInitializeParams))&&zt.func(r.register)&&zt.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(iP=yt.DynamicFeature||(yt.DynamicFeature={}));var ac=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of Ei.workspace.textDocuments)if(Ei.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};yt.DynamicDocumentFeature=ac;var $v=class extends ac{constructor(e,t,r,i,s,o,a){super(e);this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Ei.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(Ei.languages.match(r,t)>0)return!0;return!1}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Ei.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};yt.TextDocumentEventFeature=$v;var jv=class extends ac{constructor(e,t){super(e);this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Zl.TextDocumentRegistrationOptions.is(t)){let r=Zl.StaticRegistrationOptions.hasId(t)?t.id:Mv.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(zt.boolean(t)&&t===!0||Zl.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Mv.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Ei.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};yt.TextDocumentLanguageFeature=jv;var Wv=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};yt.WorkspaceFeature=Wv});var Uv=L((e0,Hv)=>{var sP=typeof process=="object"&&process&&process.platform==="win32";Hv.exports=sP?{sep:"\\"}:{sep:"/"}});var zv=L((t0,Xv)=>{"use strict";Xv.exports=Kv;function Kv(n,e,t){n instanceof RegExp&&(n=Vv(n,t)),e instanceof RegExp&&(e=Vv(e,t));var r=Bv(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Vv(n,e){var t=e.match(n);return t?t[0]:null}Kv.range=Bv;function Bv(n,e,t){var r,i,s,o,a,c=t.indexOf(n),u=t.indexOf(e,c+1),l=c;if(c>=0&&u>0){if(n===e)return[c,u];for(r=[],s=t.length;l>=0&&!a;)l==c?(r.push(l),c=t.indexOf(n,l+1)):r.length==1?a=[r.pop(),u]:(i=r.pop(),i<s&&(s=i,o=u),u=t.indexOf(e,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[s,o])}return a}});var ny=L((n0,ty)=>{var Gv=zv();ty.exports=cP;var Qv="\0SLASH"+Math.random()+"\0",Yv="\0OPEN"+Math.random()+"\0",ed="\0CLOSE"+Math.random()+"\0",Jv="\0COMMA"+Math.random()+"\0",Zv="\0PERIOD"+Math.random()+"\0";function td(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function oP(n){return n.split("\\\\").join(Qv).split("\\{").join(Yv).split("\\}").join(ed).split("\\,").join(Jv).split("\\.").join(Zv)}function aP(n){return n.split(Qv).join("\\").split(Yv).join("{").split(ed).join("}").split(Jv).join(",").split(Zv).join(".")}function ey(n){if(!n)return[""];var e=[],t=Gv("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=ey(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function cP(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),Ao(oP(n),!0).map(aP)):[]}function uP(n){return"{"+n+"}"}function lP(n){return/^-?0\d/.test(n)}function dP(n,e){return n<=e}function fP(n,e){return n>=e}function Ao(n,e){var t=[],r=Gv("{","}",n);if(!r)return[n];var i=r.pre,s=r.post.length?Ao(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<s.length;o++){var a=i+"{"+r.body+"}"+s[o];t.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),l=c||u,h=r.body.indexOf(",")>=0;if(!l&&!h)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+ed+r.post,Ao(n)):[n];var f;if(l)f=r.body.split(/\.\./);else if(f=ey(r.body),f.length===1&&(f=Ao(f[0],!1).map(uP),f.length===1))return s.map(function(te){return r.pre+f[0]+te});var C;if(l){var b=td(f[0]),y=td(f[1]),S=Math.max(f[0].length,f[1].length),k=f.length==3?Math.abs(td(f[2])):1,v=dP,D=y<b;D&&(k*=-1,v=fP);var R=f.some(lP);C=[];for(var x=b;v(x,y);x+=k){var F;if(u)F=String.fromCharCode(x),F==="\\"&&(F="");else if(F=String(x),R){var N=S-F.length;if(N>0){var U=new Array(N+1).join("0");x<0?F="-"+U+F.slice(1):F=U+F}}C.push(F)}}else{C=[];for(var J=0;J<f.length;J++)C.push.apply(C,Ao(f[J],!1))}for(var J=0;J<C.length;J++)for(var o=0;o<s.length;o++){var a=i+C[J]+s[o];(!e||l||a)&&t.push(a)}}return t}});var uc=L((i0,od)=>{var yn=od.exports=(n,e,t={})=>(cc(e),!t.nocomment&&e.charAt(0)==="#"?!1:new $o(e,t).match(n));od.exports=yn;var nd=Uv();yn.sep=nd.sep;var Gn=Symbol("globstar **");yn.GLOBSTAR=Gn;var hP=ny(),ry={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},rd="[^/]",id=rd+"*?",pP="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",gP="(?:(?!(?:\\/|^)\\.).)*?",iy=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),sy=iy("().*{}+?[]^$\\!"),mP=iy("[.("),oy=/\/+/;yn.filter=(n,e={})=>(t,r,i)=>yn(t,n,e);var ri=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};yn.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return yn;let e=yn,t=(r,i,s)=>e(r,i,ri(n,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,ri(n,s))}},t.Minimatch.defaults=r=>e.defaults(ri(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,ri(n,i)),t.defaults=r=>e.defaults(ri(n,r)),t.makeRe=(r,i)=>e.makeRe(r,ri(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,ri(n,i)),t.match=(r,i,s)=>e.match(r,i,ri(n,s)),t};yn.braceExpand=(n,e)=>ay(n,e);var ay=(n,e={})=>(cc(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:hP(n)),vP=1024*64,cc=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>vP)throw new TypeError("pattern is too long")},sd=Symbol("subparse");yn.makeRe=(n,e)=>new $o(n,e||{}).makeRe();yn.match=(n,e,t={})=>{let r=new $o(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var yP=n=>n.replace(/\\(.)/g,"$1"),wP=n=>n.replace(/\\([^-\]])/g,"$1"),bP=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),CP=n=>n.replace(/[[\]\\]/g,"\\$&"),$o=class{constructor(e,t){cc(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(oy)),this.debug(this.pattern,r),r=r.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,c=t.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var u=t[o],l=e[s];if(this.debug(t,u,l),u===!1)return!1;if(u===Gn){this.debug("GLOBSTAR",[t,u,l]);var h=s,f=o+1;if(f===c){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;h<a;){var C=e[h];if(this.debug(`
globstar while`,e,h,t,f,C),this.matchOne(e.slice(h),t.slice(f),r))return this.debug("globstar found match!",h,a,C),!0;if(C==="."||C===".."||!i.dot&&C.charAt(0)==="."){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,h,t,f),h===a))}var b;if(typeof u=="string"?(b=l===u,this.debug("string match",u,l,b)):(b=l.match(u),this.debug("pattern match",u,l,b)),!b)return!1}if(s===a&&o===c)return!0;if(s===a)return r;if(o===c)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return ay(this.pattern,this.options)}parse(e,t){cc(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Gn;if(e==="")return"";let i="",s=!!r.nocase,o=!1,a=[],c=[],u,l=!1,h=-1,f=-1,C,b,y,S=e.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",k=()=>{if(u){switch(u){case"*":i+=id,s=!0;break;case"?":i+=rd,s=!0;break;default:i+="\\"+u;break}this.debug("clearStateChar %j %j",u,i),u=!1}};for(let R=0,x;R<e.length&&(x=e.charAt(R));R++){if(this.debug("%s	%s %s %j",e,R,i,x),o){if(x==="/")return!1;sy[x]&&(i+="\\"),i+=x,o=!1;continue}switch(x){case"/":return!1;case"\\":if(l&&e.charAt(R+1)==="-"){i+=x;continue}k(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,R,i,x),l){this.debug("  in class"),x==="!"&&R===f+1&&(x="^"),i+=x;continue}this.debug("call clearStateChar %j",u),k(),u=x,r.noext&&k();continue;case"(":if(l){i+="(";continue}if(!u){i+="\\(";continue}a.push({type:u,start:R-1,reStart:i.length,open:ry[u].open,close:ry[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(l||!a.length){i+="\\)";continue}k(),s=!0,b=a.pop(),i+=b.close,b.type==="!"&&c.push(b),b.reEnd=i.length;continue;case"|":if(l||!a.length){i+="\\|";continue}k(),i+="|";continue;case"[":if(k(),l){i+="\\"+x;continue}l=!0,f=R,h=i.length,i+=x;continue;case"]":if(R===f+1||!l){i+="\\"+x;continue}C=e.substring(f+1,R);try{RegExp("["+CP(wP(C))+"]"),i+=x}catch{i=i.substring(0,h)+"(?:$.)"}s=!0,l=!1;continue;default:k(),sy[x]&&!(x==="^"&&l)&&(i+="\\"),i+=x;break}}for(l&&(C=e.slice(f+1),y=this.parse(C,sd),i=i.substring(0,h)+"\\["+y[0],s=s||y[1]),b=a.pop();b;b=a.pop()){let R;R=i.slice(b.reStart+b.open.length),this.debug("setting tail",i,b),R=R.replace(/((?:\\{2}){0,64})(\\?)\|/g,(F,N,U)=>(U||(U="\\"),N+N+U+"|")),this.debug(`tail=%j
   %s`,R,R,b,i);let x=b.type==="*"?id:b.type==="?"?rd:"\\"+b.type;s=!0,i=i.slice(0,b.reStart)+x+"\\("+R}k(),o&&(i+="\\\\");let v=mP[i.charAt(0)];for(let R=c.length-1;R>-1;R--){let x=c[R],F=i.slice(0,x.reStart),N=i.slice(x.reStart,x.reEnd-8),U=i.slice(x.reEnd),J=i.slice(x.reEnd-8,x.reEnd)+U,te=F.split("(").length-1,ie=U;for(let Dt=0;Dt<te;Dt++)ie=ie.replace(/\)[+*?]?/,"");U=ie;let Ee=U===""&&t!==sd?"$":"";i=F+N+U+Ee+J}if(i!==""&&s&&(i="(?=.)"+i),v&&(i=S+i),t===sd)return[i,s];if(!s)return yP(e);let D=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",D),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?id:t.dot?pP:gP,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?bP(a):a===Gn?Gn:a._src).reduce((a,c)=>(a[a.length-1]===Gn&&c===Gn||a.push(c),a),[]),o.forEach((a,c)=>{a!==Gn||o[c-1]===Gn||(c===0?o.length>1?o[c+1]="(?:\\/|"+r+"\\/)?"+o[c+1]:o[c]=r:c===o.length-1?o[c-1]+="(?:\\/|"+r+")?":(o[c-1]+="(?:\\/|\\/"+r+"\\/)"+o[c+1],o[c+1]=Gn))}),o.filter(a=>a!==Gn).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;nd.sep!=="/"&&(e=e.split(nd.sep).join("/")),e=e.split(oy),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],c=e;if(r.matchBase&&a.length===1&&(c=[s]),this.matchOne(c,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return yn.defaults(e).Minimatch}};yn.Minimatch=$o});var ud=L(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.DiagnosticFeature=ur.DiagnosticPullMode=ur.vsdiag=void 0;var DP=uc(),Se=require("vscode"),at=le(),TP=rt(),ad=_e();function lc(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Qn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Qn=ur.vsdiag||(ur.vsdiag={}));var cd;(function(n){n.onType="onType",n.onSave="onSave"})(cd=ur.DiagnosticPullMode||(ur.DiagnosticPullMode={}));var $t;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})($t||($t={}));var vs=class{constructor(){this.open=new Set,this._onOpen=new Se.EventEmitter,this._onClose=new Se.EventEmitter,vs.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;vs.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of r.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let c of s)a.add(Se.Uri.parse(c));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let c of o)a.add(Se.Uri.parse(c));this._onOpen.fire(a)}};Se.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=Se.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){var t,r;return e instanceof Se.Uri?((t=Se.window.activeTextEditor)==null?void 0:t.document.uri)===e:((r=Se.window.activeTextEditor)==null?void 0:r.document)===e}isVisible(e){let t=e instanceof Se.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return vs.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of Se.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof Se.TabInputText?a=o.uri:o instanceof Se.TabInputTextDiff&&(a=o.modified),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},bt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(bt||(bt={}));var Er;(function(n){function e(t){return t instanceof Se.Uri?t.toString():t.uri.toString()}n.asKey=e})(Er||(Er={}));var cy=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===bt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof Se.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],c=i.get(s);return c===void 0&&(c={document:o,pulledVersion:a,resultId:void 0},i.set(s,c)),c}update(e,t,r,i){let s=e===bt.document?this.documentPullStates:this.workspacePullStates,[o,a,c,u]=t instanceof Se.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],l=s.get(o);l===void 0?(l={document:a,pulledVersion:c,resultId:u},s.set(o,l)):(l.pulledVersion=c,l.resultId=u)}unTrack(e,t){let r=Er.asKey(t);(e===bt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=Er.asKey(t);return(e===bt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var s;let r=Er.asKey(t);return(s=(e===bt.document?this.documentPullStates:this.workspacePullStates).get(r))==null?void 0:s.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},uy=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new Se.EventEmitter,this.provider=this.createProvider(),this.diagnostics=Se.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new cy,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof Se.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof Se.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof Se.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(bt.document,e,t):this.documentStates.track(bt.document,e);if(o===void 0){let c=new Se.CancellationTokenSource;this.openRequests.set(s,{state:$t.active,document:e,version:t,tokenSource:c});let u,l;try{u=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:Qn.DocumentDiagnosticReportKind.full,items:[]}}catch(h){if(h instanceof ad.LSPCancellationError&&at.DiagnosticServerCancellationData.is(h.data)&&h.data.retriggerRequest===!1&&(l={state:$t.outDated,document:e}),l===void 0&&h instanceof Se.CancellationError)l={state:$t.reschedule,document:e};else throw h}if(l=l??this.openRequests.get(s),l===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(bt.document,e);return}if(l.state===$t.outDated)return;u!==void 0&&(u.kind===Qn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,u.items),a.pulledVersion=t,a.resultId=u.resultId),l.state===$t.reschedule&&this.pull(e)}else o.state===$t.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:$t.reschedule,document:o.document})):o.state===$t.outDated&&this.openRequests.set(s,{state:$t.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof Se.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:$t.reschedule,document:e}):this.pull(e,()=>{this.forget(bt.document,e)}):(i!==void 0&&(i.state===$t.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:$t.outDated,document:e})),this.diagnostics.delete(t),this.forget(bt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,at.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof ad.LSPCancellationError)&&!at.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,at.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new Se.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Qn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(bt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(bt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,c,u)=>{let l={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof Se.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:Qn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(at.DocumentDiagnosticRequest.type,l,u).then(async h=>h==null||this.isDisposed||u.isCancellationRequested?{kind:Qn.DocumentDiagnosticReportKind.full,items:[]}:h.kind===at.DocumentDiagnosticReportKind.Full?{kind:Qn.DocumentDiagnosticReportKind.full,resultId:h.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(h.items,u)}:{kind:Qn.DocumentDiagnosticReportKind.unChanged,resultId:h.resultId},h=>this.client.handleFailedRequest(at.DocumentDiagnosticRequest.type,u,h,{kind:Qn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async u=>u.kind===at.DocumentDiagnosticReportKind.Full?{kind:Qn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version,items:await this.client.protocol2CodeConverter.asDiagnostics(u.items,r)}:{kind:Qn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version},o=u=>{let l=[];for(let h of u)l.push({uri:this.client.code2ProtocolConverter.asUri(h.uri),value:h.value});return l},a=(u,l)=>{let h=(0,TP.generateUuid)(),f=this.client.onProgress(at.WorkspaceDiagnosticRequest.partialResult,h,async b=>{if(b==null){i(null);return}let y={items:[]};for(let S of b.items)try{y.items.push(await s(S))}catch(k){this.client.error("Converting workspace diagnostics failed.",k)}i(y)}),C={identifier:this.options.identifier,previousResultIds:o(u),partialResultToken:h};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(at.WorkspaceDiagnosticRequest.type,C,l).then(async b=>{if(l.isCancellationRequested)return{items:[]};let y={items:[]};for(let S of b.items)y.items.push(await s(S));return f.dispose(),i(y),{items:[]}},b=>(f.dispose(),this.client.handleFailedRequest(at.DocumentDiagnosticRequest.type,l,b,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===$t.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:$t.outDated,document:i.document});this.diagnostics.dispose()}},ly=class{constructor(e){this.diagnosticRequestor=e,this.documents=new at.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=Er.asKey(e);this.documents.has(t)||(this.documents.set(t,e,at.Touch.Last),this.trigger())}remove(e){let t=Er.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,at.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=Er.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,at.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?Er.asKey(this.endDocument):void 0}},dy=class{constructor(e,t,r){var b;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=y=>{let S=r.documentSelector;if(i.match!==void 0)return i.match(S,y);for(let k of S)if(!!at.TextDocumentFilter.is(k)){if(typeof k=="string"||k.language!==void 0&&k.language!=="*"||k.scheme!==void 0&&k.scheme!=="*"&&k.scheme!==y.scheme)return!1;if(k.pattern!==void 0){let v=new DP.Minimatch(k.pattern,{noext:!0});if(!v.makeRe()||!v.match(y.fsPath))return!1}}return!0},c=y=>y instanceof Se.Uri?a(y):Se.languages.match(s,y)>0&&t.isVisible(y),u=y=>{var S;return y instanceof Se.Uri?((S=this.activeTextDocument)==null?void 0:S.uri.toString())===y.toString():this.activeTextDocument===y};this.diagnosticRequestor=new uy(e,t,r),this.backgroundScheduler=new ly(this.diagnosticRequestor);let l=y=>{!c(y)||!r.interFileDependencies||u(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=(b=Se.window.activeTextEditor)==null?void 0:b.document,Se.window.onDidChangeActiveTextEditor(y=>{let S=this.activeTextDocument;this.activeTextDocument=y==null?void 0:y.document,S!==void 0&&l(S),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let h=e.getFeature(at.DidOpenTextDocumentNotification.method);o.push(h.onNotificationSent(y=>{let S=y.textDocument;this.diagnosticRequestor.knows(bt.document,S)||c(S)&&this.diagnosticRequestor.pull(S,()=>{l(S)})})),t.onOpen(y=>{for(let S of y){if(this.diagnosticRequestor.knows(bt.document,S))continue;let k=S.toString(),v;for(let D of Se.workspace.textDocuments)if(k===D.uri.toString()){v=D;break}v!==void 0&&c(v)?this.diagnosticRequestor.pull(v,()=>{l(v)}):c(S)&&this.diagnosticRequestor.pull(S,()=>{l(S)})}});let f=new Set;for(let y of Se.workspace.textDocuments)c(y)&&(this.diagnosticRequestor.pull(y,()=>{l(y)}),f.add(y.uri.toString()));if(i.onTabs===!0)for(let y of t.getTabResources())!f.has(y.toString())&&c(y)&&this.diagnosticRequestor.pull(y,()=>{l(y)});if(i.onChange===!0){let y=e.getFeature(at.DidChangeTextDocumentNotification.method);o.push(y.onNotificationSent(async S=>{let k=S.textDocument;(i.filter===void 0||!i.filter(k,cd.onType))&&this.diagnosticRequestor.knows(bt.document,k)&&this.diagnosticRequestor.pull(k,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let y=e.getFeature(at.DidSaveTextDocumentNotification.method);o.push(y.onNotificationSent(S=>{let k=S.textDocument;(i.filter===void 0||!i.filter(k,cd.onSave))&&this.diagnosticRequestor.knows(bt.document,k)&&this.diagnosticRequestor.pull(S.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let C=e.getFeature(at.DidCloseTextDocumentNotification.method);o.push(C.onNotificationSent(y=>{this.cleanUpDocument(y.textDocument)})),t.onClose(y=>{for(let S of y)this.cleanUpDocument(S)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let y of Se.workspace.textDocuments)c(y)&&this.diagnosticRequestor.pull(y)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=Se.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(bt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},fy=class extends ad.TextDocumentLanguageFeature{constructor(e){super(e,at.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=lc(lc(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,lc(lc(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(at.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}dispose(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.dispose()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new vs);let t=new dy(this._client,this.tabs,e);return[t.disposable,t]}};ur.DiagnosticFeature=fy});var gy=L(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.NotebookDocumentSyncFeature=void 0;var jt=require("vscode"),SP=uc(),xr=le(),kP=rt(),hy=_n();function py(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ys;(function(n){let e;(function(t){function r(f,C){return{version:f.version,uri:C.asUri(f.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(f,C,b){let y=xr.NotebookDocument.create(b.asUri(f.uri),f.notebookType,f.version,s(C,b));return Object.keys(f.metadata).length>0&&(y.metadata=o(f.metadata)),y}t.asNotebookDocument=i;function s(f,C){return f.map(b=>a(b,C))}t.asNotebookCells=s;function o(f){return u(new Set,f)}t.asMetadata=o;function a(f,C){let b=xr.NotebookCell.create(c(f.kind),C.asUri(f.document.uri));return Object.keys(f.metadata).length>0&&(b.metadata=o(f.metadata)),f.executionSummary!==void 0&&hy.number(f.executionSummary.executionOrder)&&hy.boolean(f.executionSummary.success)&&(b.executionSummary={executionOrder:f.executionSummary.executionOrder,success:f.executionSummary.success}),b}t.asNotebookCell=a;function c(f){switch(f){case jt.NotebookCellKind.Markup:return xr.NotebookCellKind.Markup;case jt.NotebookCellKind.Code:return xr.NotebookCellKind.Code}}function u(f,C){if(f.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let b=[];for(let y of C)if(y!==null&&typeof y=="object"||Array.isArray(y))b.push(u(f,y));else{if(y instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b.push(y)}return b}else{let b=Object.keys(C),y=Object.create(null);for(let S of b){let k=C[S];if(k!==null&&typeof k=="object"||Array.isArray(k))y[S]=u(f,k);else{if(k instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y[S]=k}}return y}}function l(f,C){let b=C.asChangeTextDocumentParams(f,f.document.uri,f.document.version);return{document:b.textDocument,changes:b.contentChanges}}t.asTextContentChange=l;function h(f,C){let b=Object.create(null);if(f.metadata&&(b.metadata=n.c2p.asMetadata(f.metadata)),f.cells!==void 0){let y=Object.create(null),S=f.cells;S.structure&&(y.structure={array:{start:S.structure.array.start,deleteCount:S.structure.array.deleteCount,cells:S.structure.array.cells!==void 0?S.structure.array.cells.map(k=>n.c2p.asNotebookCell(k,C)):void 0},didOpen:S.structure.didOpen!==void 0?S.structure.didOpen.map(k=>C.asOpenTextDocumentParams(k.document).textDocument):void 0,didClose:S.structure.didClose!==void 0?S.structure.didClose.map(k=>C.asCloseTextDocumentParams(k.document).textDocument):void 0}),S.data!==void 0&&(y.data=S.data.map(k=>n.c2p.asNotebookCell(k,C))),S.textContent!==void 0&&(y.textContent=S.textContent.map(k=>n.c2p.asTextContentChange(k,C))),Object.keys(y).length>0&&(b.cells=y)}return b}t.asNotebookDocumentChangeEvent=h})(e=n.c2p||(n.c2p={}))})(ys||(ys={}));var ld;(function(n){function e(a,c,u){let l=a.length,h=c.length,f=0;for(;f<h&&f<l&&t(a[f],c[f],u);)f++;if(f<h&&f<l){let C=l-1,b=h-1;for(;C>=0&&b>=0&&t(a[C],c[b],u);)C--,b--;let y=C+1-f,S=f===b+1?void 0:c.slice(f,b+1);return S!==void 0?{start:f,deleteCount:y,cells:S}:{start:f,deleteCount:y}}else return f<h?{start:f,deleteCount:0,cells:c.slice(f)}:f<l?{start:f,deleteCount:l-f}:void 0}n.computeDiff=e;function t(a,c,u=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!u||u&&s(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let u=Array.isArray(a),l=Array.isArray(c);if(u!==l)return!1;if(u&&l){if(a.length!==c.length)return!1;for(let h=0;h<a.length;h++)if(!s(a[h],c[h]))return!1}if(o(a)&&o(c)){let h=Object.keys(a),f=Object.keys(c);if(h.length!==f.length||(h.sort(),f.sort(),!s(h,f)))return!1;for(let C=0;C<h.length;C++){let b=h[C];if(!s(a[b],c[b]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(ld||(ld={}));var dd;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new SP.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(dd||(dd={}));var dc;(function(n){function e(r){var o,a,c;let i=r.notebookSelector,s=[];for(let u of i){let l=(typeof u.notebook=="string"?u.notebook:(o=u.notebook)==null?void 0:o.notebookType)??"*",h=typeof u.notebook=="string"||(a=u.notebook)==null?void 0:a.scheme,f=typeof u.notebook=="string"||(c=u.notebook)==null?void 0:c.pattern;if(u.cells!==void 0)for(let C of u.cells)s.push(t(l,h,f,C.language));else s.push(t(l,h,f,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(dc||(dc={}));var fc;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(fc||(fc={}));var jo=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(dc.asDocumentSelector(t)),jt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of jt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);jt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&jt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),jt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of jt.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return jt.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(jt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){jt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var s;let r=async(o,a)=>{let c=ys.c2p.asNotebookDocument(o,a,this.client.code2ProtocolConverter),u=a.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(xr.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),fc.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var s,o;let r=async a=>{try{await this.client.sendNotification(xr.DidChangeNotebookDocumentNotification.type,{notebookDocument:ys.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:ys.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return((o=e.cells)==null?void 0:o.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),fc.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async s=>{try{await this.client.sendNotification(xr.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=(i=this.client.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var s;let r=async(o,a)=>{try{await this.client.sendNotification(xr.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(s.metadata=ys.c2p.asMetadata(t.metadata));let o;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)o.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,u=ld.computeDiff(a,c,!1),l,h;if(u!==void 0){l=u.cells===void 0?new Map:new Map(u.cells.map(b=>[b.document.uri.toString(),b])),h=u.deleteCount===0?new Map:new Map(a.slice(u.start,u.start+u.deleteCount).map(b=>[b.document.uri.toString(),b]));for(let b of Array.from(h.keys()))l.has(b)&&(h.delete(b),l.delete(b));s.cells=s.cells??{};let f=[],C=[];if(l.size>0||h.size>0){for(let b of l.values())f.push(b);for(let b of h.values())C.push(b)}s.cells.structure={array:u,didOpen:f,didClose:C}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||dd.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var s;let i=r!==void 0?t.filter(o=>{let a=o.document.languageId;return r.some(c=>c.language==="*"||a===c.language)}):t;return typeof((s=this.client.clientOptions.notebookDocumentOptions)==null?void 0:s.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},ii=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=xr.NotebookDocumentSyncRegistrationType.type,jt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==ii.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof jo&&s.didOpenNotebookCellTextDocument(r,i)}),jt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==ii.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof jo&&s.didChangeNotebookCellTextDocument(i,t)}),jt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==ii.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof jo&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=py(py(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(dc.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??kP.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new jo(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==ii.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&jt.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of jt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};hc.NotebookDocumentSyncFeature=ii;ii.CellScheme="vscode-notebook-cell"});var wy=L(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.SyncConfigurationFeature=si.toJSONObject=si.ConfigurationFeature=void 0;var ws=require("vscode"),Wo=le(),RP=_n(),PP=rt(),my=_e(),vy=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Wo.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let c of o.items){let u=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(u,c.section!==null?c.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=xi(ws.workspace.getConfiguration(void 0,e).get(t));else{let s=ws.workspace.getConfiguration(t.substr(0,i),e);s&&(r=xi(s.get(t.substr(i+1))))}}else{let i=ws.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=xi(i.get(s)))}return r===void 0&&(r=null),r}dispose(){}};si.ConfigurationFeature=vy;function xi(n){if(n){if(Array.isArray(n))return n.map(xi);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=xi(n[t]));return e}}return n}si.toJSONObject=xi;var yy=class{constructor(e){this._client=e,this.isDisposed=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Wo.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,my.ensure)((0,my.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){var t;let e=(t=this._client.clientOptions.synchronize)==null?void 0:t.configurationSection;e!==void 0&&this.register({id:PP.generateUuid(),registerOptions:{section:e}})}register(e){let t=ws.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isDisposed=!0}onDidChangeConfiguration(e,t){var o;if(this.isDisposed)return;let r;if(RP.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(c=>t.affectsConfiguration(c)))return;let i=async a=>a===void 0?this._client.sendNotification(Wo.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Wo.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(a)}),s=(o=this._client.middleware.workspace)==null?void 0:o.didChangeConfiguration;(s?s(r,i):i(r)).catch(a=>{this._client.error(`Sending notification ${Wo.DidChangeConfigurationNotification.type.method} failed`,a)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let u=a[o[c]];u||(u=Object.create(null),a[o[c]]=u),a=u}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=ws.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):c=ws.workspace.getConfiguration(void 0,r).get(o),c){let u=e[s].split(".");t(i,u)[u[u.length-1]]=xi(c)}}return i}};si.SyncConfigurationFeature=yy});var Ry=L(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.DidSaveTextDocumentFeature=ln.WillSaveWaitUntilFeature=ln.WillSaveFeature=ln.DidChangeTextDocumentFeature=ln.DidCloseTextDocumentFeature=ln.DidOpenTextDocumentFeature=void 0;var wn=require("vscode"),Ue=le(),it=_e(),bs=rt(),by=class extends it.TextDocumentEventFeature{constructor(e,t){super(e,wn.workspace.onDidOpenTextDocument,Ue.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,it.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:bs.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Ue.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);wn.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&wn.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};ln.DidOpenTextDocumentFeature=by;var Cy=class extends it.TextDocumentEventFeature{constructor(e,t,r){super(e,wn.workspace.onDidCloseTextDocument,Ue.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,it.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Ue.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:bs.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(wn.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};ln.DidCloseTextDocumentFeature=Cy;var Dy=class extends it.DynamicDocumentFeature{constructor(e,t){super(e);this._changeData=new Map,this._onNotificationSent=new wn.EventEmitter,this._onPendingChangeAdded=new wn.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Ue.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Ue.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Ue.TextDocumentSyncKind.None&&this.register({id:bs.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=wn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let s of this._changeData.values())if(wn.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===Ue.TextDocumentSyncKind.Incremental){let a=async c=>{let u=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,t,r);await this._client.sendNotification(Ue.DidChangeTextDocumentNotification.type,u),this.notificationSent(c.document,Ue.DidChangeTextDocumentNotification.type,u)};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}else if(s.syncKind===Ue.TextDocumentSyncKind.Full){let a=async c=>{let u=c.document.uri.toString();this._pendingTextDocumentChanges.set(u,c.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${Ue.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Ue.TextDocumentSyncKind.None;else{this._syncKind=Ue.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Ue.TextDocumentSyncKind.Full)break}}dispose(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Ue.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(wn.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Ue.TextDocumentSyncKind.Full)switch(e){case Ue.TextDocumentSyncKind.Full:this._syncKind=e;break;case Ue.TextDocumentSyncKind.Incremental:this._syncKind===Ue.TextDocumentSyncKind.None&&(this._syncKind=Ue.TextDocumentSyncKind.Incremental);break}}};ln.DidChangeTextDocumentFeature=Dy;var Ty=class extends it.TextDocumentEventFeature{constructor(e){super(e,wn.workspace.onWillSaveTextDocument,Ue.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>it.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Ue.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:bs.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};ln.WillSaveFeature=Ty;var Sy=class extends it.DynamicDocumentFeature{constructor(e){super(e);this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Ue.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:bs.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=wn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(it.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Ue.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};ln.WillSaveWaitUntilFeature=Sy;var ky=class extends it.TextDocumentEventFeature{constructor(e){super(e,wn.workspace.onDidSaveTextDocument,Ue.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,it.TextDocumentEventFeature.textDocumentFilter);this._includeText=!1}get registrationType(){return Ue.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,it.ensure)((0,it.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:bs.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};ln.DidSaveTextDocumentFeature=ky});var _y=L(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});pc.CompletionItemFeature=void 0;var _P=require("vscode"),De=le(),fd=_e(),EP=rt(),xP=[De.CompletionItemKind.Text,De.CompletionItemKind.Method,De.CompletionItemKind.Function,De.CompletionItemKind.Constructor,De.CompletionItemKind.Field,De.CompletionItemKind.Variable,De.CompletionItemKind.Class,De.CompletionItemKind.Interface,De.CompletionItemKind.Module,De.CompletionItemKind.Property,De.CompletionItemKind.Unit,De.CompletionItemKind.Value,De.CompletionItemKind.Enum,De.CompletionItemKind.Keyword,De.CompletionItemKind.Snippet,De.CompletionItemKind.Color,De.CompletionItemKind.File,De.CompletionItemKind.Reference,De.CompletionItemKind.Folder,De.CompletionItemKind.EnumMember,De.CompletionItemKind.Constant,De.CompletionItemKind.Struct,De.CompletionItemKind.Event,De.CompletionItemKind.Operator,De.CompletionItemKind.TypeParameter],Py=class extends fd.TextDocumentLanguageFeature{constructor(e){super(e,De.CompletionRequest.type);this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,fd.ensure)((0,fd.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[De.MarkupKind.Markdown,De.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[De.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[De.InsertTextMode.asIs,De.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=De.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:xP},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:EP.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)==null?void 0:a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(c,u,l,h)=>{let f=this._client,C=this._client.middleware,b=(y,S,k,v)=>f.sendRequest(De.CompletionRequest.type,f.code2ProtocolConverter.asCompletionParams(y,S,k),v).then(D=>v.isCancellationRequested?null:f.protocol2CodeConverter.asCompletionResult(D,i,v),D=>f.handleFailedRequest(De.CompletionRequest.type,v,D,null));return C.provideCompletionItem?C.provideCompletionItem(c,u,h,l,b):b(c,u,h,l)},resolveCompletionItem:e.resolveProvider?(c,u)=>{let l=this._client,h=this._client.middleware,f=(C,b)=>l.sendRequest(De.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),b).then(y=>b.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(y),y=>l.handleFailedRequest(De.CompletionResolveRequest.type,b,y,C));return h.resolveCompletionItem?h.resolveCompletionItem(c,u,f):f(c,u)}:void 0};return[_P.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};pc.CompletionItemFeature=Py});var xy=L(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.HoverFeature=void 0;var FP=require("vscode"),Ho=le(),hd=_e(),IP=rt(),Ey=class extends hd.TextDocumentLanguageFeature{constructor(e){super(e,Ho.HoverRequest.type)}fillClientCapabilities(e){let t=(0,hd.ensure)((0,hd.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Ho.MarkupKind.Markdown,Ho.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:IP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Ho.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(Ho.HoverRequest.type,f,C,null)),u=a.middleware;return u.provideHover?u.provideHover(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return FP.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};gc.HoverFeature=Ey});var Iy=L(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.DefinitionFeature=void 0;var OP=require("vscode"),pd=le(),gd=_e(),NP=rt(),Fy=class extends gd.TextDocumentLanguageFeature{constructor(e){super(e,pd.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,gd.ensure)((0,gd.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:NP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(pd.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(pd.DefinitionRequest.type,f,C,null)),u=a.middleware;return u.provideDefinition?u.provideDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return OP.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};mc.DefinitionFeature=Fy});var qy=L(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.SignatureHelpFeature=void 0;var Oy=require("vscode"),Uo=le(),md=_e(),qP=rt(),Ny=class extends md.TextDocumentLanguageFeature{constructor(e){super(e,Uo.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,md.ensure)((0,md.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Uo.MarkupKind.Markdown,Uo.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:qP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,c=(l,h,f,C)=>a.sendRequest(Uo.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(l,h,f),C).then(b=>C.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(b,C),b=>a.handleFailedRequest(Uo.SignatureHelpRequest.type,C,b,null)),u=a.middleware;return u.provideSignatureHelp?u.provideSignatureHelp(r,i,o,s,c):c(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return Oy.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return Oy.languages.registerSignatureHelpProvider(r,t,i)}}};vc.SignatureHelpFeature=Ny});var My=L(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.DocumentHighlightFeature=void 0;var LP=require("vscode"),vd=le(),yd=_e(),MP=rt(),Ly=class extends yd.TextDocumentLanguageFeature{constructor(e){super(e,vd.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,yd.ensure)((0,yd.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:MP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(vd.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,f),C=>a.handleFailedRequest(vd.DocumentHighlightRequest.type,f,C,null)),u=a.middleware;return u.provideDocumentHighlights?u.provideDocumentHighlights(i,s,o,c):c(i,s,o)}};return[LP.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};yc.DocumentHighlightFeature=Ly});var bd=L(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.DocumentSymbolFeature=lr.SupportedSymbolTags=lr.SupportedSymbolKinds=void 0;var AP=require("vscode"),qe=le(),wd=_e(),$P=rt();lr.SupportedSymbolKinds=[qe.SymbolKind.File,qe.SymbolKind.Module,qe.SymbolKind.Namespace,qe.SymbolKind.Package,qe.SymbolKind.Class,qe.SymbolKind.Method,qe.SymbolKind.Property,qe.SymbolKind.Field,qe.SymbolKind.Constructor,qe.SymbolKind.Enum,qe.SymbolKind.Interface,qe.SymbolKind.Function,qe.SymbolKind.Variable,qe.SymbolKind.Constant,qe.SymbolKind.String,qe.SymbolKind.Number,qe.SymbolKind.Boolean,qe.SymbolKind.Array,qe.SymbolKind.Object,qe.SymbolKind.Key,qe.SymbolKind.Null,qe.SymbolKind.EnumMember,qe.SymbolKind.Struct,qe.SymbolKind.Event,qe.SymbolKind.Operator,qe.SymbolKind.TypeParameter];lr.SupportedSymbolTags=[qe.SymbolTag.Deprecated];var Ay=class extends wd.TextDocumentLanguageFeature{constructor(e){super(e,qe.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,wd.ensure)((0,wd.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:lr.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:lr.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:$P.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,c=async(l,h)=>{try{let f=await a.sendRequest(qe.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(l),h);if(h.isCancellationRequested||f===void 0||f===null)return null;if(f.length===0)return[];{let C=f[0];return qe.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(f,h):await a.protocol2CodeConverter.asSymbolInformations(f,h)}}catch(f){return a.handleFailedRequest(qe.DocumentSymbolRequest.type,h,f,null)}},u=a.middleware;return u.provideDocumentSymbols?u.provideDocumentSymbols(s,o,c):c(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[AP.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};lr.DocumentSymbolFeature=Ay});var Wy=L(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.WorkspaceSymbolFeature=void 0;var jP=require("vscode"),Ko=le(),Cd=_e(),$y=bd(),WP=rt(),jy=class extends Cd.WorkspaceFeature{constructor(e){super(e,Ko.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Cd.ensure)((0,Cd.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:$y.SupportedSymbolKinds},t.tagSupport={valueSet:$y.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:WP.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(Ko.WorkspaceSymbolRequest.type,{query:c},u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(l,u),l=>s.handleFailedRequest(Ko.WorkspaceSymbolRequest.type,u,l,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest(Ko.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(c),u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(l),l=>s.handleFailedRequest(Ko.WorkspaceSymbolResolveRequest.type,u,l,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[jP.languages.registerWorkspaceSymbolProvider(t),t]}};wc.WorkspaceSymbolFeature=jy});var Uy=L(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.ReferencesFeature=void 0;var HP=require("vscode"),Dd=le(),Td=_e(),UP=rt(),Hy=class extends Td.TextDocumentLanguageFeature{constructor(e){super(e,Dd.ReferencesRequest.type)}fillClientCapabilities(e){(0,Td.ensure)((0,Td.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:UP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>c.sendRequest(Dd.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(h,f,C),b).then(y=>b.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(y,b),y=>c.handleFailedRequest(Dd.ReferencesRequest.type,b,y,null)),l=c.middleware;return l.provideReferences?l.provideReferences(i,s,o,a,u):u(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return HP.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};bc.ReferencesFeature=Hy});var Vy=L(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.CodeActionFeature=void 0;var KP=require("vscode"),bn=le(),VP=rt(),Sd=_e(),Ky=class extends Sd.TextDocumentLanguageFeature{constructor(e){super(e,bn.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Sd.ensure)((0,Sd.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[bn.CodeActionKind.Empty,bn.CodeActionKind.QuickFix,bn.CodeActionKind.Refactor,bn.CodeActionKind.RefactorExtract,bn.CodeActionKind.RefactorInline,bn.CodeActionKind.RefactorRewrite,bn.CodeActionKind.Source,bn.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:VP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let c=this._client,u=async(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f),context:await c.code2ProtocolConverter.asCodeActionContext(C,b)};return c.sendRequest(bn.CodeActionRequest.type,y,b).then(S=>b.isCancellationRequested||S===null||S===void 0?null:c.protocol2CodeConverter.asCodeActionResult(S,b),S=>c.handleFailedRequest(bn.CodeActionRequest.type,b,S,null))},l=c.middleware;return l.provideCodeActions?l.provideCodeActions(i,s,o,a,u):u(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,c=async(u,l)=>o.sendRequest(bn.CodeActionResolveRequest.type,await o.code2ProtocolConverter.asCodeAction(u,l),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asCodeAction(h,l),h=>o.handleFailedRequest(bn.CodeActionResolveRequest.type,l,h,u));return a.resolveCodeAction?a.resolveCodeAction(i,s,c):c(i,s)}:void 0};return[KP.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};Cc.CodeActionFeature=Ky});var zy=L(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.CodeLensFeature=void 0;var By=require("vscode"),Cs=le(),BP=rt(),Vo=_e(),Xy=class extends Vo.TextDocumentLanguageFeature{constructor(e){super(e,Cs.CodeLensRequest.type)}fillClientCapabilities(e){(0,Vo.ensure)((0,Vo.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Vo.ensure)((0,Vo.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Cs.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:BP.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new By.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(Cs.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(l),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(f,h),f=>a.handleFailedRequest(Cs.CodeLensRequest.type,h,f,null)),u=a.middleware;return u.provideCodeLenses?u.provideCodeLenses(s,o,c):c(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(Cs.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(l),h).then(f=>h.isCancellationRequested?l:a.protocol2CodeConverter.asCodeLens(f),f=>a.handleFailedRequest(Cs.CodeLensResolveRequest.type,h,f,l)),u=a.middleware;return u.resolveCodeLens?u.resolveCodeLens(s,o,c):c(s,o)}:void 0};return[By.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};Dc.CodeLensFeature=Xy});var Jy=L(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.DocumentOnTypeFormattingFeature=oi.DocumentRangeFormattingFeature=oi.DocumentFormattingFeature=void 0;var Tc=require("vscode"),Fr=le(),kd=rt(),Ir=_e(),Bo;(function(n){function e(t){let r=Tc.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Bo||(Bo={}));var Gy=class extends Ir.TextDocumentLanguageFeature{constructor(e){super(e,Fr.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,Ir.ensure)((0,Ir.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:kd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),options:a.code2ProtocolConverter.asFormattingOptions(h,Bo.fromConfiguration(l))};return a.sendRequest(Fr.DocumentFormattingRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(b,f),b=>a.handleFailedRequest(Fr.DocumentFormattingRequest.type,f,b,null))},u=a.middleware;return u.provideDocumentFormattingEdits?u.provideDocumentFormattingEdits(i,s,o,c):c(i,s,o)}};return[Tc.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};oi.DocumentFormattingFeature=Gy;var Qy=class extends Ir.TextDocumentLanguageFeature{constructor(e){super(e,Fr.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){(0,Ir.ensure)((0,Ir.ensure)(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:kd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f),options:c.code2ProtocolConverter.asFormattingOptions(C,Bo.fromConfiguration(h))};return c.sendRequest(Fr.DocumentRangeFormattingRequest.type,y,b).then(S=>b.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(S,b),S=>c.handleFailedRequest(Fr.DocumentRangeFormattingRequest.type,b,S,null))},l=c.middleware;return l.provideDocumentRangeFormattingEdits?l.provideDocumentRangeFormattingEdits(i,s,o,a,u):u(i,s,o,a)}};return[Tc.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};oi.DocumentRangeFormattingFeature=Qy;var Yy=class extends Ir.TextDocumentLanguageFeature{constructor(e){super(e,Fr.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,Ir.ensure)((0,Ir.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:kd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,c,u)=>{let l=this._client,h=(C,b,y,S,k)=>{let v={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(C),position:l.code2ProtocolConverter.asPosition(b),ch:y,options:l.code2ProtocolConverter.asFormattingOptions(S,Bo.fromConfiguration(C))};return l.sendRequest(Fr.DocumentOnTypeFormattingRequest.type,v,k).then(D=>k.isCancellationRequested?null:l.protocol2CodeConverter.asTextEdits(D,k),D=>l.handleFailedRequest(Fr.DocumentOnTypeFormattingRequest.type,k,D,null))},f=l.middleware;return f.provideOnTypeFormattingEdits?f.provideOnTypeFormattingEdits(s,o,a,c,u,h):h(s,o,a,c,u)}},i=e.moreTriggerCharacter||[];return[Tc.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};oi.DocumentOnTypeFormattingFeature=Yy});var tw=L(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.RenameFeature=void 0;var XP=require("vscode"),Fi=le(),zP=rt(),Zy=_n(),Rd=_e(),ew=class extends Rd.TextDocumentLanguageFeature{constructor(e){super(e,Fi.RenameRequest.type)}fillClientCapabilities(e){let t=(0,Rd.ensure)((0,Rd.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=Fi.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(Zy.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:zP.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),position:c.code2ProtocolConverter.asPosition(f),newName:C};return c.sendRequest(Fi.RenameRequest.type,y,b).then(S=>b.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(S,b),S=>c.handleFailedRequest(Fi.RenameRequest.type,b,S,null,!1))},l=c.middleware;return l.provideRenameEdits?l.provideRenameEdits(i,s,o,a,u):u(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),position:a.code2ProtocolConverter.asPosition(h)};return a.sendRequest(Fi.PrepareRenameRequest.type,C,f).then(b=>f.isCancellationRequested?null:Fi.Range.is(b)?a.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&Fi.Range.is(b.range)?{range:a.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>{throw typeof b.message=="string"?new Error(b.message):new Error("The element can't be renamed.")})},u=a.middleware;return u.prepareRename?u.prepareRename(i,s,o,c):c(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return XP.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&Zy.boolean(t.defaultBehavior)}};Sc.RenameFeature=ew});var rw=L(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.DocumentLinkFeature=void 0;var GP=require("vscode"),Xo=le(),Pd=_e(),QP=rt(),nw=class extends Pd.TextDocumentLanguageFeature{constructor(e){super(e,Xo.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Pd.ensure)((0,Pd.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:QP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(Xo.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(u),l).then(h=>l.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(h,l),h=>o.handleFailedRequest(Xo.DocumentLinkRequest.type,l,h,null)),c=o.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(Xo.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(u),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asDocumentLink(h),h=>o.handleFailedRequest(Xo.DocumentLinkResolveRequest.type,l,h,u)),c=o.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[GP.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};kc.DocumentLinkFeature=nw});var ow=L(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.ExecuteCommandFeature=void 0;var YP=require("vscode"),_d=le(),JP=rt(),iw=_e(),sw=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return _d.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,iw.ensure)((0,iw.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:JP.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(_d.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(_d.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(YP.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Rc.ExecuteCommandFeature=sw});var cw=L(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.FileSystemWatcherFeature=void 0;var ZP=require("vscode"),Ii=le(),Pc=_e(),aw=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Ii.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,Pc.ensure)((0,Pc.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Pc.ensure)((0,Pc.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&Ii.WatchKind.Create)!=0,o=(r.kind&Ii.WatchKind.Change)!=0,a=(r.kind&Ii.WatchKind.Delete)!=0);let c=ZP.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(c,s,o,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ii.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ii.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ii.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};_c.FileSystemWatcherFeature=aw});var lw=L(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.ColorProviderFeature=void 0;var e_=require("vscode"),zo=le(),Ed=_e(),uw=class extends Ed.TextDocumentLanguageFeature{constructor(e){super(e,zo.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Ed.ensure)((0,Ed.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={color:l,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h.document),range:a.code2ProtocolConverter.asRange(h.range)};return a.sendRequest(zo.ColorPresentationRequest.type,C,f).then(b=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(b,f),b=>a.handleFailedRequest(zo.ColorPresentationRequest.type,f,b,null))},u=a.middleware;return u.provideColorPresentations?u.provideColorPresentations(i,s,o,c):c(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(u,l)=>{let h={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u)};return o.sendRequest(zo.DocumentColorRequest.type,h,l).then(f=>l.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(f,l),f=>o.handleFailedRequest(zo.DocumentColorRequest.type,l,f,null))},c=o.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,s,a):a(i,s)}};return[e_.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ec.ColorProviderFeature=uw});var fw=L(xc=>{"use strict";Object.defineProperty(xc,"__esModule",{value:!0});xc.ImplementationFeature=void 0;var t_=require("vscode"),xd=le(),Fd=_e(),dw=class extends Fd.TextDocumentLanguageFeature{constructor(e){super(e,xd.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Fd.ensure)((0,Fd.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(xd.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(xd.ImplementationRequest.type,f,C,null)),u=a.middleware;return u.provideImplementation?u.provideImplementation(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return t_.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xc.ImplementationFeature=dw});var pw=L(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.TypeDefinitionFeature=void 0;var n_=require("vscode"),Id=le(),Go=_e(),hw=class extends Go.TextDocumentLanguageFeature{constructor(e){super(e,Id.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Go.ensure)((0,Go.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Go.ensure)((0,Go.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Id.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(Id.TypeDefinitionRequest.type,f,C,null)),u=a.middleware;return u.provideTypeDefinition?u.provideTypeDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return n_.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Fc.TypeDefinitionFeature=hw});var mw=L(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.WorkspaceFoldersFeature=Ds.arrayDiff=void 0;var r_=rt(),Ic=require("vscode"),Qo=le();function Od(n,e){if(n!=null)return n[e]}function Nd(n,e){return n.filter(t=>e.indexOf(t)<0)}Ds.arrayDiff=Nd;var gw=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Qo.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Ic.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Qo.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=Ic.workspace.workspaceFolders;return c===void 0?null:c.map(l=>this.asProtocol(l))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=Od(Od(Od(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=r_.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Nd(this._initialFolders,e),i=Nd(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Qo.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Qo.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Ic.workspace.onDidChangeWorkspaceFolders(s=>{let o=u=>this.doSendEvent(u.added,u.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(u=>{this._client.error(`Sending notification ${Qo.DidChangeWorkspaceFoldersNotification.type.method} failed`,u)})});this._listeners.set(t,i),this.sendInitialEvent(Ic.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Ds.WorkspaceFoldersFeature=gw});var yw=L(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.FoldingRangeFeature=void 0;var i_=require("vscode"),Ts=le(),qd=_e(),vw=class extends qd.TextDocumentLanguageFeature{constructor(e){super(e,Ts.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,qd.ensure)((0,qd.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Ts.FoldingRangeKind.Comment,Ts.FoldingRangeKind.Imports,Ts.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1}}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l)};return a.sendRequest(Ts.FoldingRangeRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(b,f),b=>a.handleFailedRequest(Ts.FoldingRangeRequest.type,f,b,null))},u=a.middleware;return u.provideFoldingRanges?u.provideFoldingRanges(i,s,o,c):c(i,s,o)}};return[i_.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Oc.FoldingRangeFeature=vw});var bw=L(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.DeclarationFeature=void 0;var s_=require("vscode"),Ld=le(),Md=_e(),ww=class extends Md.TextDocumentLanguageFeature{constructor(e){super(e,Ld.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,Md.ensure)((0,Md.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Ld.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,f),C=>a.handleFailedRequest(Ld.DeclarationRequest.type,f,C,null)),u=a.middleware;return u.provideDeclaration?u.provideDeclaration(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return s_.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Nc.DeclarationFeature=ww});var Dw=L(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.SelectionRangeFeature=void 0;var o_=require("vscode"),Ad=le(),$d=_e(),Cw=class extends $d.TextDocumentLanguageFeature{constructor(e){super(e,Ad.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,$d.ensure)((0,$d.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,c=async(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),positions:await a.code2ProtocolConverter.asPositions(h,f)};return a.sendRequest(Ad.SelectionRangeRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(b,f),b=>a.handleFailedRequest(Ad.SelectionRangeRequest.type,f,b,null))},u=a.middleware;return u.provideSelectionRanges?u.provideSelectionRanges(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return o_.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};qc.SelectionRangeFeature=Cw});var kw=L(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.ProgressFeature=void 0;var Tw=le(),a_=Jl();function c_(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var Sw=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:Tw.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){c_(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new a_.ProgressPart(this._client,i.token,t))};e.onRequest(Tw.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Lc.ProgressFeature=Sw});var _w=L(Mc=>{"use strict";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.CallHierarchyFeature=void 0;var u_=require("vscode"),Oi=le(),jd=_e(),Rw=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Oi.CallHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(h,u),h=>i.handleFailedRequest(Oi.CallHierarchyPrepareRequest.type,u,h,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(Oi.CallHierarchyIncomingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(u,a),u=>r.handleFailedRequest(Oi.CallHierarchyIncomingCallsRequest.type,a,u,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(Oi.CallHierarchyOutgoingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(u,a),u=>r.handleFailedRequest(Oi.CallHierarchyOutgoingCallsRequest.type,a,u,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},Pw=class extends jd.TextDocumentLanguageFeature{constructor(e){super(e,Oi.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,jd.ensure)((0,jd.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Rw(t);return[u_.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Mc.CallHierarchyFeature=Pw});var xw=L($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.SemanticTokensFeature=void 0;var Ac=require("vscode"),de=le(),Yo=_e(),l_=_n(),Ew=class extends Yo.TextDocumentLanguageFeature{constructor(e){super(e,de.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Yo.ensure)((0,Yo.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[de.SemanticTokenTypes.namespace,de.SemanticTokenTypes.type,de.SemanticTokenTypes.class,de.SemanticTokenTypes.enum,de.SemanticTokenTypes.interface,de.SemanticTokenTypes.struct,de.SemanticTokenTypes.typeParameter,de.SemanticTokenTypes.parameter,de.SemanticTokenTypes.variable,de.SemanticTokenTypes.property,de.SemanticTokenTypes.enumMember,de.SemanticTokenTypes.event,de.SemanticTokenTypes.function,de.SemanticTokenTypes.method,de.SemanticTokenTypes.macro,de.SemanticTokenTypes.keyword,de.SemanticTokenTypes.modifier,de.SemanticTokenTypes.comment,de.SemanticTokenTypes.string,de.SemanticTokenTypes.number,de.SemanticTokenTypes.regexp,de.SemanticTokenTypes.operator,de.SemanticTokenTypes.decorator],t.tokenModifiers=[de.SemanticTokenModifiers.declaration,de.SemanticTokenModifiers.definition,de.SemanticTokenModifiers.readonly,de.SemanticTokenModifiers.static,de.SemanticTokenModifiers.deprecated,de.SemanticTokenModifiers.abstract,de.SemanticTokenModifiers.async,de.SemanticTokenModifiers.modification,de.SemanticTokenModifiers.documentation,de.SemanticTokenModifiers.defaultLibrary],t.formats=[de.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Yo.ensure)((0,Yo.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(de.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=l_.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Ac.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(C,b)=>{let y=this._client,S=y.middleware,k=(v,D)=>{let R={textDocument:y.code2ProtocolConverter.asTextDocumentIdentifier(v)};return y.sendRequest(de.SemanticTokensRequest.type,R,D).then(x=>D.isCancellationRequested?null:y.protocol2CodeConverter.asSemanticTokens(x,D),x=>y.handleFailedRequest(de.SemanticTokensRequest.type,D,x,null))};return S.provideDocumentSemanticTokens?S.provideDocumentSemanticTokens(C,b,k):k(C,b)},provideDocumentSemanticTokensEdits:i?(C,b,y)=>{let S=this._client,k=S.middleware,v=(D,R,x)=>{let F={textDocument:S.code2ProtocolConverter.asTextDocumentIdentifier(D),previousResultId:R};return S.sendRequest(de.SemanticTokensDeltaRequest.type,F,x).then(async N=>x.isCancellationRequested?null:de.SemanticTokens.is(N)?await S.protocol2CodeConverter.asSemanticTokens(N,x):await S.protocol2CodeConverter.asSemanticTokensEdits(N,x),N=>S.handleFailedRequest(de.SemanticTokensDeltaRequest.type,x,N,null))};return k.provideDocumentSemanticTokensEdits?k.provideDocumentSemanticTokensEdits(C,b,y,v):v(C,b,y)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,b,y)=>{let S=this._client,k=S.middleware,v=(D,R,x)=>{let F={textDocument:S.code2ProtocolConverter.asTextDocumentIdentifier(D),range:S.code2ProtocolConverter.asRange(R)};return S.sendRequest(de.SemanticTokensRangeRequest.type,F,x).then(N=>x.isCancellationRequested?null:S.protocol2CodeConverter.asSemanticTokens(N,x),N=>S.handleFailedRequest(de.SemanticTokensRangeRequest.type,x,N,null))};return k.provideDocumentRangeSemanticTokens?k.provideDocumentRangeSemanticTokens(C,b,y,v):v(C,b,y)}}:void 0,u=[],l=this._client,h=l.protocol2CodeConverter.asSemanticTokensLegend(e.legend),f=l.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&u.push(Ac.languages.registerDocumentSemanticTokensProvider(f,o,h)),c!==void 0&&u.push(Ac.languages.registerDocumentRangeSemanticTokensProvider(f,c,h)),[new Ac.Disposable(()=>u.forEach(C=>C.dispose())),{range:c,full:o,onDidChangeSemanticTokensEmitter:s}]}};$c.SemanticTokensFeature=Ew});var $w=L(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.WillDeleteFilesFeature=dn.WillRenameFilesFeature=dn.WillCreateFilesFeature=dn.DidDeleteFilesFeature=dn.DidRenameFilesFeature=dn.DidCreateFilesFeature=void 0;var In=require("vscode"),d_=uc(),Or=le(),f_=rt();function Fw(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function h_(n,e){return n[e]}function Iw(n,e,t){n[e]=t}var ai=class{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Fw(Fw(e,"workspace"),"fileOperations");Iw(t,"dynamicRegistration",!0),Iw(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?h_(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:f_.generateUuid(),registerOptions:{filters:r.filters}})}catch(s){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${s}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new d_.Minimatch(r.pattern.glob,ai.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return ai.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let u of c)if(!(u.scheme!==void 0&&u.scheme!==o.scheme)){if(u.matcher.match(a)){if(u.kind===void 0)return!0;let l=await this.getFileType(o);if(l===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(l===In.FileType.File&&u.kind===Or.FileOperationPatternKind.file||l===In.FileType.Directory&&u.kind===Or.FileOperationPatternKind.folder)return!0}else if(u.kind===Or.FileOperationPatternKind.folder&&await ai.getFileType(o)===In.FileType.Directory&&u.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return Sn(ce({},e),{files:i})}static async getFileType(e){try{return(await In.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},Wd=class extends ai{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},Hd=class extends Wd{constructor(){super(...arguments);this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await ai.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Ow=class extends Wd{constructor(e){super(e,In.workspace.onDidCreateFiles,Or.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.didCreateFiles)?r.didCreateFiles(e,t):t(e)}};dn.DidCreateFilesFeature=Ow;var Nw=class extends Hd{constructor(e){super(e,In.workspace.onDidRenameFiles,Or.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=In.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didRenameFiles)?r.didRenameFiles(e,t):t(e)}};dn.DidRenameFilesFeature=Nw;var qw=class extends Hd{constructor(e){super(e,In.workspace.onDidDeleteFiles,Or.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=In.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didDeleteFiles)?r.didDeleteFiles(e,t):t(e)}};dn.DidDeleteFilesFeature=qw;var jc=class extends ai{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Lw=class extends jc{constructor(e){super(e,In.workspace.onWillCreateFiles,Or.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willCreateFiles)?r.willCreateFiles(e,t):t(e)}};dn.WillCreateFilesFeature=Lw;var Mw=class extends jc{constructor(e){super(e,In.workspace.onWillRenameFiles,Or.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willRenameFiles)?r.willRenameFiles(e,t):t(e)}};dn.WillRenameFilesFeature=Mw;var Aw=class extends jc{constructor(e){super(e,In.workspace.onWillDeleteFiles,Or.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willDeleteFiles)?r.willDeleteFiles(e,t):t(e)}};dn.WillDeleteFilesFeature=Aw});var Ww=L(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.LinkedEditingFeature=void 0;var p_=require("vscode"),Ud=le(),Kd=_e(),jw=class extends Kd.TextDocumentLanguageFeature{constructor(e){super(e,Ud.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Kd.ensure)((0,Kd.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Ud.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,f),C=>a.handleFailedRequest(Ud.LinkedEditingRangeRequest.type,f,C,null)),u=a.middleware;return u.provideLinkedEditingRange?u.provideLinkedEditingRange(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return p_.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Wc.LinkedEditingFeature=jw});var Kw=L(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.TypeHierarchyFeature=void 0;var g_=require("vscode"),Ni=le(),Vd=_e(),Hw=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Ni.TypeHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(h,u),h=>i.handleFailedRequest(Ni.TypeHierarchyPrepareRequest.type,u,h,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Ni.TypeHierarchySupertypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(Ni.TypeHierarchySupertypesRequest.type,a,u,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Ni.TypeHierarchySubtypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(Ni.TypeHierarchySubtypesRequest.type,a,u,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},Uw=class extends Vd.TextDocumentLanguageFeature{constructor(e){super(e,Ni.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,Vd.ensure)((0,Vd.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Hw(t);return[g_.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Hc.TypeHierarchyFeature=Uw});var Xw=L(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.InlineValueFeature=void 0;var Vw=require("vscode"),Uc=le(),Jo=_e(),Bw=class extends Jo.TextDocumentLanguageFeature{constructor(e){super(e,Uc.InlineValueRequest.type)}fillClientCapabilities(e){(0,Jo.ensure)((0,Jo.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,Jo.ensure)((0,Jo.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(Uc.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Vw.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,c)=>{let u=this._client,l=(f,C,b,y)=>{let S={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),range:u.code2ProtocolConverter.asRange(C),context:u.code2ProtocolConverter.asInlineValueContext(b)};return u.sendRequest(Uc.InlineValueRequest.type,S,y).then(k=>y.isCancellationRequested?null:u.protocol2CodeConverter.asInlineValues(k,y),k=>u.handleFailedRequest(Uc.InlineValueRequest.type,y,k,null))},h=u.middleware;return h.provideInlineValues?h.provideInlineValues(s,o,a,c,l):l(s,o,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return Vw.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Kc.InlineValueFeature=Bw});var Qw=L(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.InlayHintsFeature=void 0;var zw=require("vscode"),Ss=le(),Zo=_e(),Gw=class extends Zo.TextDocumentLanguageFeature{constructor(e){super(e,Ss.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,Zo.ensure)((0,Zo.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Zo.ensure)((0,Zo.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ss.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new zw.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let c=this._client,u=async(h,f,C)=>{let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f)};try{let y=await c.sendRequest(Ss.InlayHintRequest.type,b,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(y,C)}catch(y){return c.handleFailedRequest(Ss.InlayHintRequest.type,C,y,null)}},l=c.middleware;return l.provideInlayHints?l.provideInlayHints(s,o,a,u):u(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,c=async(l,h)=>{try{let f=await a.sendRequest(Ss.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(l),h);if(h.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(f,h);return h.isCancellationRequested?null:C}catch(f){return a.handleFailedRequest(Ss.InlayHintResolveRequest.type,h,f,null)}},u=a.middleware;return u.resolveInlayHint?u.resolveInlayHint(s,o,c):c(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return zw.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Vc.InlayHintsFeature=Gw});var Xd=L(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.ProposedFeatures=Xe.BaseLanguageClient=Xe.MessageTransports=Xe.SuspendMode=Xe.State=Xe.CloseAction=Xe.ErrorAction=Xe.RevealOutputChannelOn=void 0;var Me=require("vscode"),K=le(),m_=Pv(),v_=xv(),dr=_n(),Bc=ec(),Yw=rt(),y_=Jl(),Yn=_e(),w_=ud(),Jw=gy(),Zw=wy(),ks=Ry(),b_=_y(),C_=xy(),D_=Iy(),T_=qy(),S_=My(),k_=bd(),R_=Wy(),P_=Uy(),__=Vy(),E_=zy(),Bd=Jy(),x_=tw(),F_=rw(),I_=ow(),O_=cw(),N_=lw(),q_=fw(),L_=pw(),M_=mw(),A_=yw(),$_=bw(),j_=Dw(),W_=kw(),H_=_w(),U_=xw(),Rs=$w(),K_=Ww(),V_=Kw(),B_=Xw(),X_=Qw(),ea;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(ea=Xe.RevealOutputChannelOn||(Xe.RevealOutputChannelOn={}));var Xc;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(Xc=Xe.ErrorAction||(Xe.ErrorAction={}));var qi;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(qi=Xe.CloseAction||(Xe.CloseAction={}));var zc;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(zc=Xe.State||(Xe.State={}));var z_;(function(n){n.off="off",n.on="on"})(z_=Xe.SuspendMode||(Xe.SuspendMode={}));var eb=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Xc.Continue}:{action:Xc.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:qi.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:qi.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:qi.Restart})}},be;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(be||(be={}));var G_;(function(n){function e(t){return t&&K.MessageReader.is(t.reader)&&K.MessageWriter.is(t.writer)}n.is=e})(G_=Xe.MessageTransports||(Xe.MessageTransports={}));var ci=class{constructor(e,t,r){var s;this._traceFormat=K.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Bc.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??ea.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((s=r.connectionOptions)==null?void 0:s.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=be.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new Bc.Semaphore(1),this._pendingChangeDelayer=new Bc.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new Bc.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new K.Emitter,this._stateChangeEmitter=new K.Emitter,this._trace=K.Trace.Off,this._tracer={log:(o,a)=>{dr.string(o)?this.logTrace(o,a):this.logObjectTrace(o)}},this._c2p=m_.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=v_.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Me.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case be.Starting:return zc.Starting;case be.Running:return zc.Running;default:return zc.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===be.StartFailed||this.$state===be.Stopping||this.$state===be.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();return this._didChangeTextDocumentFeature.syncKind===K.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r),r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===be.StartFailed||this.$state===be.Stopping||this.$state===be.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===K.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===K.DidOpenTextDocumentNotification.method&&(i=t==null?void 0:t.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();return r&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i),s.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){if(this.$state===be.StartFailed||this.$state===be.Stopping||this.$state===be.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){var c;this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=(c=this._clientOptions.middleware)==null?void 0:c.handleWorkDoneProgress,a=K.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new eb(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof K.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?dr.string(e.stack)?e.stack:e.message:dr.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=ea.Info&&this.showNotificationMessage(K.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=ea.Warn&&this.showNotificationMessage(K.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=ea.Error)&&this.showNotificationMessage(K.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===K.MessageType.Error?Me.window.showErrorMessage:e===K.MessageType.Warning?Me.window.showWarningMessage:Me.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===be.Initial||this.$state===be.Stopping||this.$state===be.Stopped}needsStop(){return this.$state===be.Starting||this.$state===be.Running}activeConnection(){return this.$state===be.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===be.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===be.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Me.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Me.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=be.Starting;try{let i=await this.createConnection();i.onNotification(K.LogMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:this.error(s.message,void 0,!1);break;case K.MessageType.Warning:this.warn(s.message,void 0,!1);break;case K.MessageType.Info:this.info(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(K.ShowMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:Me.window.showErrorMessage(s.message);break;case K.MessageType.Warning:Me.window.showWarningMessage(s.message);break;case K.MessageType.Info:Me.window.showInformationMessage(s.message);break;default:Me.window.showInformationMessage(s.message)}}),i.onRequest(K.ShowMessageRequest.type,s=>{let o;switch(s.type){case K.MessageType.Error:o=Me.window.showErrorMessage;break;case K.MessageType.Warning:o=Me.window.showWarningMessage;break;case K.MessageType.Info:o=Me.window.showInformationMessage;break;default:o=Me.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(K.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(K.ShowDocumentRequest.type,async s=>{var c;let o=async u=>{let l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Me.env.openExternal(l)};{let h={};return u.selection!==void 0&&(h.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?h.preserveFocus=!0:u.takeFocus===!0&&(h.preserveFocus=!1),await Me.window.showTextDocument(l,h),{success:!0}}}catch{return{success:!1}}},a=(c=this._clientOptions.middleware.window)==null?void 0:c.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=be.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Me.env.appName,version:Me.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Me.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:dr.func(t)?t():t,trace:K.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=Yw.generateUuid(),a=new y_.ProgressPart(e,o);s.workDoneToken=o;try{let c=await this.doInitialize(e,s);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==K.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=be.Running;let i;dr.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===K.TextDocumentSyncKind.None?i={openClose:!1,change:K.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(K.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(K.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(K.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(K.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(K.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof K.ResponseError&&r.data&&r.data.retry?Me.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Me.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Me.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===be.Stopped||this.$state===be.Initial)return;if(this.$state===be.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==be.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=be.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,K.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=be.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.dispose();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var s;let t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(K.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=(s=this.clientOptions.middleware)==null?void 0:s.workspace;((i==null?void 0:i.didChangeWatchedFile)?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(K.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,K.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,K.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new Me.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(c,u)=>this.setDiagnostics(c,u)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}getLocale(){return Me.env.language}async $start(){if(this.$state===be.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=Q_(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===be.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:qi.DoNotRestart};if(this.$state!==be.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===qi.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===be.Starting?this.$state=be.StartFailed:this.$state=be.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===qi.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=be.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===Xc.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)}))}hookConfigurationChanged(e){this._listeners.push(Me.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=Me.workspace.getConfiguration(this._id),i=K.Trace.Off,s=K.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=K.Trace.fromString(o):(i=K.Trace.fromString(r.get("trace.server.verbosity","off")),s=K.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;dr.array(t)?r=t:r=[t],!!r&&this._dynamicFeatures.get(K.DidChangeWatchedFilesNotification.type.method).registerRaw(Yw.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Yn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(K.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Jw.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new Zw.ConfigurationFeature(this)),this.registerFeature(new ks.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new ks.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new ks.WillSaveFeature(this)),this.registerFeature(new ks.WillSaveWaitUntilFeature(this)),this.registerFeature(new ks.DidSaveTextDocumentFeature(this)),this.registerFeature(new ks.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new O_.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new b_.CompletionItemFeature(this)),this.registerFeature(new C_.HoverFeature(this)),this.registerFeature(new T_.SignatureHelpFeature(this)),this.registerFeature(new D_.DefinitionFeature(this)),this.registerFeature(new P_.ReferencesFeature(this)),this.registerFeature(new S_.DocumentHighlightFeature(this)),this.registerFeature(new k_.DocumentSymbolFeature(this)),this.registerFeature(new R_.WorkspaceSymbolFeature(this)),this.registerFeature(new __.CodeActionFeature(this)),this.registerFeature(new E_.CodeLensFeature(this)),this.registerFeature(new Bd.DocumentFormattingFeature(this)),this.registerFeature(new Bd.DocumentRangeFormattingFeature(this)),this.registerFeature(new Bd.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new x_.RenameFeature(this)),this.registerFeature(new F_.DocumentLinkFeature(this)),this.registerFeature(new I_.ExecuteCommandFeature(this)),this.registerFeature(new Zw.SyncConfigurationFeature(this)),this.registerFeature(new L_.TypeDefinitionFeature(this)),this.registerFeature(new q_.ImplementationFeature(this)),this.registerFeature(new N_.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new M_.WorkspaceFoldersFeature(this)),this.registerFeature(new A_.FoldingRangeFeature(this)),this.registerFeature(new $_.DeclarationFeature(this)),this.registerFeature(new j_.SelectionRangeFeature(this)),this.registerFeature(new W_.ProgressFeature(this)),this.registerFeature(new H_.CallHierarchyFeature(this)),this.registerFeature(new U_.SemanticTokensFeature(this)),this.registerFeature(new K_.LinkedEditingFeature(this)),this.registerFeature(new Rs.DidCreateFilesFeature(this)),this.registerFeature(new Rs.DidRenameFilesFeature(this)),this.registerFeature(new Rs.DidDeleteFilesFeature(this)),this.registerFeature(new Rs.WillCreateFilesFeature(this)),this.registerFeature(new Rs.WillRenameFilesFeature(this)),this.registerFeature(new Rs.WillDeleteFilesFeature(this)),this.registerFeature(new V_.TypeHierarchyFeature(this)),this.registerFeature(new B_.InlineValueFeature(this)),this.registerFeature(new X_.InlayHintsFeature(this)),this.registerFeature(new w_.DiagnosticFeature(this)),this.registerFeature(new Jw.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(nb.createAll(this))}fillInitializeParams(e){for(let t of this._features)dr.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,Yn.ensure)(e,"workspace").applyEdit=!0;let t=(0,Yn.ensure)((0,Yn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[K.ResourceOperationKind.Create,K.ResourceOperationKind.Rename,K.ResourceOperationKind.Delete],t.failureHandling=K.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,Yn.ensure)((0,Yn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[K.DiagnosticTag.Unnecessary,K.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,Yn.ensure)(e,"window"),s=(0,Yn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,Yn.ensure)(i,"showDocument");o.support=!0;let a=(0,Yn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(ci.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)dr.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Me.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(K.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),c=i.get(a);if(c&&c.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):dr.asPromise(Me.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof K.ResponseError){if(r.code===K.ErrorCodes.PendingResponseRejected||r.code===K.ErrorCodes.ConnectionInactive)return i;if(r.code===K.LSPErrorCodes.RequestCancelled||r.code===K.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Yn.LSPCancellationError(r.data):new Me.CancellationError}else if(r.code===K.LSPErrorCodes.ContentModified){if(ci.RequestsToCancelOnContentModified.has(e.method)||ci.CancellableResolveCalls.has(e.method))throw new Me.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};Xe.BaseLanguageClient=ci;ci.RequestsToCancelOnContentModified=new Set([K.SemanticTokensRequest.method,K.SemanticTokensRangeRequest.method,K.SemanticTokensDeltaRequest.method]);ci.CancellableResolveCalls=new Set([K.CompletionResolveRequest.method,K.CodeLensResolveRequest.method,K.CodeActionResolveRequest.method,K.InlayHintResolveRequest.method,K.DocumentLinkResolveRequest.method,K.WorkspaceSymbolResolveRequest.method]);var tb=class{error(e){(0,K.RAL)().console.error(e)}warn(e){(0,K.RAL)().console.warn(e)}info(e){(0,K.RAL)().console.info(e)}log(e){(0,K.RAL)().console.log(e)}};function Q_(n,e,t,r,i){let s=new tb,o=(0,K.createProtocolConnection)(n,e,s,i);return o.onError(c=>{t(c[0],c[1],c[2])}),o.onClose(r),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(c,u,l)=>{let h={sendNotification:!1,traceFormat:K.TraceFormat.Text};return l===void 0?o.trace(c,u,h):(dr.boolean(l),o.trace(c,u,l))},initialize:c=>o.sendRequest(K.InitializeRequest.type,c),shutdown:()=>o.sendRequest(K.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(K.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var nb;(function(n){function e(t){return[]}n.createAll=e})(nb=Xe.ProposedFeatures||(Xe.ProposedFeatures={}))});var ib=L(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.terminate=void 0;var rb=require("child_process"),Y_=require("path"),J_=process.platform==="win32",Z_=process.platform==="darwin",eE=process.platform==="linux";function tE(n,e){if(J_)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),rb.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(eE||Z_)try{var t=(0,Y_.join)(__dirname,"terminateProcess.sh"),r=rb.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Gc.terminate=tE});var zd=L((W0,sb)=>{"use strict";sb.exports=le()});var ta=L((H0,ob)=>{var nE=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};ob.exports=nE});var Qc=L((U0,cb)=>{var rE="2.0.0",ab=256,iE=Number.MAX_SAFE_INTEGER||9007199254740991,sE=16,oE=ab-6,aE=["major","premajor","minor","preminor","patch","prepatch","prerelease"];cb.exports={MAX_LENGTH:ab,MAX_SAFE_COMPONENT_LENGTH:sE,MAX_SAFE_BUILD_LENGTH:oE,MAX_SAFE_INTEGER:iE,RELEASE_TYPES:aE,SEMVER_SPEC_VERSION:rE,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Jc=L((Nr,ub)=>{var{MAX_SAFE_COMPONENT_LENGTH:Yc,MAX_SAFE_BUILD_LENGTH:cE}=Qc(),uE=ta();Nr=ub.exports={};var lE=Nr.re=[],dE=Nr.safeRe=[],Z=Nr.src=[],ee=Nr.t={},fE=0,Gd="[a-zA-Z0-9-]",hE=[["\\s",1],["\\d",Yc],[Gd,cE]],pE=n=>{for(let[e,t]of hE)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},me=(n,e,t)=>{let r=pE(e),i=fE++;uE(n,i,e),ee[n]=i,Z[i]=e,lE[i]=new RegExp(e,t?"g":void 0),dE[i]=new RegExp(r,t?"g":void 0)};me("NUMERICIDENTIFIER","0|[1-9]\\d*");me("NUMERICIDENTIFIERLOOSE","\\d+");me("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Gd}*`);me("MAINVERSION",`(${Z[ee.NUMERICIDENTIFIER]})\\.(${Z[ee.NUMERICIDENTIFIER]})\\.(${Z[ee.NUMERICIDENTIFIER]})`);me("MAINVERSIONLOOSE",`(${Z[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Z[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Z[ee.NUMERICIDENTIFIERLOOSE]})`);me("PRERELEASEIDENTIFIER",`(?:${Z[ee.NUMERICIDENTIFIER]}|${Z[ee.NONNUMERICIDENTIFIER]})`);me("PRERELEASEIDENTIFIERLOOSE",`(?:${Z[ee.NUMERICIDENTIFIERLOOSE]}|${Z[ee.NONNUMERICIDENTIFIER]})`);me("PRERELEASE",`(?:-(${Z[ee.PRERELEASEIDENTIFIER]}(?:\\.${Z[ee.PRERELEASEIDENTIFIER]})*))`);me("PRERELEASELOOSE",`(?:-?(${Z[ee.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Z[ee.PRERELEASEIDENTIFIERLOOSE]})*))`);me("BUILDIDENTIFIER",`${Gd}+`);me("BUILD",`(?:\\+(${Z[ee.BUILDIDENTIFIER]}(?:\\.${Z[ee.BUILDIDENTIFIER]})*))`);me("FULLPLAIN",`v?${Z[ee.MAINVERSION]}${Z[ee.PRERELEASE]}?${Z[ee.BUILD]}?`);me("FULL",`^${Z[ee.FULLPLAIN]}$`);me("LOOSEPLAIN",`[v=\\s]*${Z[ee.MAINVERSIONLOOSE]}${Z[ee.PRERELEASELOOSE]}?${Z[ee.BUILD]}?`);me("LOOSE",`^${Z[ee.LOOSEPLAIN]}$`);me("GTLT","((?:<|>)?=?)");me("XRANGEIDENTIFIERLOOSE",`${Z[ee.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);me("XRANGEIDENTIFIER",`${Z[ee.NUMERICIDENTIFIER]}|x|X|\\*`);me("XRANGEPLAIN",`[v=\\s]*(${Z[ee.XRANGEIDENTIFIER]})(?:\\.(${Z[ee.XRANGEIDENTIFIER]})(?:\\.(${Z[ee.XRANGEIDENTIFIER]})(?:${Z[ee.PRERELEASE]})?${Z[ee.BUILD]}?)?)?`);me("XRANGEPLAINLOOSE",`[v=\\s]*(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:${Z[ee.PRERELEASELOOSE]})?${Z[ee.BUILD]}?)?)?`);me("XRANGE",`^${Z[ee.GTLT]}\\s*${Z[ee.XRANGEPLAIN]}$`);me("XRANGELOOSE",`^${Z[ee.GTLT]}\\s*${Z[ee.XRANGEPLAINLOOSE]}$`);me("COERCE",`(^|[^\\d])(\\d{1,${Yc}})(?:\\.(\\d{1,${Yc}}))?(?:\\.(\\d{1,${Yc}}))?(?:$|[^\\d])`);me("COERCERTL",Z[ee.COERCE],!0);me("LONETILDE","(?:~>?)");me("TILDETRIM",`(\\s*)${Z[ee.LONETILDE]}\\s+`,!0);Nr.tildeTrimReplace="$1~";me("TILDE",`^${Z[ee.LONETILDE]}${Z[ee.XRANGEPLAIN]}$`);me("TILDELOOSE",`^${Z[ee.LONETILDE]}${Z[ee.XRANGEPLAINLOOSE]}$`);me("LONECARET","(?:\\^)");me("CARETTRIM",`(\\s*)${Z[ee.LONECARET]}\\s+`,!0);Nr.caretTrimReplace="$1^";me("CARET",`^${Z[ee.LONECARET]}${Z[ee.XRANGEPLAIN]}$`);me("CARETLOOSE",`^${Z[ee.LONECARET]}${Z[ee.XRANGEPLAINLOOSE]}$`);me("COMPARATORLOOSE",`^${Z[ee.GTLT]}\\s*(${Z[ee.LOOSEPLAIN]})$|^$`);me("COMPARATOR",`^${Z[ee.GTLT]}\\s*(${Z[ee.FULLPLAIN]})$|^$`);me("COMPARATORTRIM",`(\\s*)${Z[ee.GTLT]}\\s*(${Z[ee.LOOSEPLAIN]}|${Z[ee.XRANGEPLAIN]})`,!0);Nr.comparatorTrimReplace="$1$2$3";me("HYPHENRANGE",`^\\s*(${Z[ee.XRANGEPLAIN]})\\s+-\\s+(${Z[ee.XRANGEPLAIN]})\\s*$`);me("HYPHENRANGELOOSE",`^\\s*(${Z[ee.XRANGEPLAINLOOSE]})\\s+-\\s+(${Z[ee.XRANGEPLAINLOOSE]})\\s*$`);me("STAR","(<|>)?=?\\s*\\*");me("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");me("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Zc=L((K0,lb)=>{var gE=Object.freeze({loose:!0}),mE=Object.freeze({}),vE=n=>n?typeof n!="object"?gE:n:mE;lb.exports=vE});var pb=L((V0,hb)=>{var db=/^[0-9]+$/,fb=(n,e)=>{let t=db.test(n),r=db.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},yE=(n,e)=>fb(e,n);hb.exports={compareIdentifiers:fb,rcompareIdentifiers:yE}});var na=L((B0,yb)=>{var eu=ta(),{MAX_LENGTH:gb,MAX_SAFE_INTEGER:tu}=Qc(),{safeRe:mb,t:vb}=Jc(),wE=Zc(),{compareIdentifiers:Ps}=pb(),On=class{constructor(e,t){if(t=wE(t),e instanceof On){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>gb)throw new TypeError(`version is longer than ${gb} characters`);eu("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?mb[vb.LOOSE]:mb[vb.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>tu||this.major<0)throw new TypeError("Invalid major version");if(this.minor>tu||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>tu||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<tu)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(eu("SemVer.compare",this.version,this.options,e),!(e instanceof On)){if(typeof e=="string"&&e===this.version)return 0;e=new On(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof On||(e=new On(e,this.options)),Ps(this.major,e.major)||Ps(this.minor,e.minor)||Ps(this.patch,e.patch)}comparePre(e){if(e instanceof On||(e=new On(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(eu("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ps(r,i)}while(++t)}compareBuild(e){e instanceof On||(e=new On(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(eu("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ps(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),Ps(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};yb.exports=On});var Cb=L((X0,bb)=>{var wb=na(),bE=(n,e,t=!1)=>{if(n instanceof wb)return n;try{return new wb(n,e)}catch(r){if(!t)return null;throw r}};bb.exports=bE});var Tb=L((z0,Db)=>{"use strict";Db.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var kb=L((G0,Sb)=>{"use strict";Sb.exports=Oe;Oe.Node=Li;Oe.create=Oe;function Oe(n){var e=this;if(e instanceof Oe||(e=new Oe),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}Oe.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};Oe.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};Oe.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};Oe.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)DE(this,arguments[n]);return this.length};Oe.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)TE(this,arguments[n]);return this.length};Oe.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};Oe.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};Oe.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};Oe.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};Oe.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};Oe.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};Oe.prototype.map=function(n,e){e=e||this;for(var t=new Oe,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};Oe.prototype.mapReverse=function(n,e){e=e||this;for(var t=new Oe,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};Oe.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};Oe.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};Oe.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};Oe.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};Oe.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Oe;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};Oe.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Oe;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};Oe.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var s=[],r=0;i&&r<e;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=CE(this,i,t[r]);return s};Oe.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function CE(n,e,t){var r=e===n.head?new Li(t,null,e,n):new Li(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function DE(n,e){n.tail=new Li(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function TE(n,e){n.head=new Li(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function Li(n,e,t,r){if(!(this instanceof Li))return new Li(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Tb()(Oe)}catch{}});var Ib=L((Q0,Fb)=>{"use strict";var SE=kb(),Mi=Symbol("max"),qr=Symbol("length"),_s=Symbol("lengthCalculator"),ra=Symbol("allowStale"),Ai=Symbol("maxAge"),Lr=Symbol("dispose"),Rb=Symbol("noDisposeOnSet"),Rt=Symbol("lruList"),Jn=Symbol("cache"),Pb=Symbol("updateAgeOnGet"),Qd=()=>1,_b=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[Mi]=e.max||1/0,r=e.length||Qd;if(this[_s]=typeof r!="function"?Qd:r,this[ra]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Ai]=e.maxAge||0,this[Lr]=e.dispose,this[Rb]=e.noDisposeOnSet||!1,this[Pb]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Mi]=e||1/0,ia(this)}get max(){return this[Mi]}set allowStale(e){this[ra]=!!e}get allowStale(){return this[ra]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Ai]=e,ia(this)}get maxAge(){return this[Ai]}set lengthCalculator(e){typeof e!="function"&&(e=Qd),e!==this[_s]&&(this[_s]=e,this[qr]=0,this[Rt].forEach(t=>{t.length=this[_s](t.value,t.key),this[qr]+=t.length})),ia(this)}get lengthCalculator(){return this[_s]}get length(){return this[qr]}get itemCount(){return this[Rt].length}rforEach(e,t){t=t||this;for(let r=this[Rt].tail;r!==null;){let i=r.prev;xb(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[Rt].head;r!==null;){let i=r.next;xb(this,e,r,t),r=i}}keys(){return this[Rt].toArray().map(e=>e.key)}values(){return this[Rt].toArray().map(e=>e.value)}reset(){this[Lr]&&this[Rt]&&this[Rt].length&&this[Rt].forEach(e=>this[Lr](e.key,e.value)),this[Jn]=new Map,this[Rt]=new SE,this[qr]=0}dump(){return this[Rt].map(e=>nu(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Rt]}set(e,t,r){if(r=r||this[Ai],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,s=this[_s](t,e);if(this[Jn].has(e)){if(s>this[Mi])return Es(this,this[Jn].get(e)),!1;let c=this[Jn].get(e).value;return this[Lr]&&(this[Rb]||this[Lr](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[qr]+=s-c.length,c.length=s,this.get(e),ia(this),!0}let o=new Eb(e,t,s,i,r);return o.length>this[Mi]?(this[Lr]&&this[Lr](e,t),!1):(this[qr]+=o.length,this[Rt].unshift(o),this[Jn].set(e,this[Rt].head),ia(this),!0)}has(e){if(!this[Jn].has(e))return!1;let t=this[Jn].get(e).value;return!nu(this,t)}get(e){return Yd(this,e,!0)}peek(e){return Yd(this,e,!1)}pop(){let e=this[Rt].tail;return e?(Es(this,e),e.value):null}del(e){Es(this,this[Jn].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Jn].forEach((e,t)=>Yd(this,t,!1))}},Yd=(n,e,t)=>{let r=n[Jn].get(e);if(r){let i=r.value;if(nu(n,i)){if(Es(n,r),!n[ra])return}else t&&(n[Pb]&&(r.value.now=Date.now()),n[Rt].unshiftNode(r));return i.value}},nu=(n,e)=>{if(!e||!e.maxAge&&!n[Ai])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[Ai]&&t>n[Ai]},ia=n=>{if(n[qr]>n[Mi])for(let e=n[Rt].tail;n[qr]>n[Mi]&&e!==null;){let t=e.prev;Es(n,e),e=t}},Es=(n,e)=>{if(e){let t=e.value;n[Lr]&&n[Lr](t.key,t.value),n[qr]-=t.length,n[Jn].delete(t.key),n[Rt].removeNode(e)}},Eb=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=s||0}},xb=(n,e,t,r)=>{let i=t.value;nu(n,i)&&(Es(n,t),n[ra]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};Fb.exports=_b});var $i=L((Y0,Nb)=>{var Ob=na(),kE=(n,e,t)=>new Ob(n,t).compare(new Ob(e,t));Nb.exports=kE});var Lb=L((J0,qb)=>{var RE=$i(),PE=(n,e,t)=>RE(n,e,t)===0;qb.exports=PE});var Ab=L((Z0,Mb)=>{var _E=$i(),EE=(n,e,t)=>_E(n,e,t)!==0;Mb.exports=EE});var jb=L((eN,$b)=>{var xE=$i(),FE=(n,e,t)=>xE(n,e,t)>0;$b.exports=FE});var Hb=L((tN,Wb)=>{var IE=$i(),OE=(n,e,t)=>IE(n,e,t)>=0;Wb.exports=OE});var Kb=L((nN,Ub)=>{var NE=$i(),qE=(n,e,t)=>NE(n,e,t)<0;Ub.exports=qE});var Bb=L((rN,Vb)=>{var LE=$i(),ME=(n,e,t)=>LE(n,e,t)<=0;Vb.exports=ME});var zb=L((iN,Xb)=>{var AE=Lb(),$E=Ab(),jE=jb(),WE=Hb(),HE=Kb(),UE=Bb(),KE=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return AE(n,t,r);case"!=":return $E(n,t,r);case">":return jE(n,t,r);case">=":return WE(n,t,r);case"<":return HE(n,t,r);case"<=":return UE(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Xb.exports=KE});var tC=L((sN,eC)=>{var sa=Symbol("SemVer ANY"),oa=class{static get ANY(){return sa}constructor(e,t){if(t=Gb(t),e instanceof oa){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Zd("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===sa?this.value="":this.value=this.operator+this.semver.version,Zd("comp",this)}parse(e){let t=this.options.loose?Qb[Yb.COMPARATORLOOSE]:Qb[Yb.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Jb(r[2],this.options.loose):this.semver=sa}toString(){return this.value}test(e){if(Zd("Comparator.test",e,this.options.loose),this.semver===sa||e===sa)return!0;if(typeof e=="string")try{e=new Jb(e,this.options)}catch{return!1}return Jd(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof oa))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Zb(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Zb(this.value,t).test(e.semver):(t=Gb(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Jd(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Jd(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};eC.exports=oa;var Gb=Zc(),{safeRe:Qb,t:Yb}=Jc(),Jd=zb(),Zd=ta(),Jb=na(),Zb=ef()});var ef=L((oN,sC)=>{var xs=class{constructor(e,t){if(t=BE(t),e instanceof xs)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new xs(e.raw,t);if(e instanceof tf)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(r=>this.parseRange(r)).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!rC(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&ZE(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&YE)|(this.options.loose&&JE))+":"+e,i=nC.get(r);if(i)return i;let s=this.options.loose,o=s?fn[Gt.HYPHENRANGELOOSE]:fn[Gt.HYPHENRANGE];e=e.replace(o,ux(this.options.includePrerelease)),ze("hyphen replace",e),e=e.replace(fn[Gt.COMPARATORTRIM],zE),ze("comparator trim",e),e=e.replace(fn[Gt.TILDETRIM],GE),ze("tilde trim",e),e=e.replace(fn[Gt.CARETTRIM],QE),ze("caret trim",e);let a=e.split(" ").map(h=>ex(h,this.options)).join(" ").split(/\s+/).map(h=>cx(h,this.options));s&&(a=a.filter(h=>(ze("loose invalid filter",h,this.options),!!h.match(fn[Gt.COMPARATORLOOSE])))),ze("range list",a);let c=new Map,u=a.map(h=>new tf(h,this.options));for(let h of u){if(rC(h))return[h];c.set(h.value,h)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return nC.set(r,l),l}intersects(e,t){if(!(e instanceof xs))throw new TypeError("a Range is required");return this.set.some(r=>iC(r,t)&&e.set.some(i=>iC(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new XE(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(lx(this.set[t],e,this.options))return!0;return!1}};sC.exports=xs;var VE=Ib(),nC=new VE({max:1e3}),BE=Zc(),tf=tC(),ze=ta(),XE=na(),{safeRe:fn,t:Gt,comparatorTrimReplace:zE,tildeTrimReplace:GE,caretTrimReplace:QE}=Jc(),{FLAG_INCLUDE_PRERELEASE:YE,FLAG_LOOSE:JE}=Qc(),rC=n=>n.value==="<0.0.0-0",ZE=n=>n.value==="",iC=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},ex=(n,e)=>(ze("comp",n,e),n=rx(n,e),ze("caret",n),n=tx(n,e),ze("tildes",n),n=sx(n,e),ze("xrange",n),n=ax(n,e),ze("stars",n),n),Qt=n=>!n||n.toLowerCase()==="x"||n==="*",tx=(n,e)=>n.trim().split(/\s+/).map(t=>nx(t,e)).join(" "),nx=(n,e)=>{let t=e.loose?fn[Gt.TILDELOOSE]:fn[Gt.TILDE];return n.replace(t,(r,i,s,o,a)=>{ze("tilde",n,r,i,s,o,a);let c;return Qt(i)?c="":Qt(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Qt(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(ze("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,ze("tilde return",c),c})},rx=(n,e)=>n.trim().split(/\s+/).map(t=>ix(t,e)).join(" "),ix=(n,e)=>{ze("caret",n,e);let t=e.loose?fn[Gt.CARETLOOSE]:fn[Gt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,c)=>{ze("caret",n,i,s,o,a,c);let u;return Qt(s)?u="":Qt(o)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:Qt(a)?s==="0"?u=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:c?(ze("replaceCaret pr",c),s==="0"?o==="0"?u=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(ze("no pr"),s==="0"?o==="0"?u=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),ze("caret return",u),u})},sx=(n,e)=>(ze("replaceXRanges",n,e),n.split(/\s+/).map(t=>ox(t,e)).join(" ")),ox=(n,e)=>{n=n.trim();let t=e.loose?fn[Gt.XRANGELOOSE]:fn[Gt.XRANGE];return n.replace(t,(r,i,s,o,a,c)=>{ze("xRange",n,r,i,s,o,a,c);let u=Qt(s),l=u||Qt(o),h=l||Qt(a),f=h;return i==="="&&f&&(i=""),c=e.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&f?(l&&(o=0),a=0,i===">"?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",l?s=+s+1:o=+o+1),i==="<"&&(c="-0"),r=`${i+s}.${o}.${a}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:h&&(r=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),ze("xRange return",r),r})},ax=(n,e)=>(ze("replaceStars",n,e),n.trim().replace(fn[Gt.STAR],"")),cx=(n,e)=>(ze("replaceGTE0",n,e),n.trim().replace(fn[e.includePrerelease?Gt.GTE0PRE:Gt.GTE0],"")),ux=n=>(e,t,r,i,s,o,a,c,u,l,h,f,C)=>(Qt(r)?t="":Qt(i)?t=`>=${r}.0.0${n?"-0":""}`:Qt(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Qt(u)?c="":Qt(l)?c=`<${+u+1}.0.0-0`:Qt(h)?c=`<${u}.${+l+1}.0-0`:f?c=`<=${u}.${l}.${h}-${f}`:n?c=`<${u}.${l}.${+h+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),lx=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(ze(n[r].semver),n[r].semver!==tf.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var aC=L((aN,oC)=>{var dx=ef(),fx=(n,e,t)=>{try{e=new dx(e,t)}catch{return!1}return e.test(n)};oC.exports=fx});var uC=L(Cn=>{"use strict";var hx=Cn&&Cn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),nf=Cn&&Cn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hx(e,n,t)};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.DiagnosticPullMode=Cn.vsdiag=void 0;nf(le(),Cn);nf(_e(),Cn);var cC=ud();Object.defineProperty(Cn,"vsdiag",{enumerable:!0,get:function(){return cC.vsdiag}});Object.defineProperty(Cn,"DiagnosticPullMode",{enumerable:!0,get:function(){return cC.DiagnosticPullMode}});nf(Xd(),Cn)});var lf=L(Yt=>{"use strict";var px=Yt&&Yt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),lC=Yt&&Yt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&px(e,n,t)};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.SettingMonitor=Yt.LanguageClient=Yt.TransportKind=void 0;var Mr=require("child_process"),rf=require("fs"),sf=require("path"),ui=require("vscode"),Ye=_n(),dC=Xd(),gx=ib(),st=zd(),mx=Cb(),vx=aC();lC(zd(),Yt);lC(uC(),Yt);var fC="^1.67.0",ct;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(ct=Yt.TransportKind||(Yt.TransportKind={}));var li;(function(n){function e(t){let r=t;return r&&r.kind===ct.socket&&Ye.number(r.port)}n.isSocket=e})(li||(li={}));var of;(function(n){function e(t){return Ye.string(t.command)}n.is=e})(of||(of={}));var af;(function(n){function e(t){return Ye.string(t.module)}n.is=e})(af||(af={}));var cf;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(cf||(cf={}));var uf;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(uf||(uf={}));var hC=class extends dC.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,c,u,l;Ye.string(t)?(o=e,a=t,c=r,u=i,l=!!s):(o=e.toLowerCase(),a=e,c=t,u=r,l=i),l===void 0&&(l=!1);super(o,a,u);this._serverOptions=c,this._forceDebug=l,this._isInDebugMode=l;try{this.checkVersion()}catch(h){throw Ye.string(h.message)&&this.outputChannel.appendLine(h.message),h}}checkVersion(){let e=mx(ui.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${ui.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!vx(e,fC))throw new Error(`The language client requires VS Code version ${fC} but received version ${ui.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,gx.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(l,h){if(!l&&!h)return;let f=Object.create(null);return Object.keys(process.env).forEach(C=>f[C]=process.env[C]),h&&(f.ELECTRON_RUN_AS_NODE="1",f.ELECTRON_NO_ASAR="1"),l&&Object.keys(l).forEach(C=>f[C]=l[C]),f}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let l=process.execArgv;return l?l.some(h=>r.some(f=>h.startsWith(f))||i.some(f=>h===f)):!1}function o(l){if(l.stdin===null||l.stdout===null||l.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Ye.func(a))return a().then(l=>{if(dC.MessageTransports.is(l))return this._isDetached=!!l.detached,l;if(cf.is(l))return this._isDetached=!!l.detached,{reader:new st.StreamMessageReader(l.reader),writer:new st.StreamMessageWriter(l.writer)};{let h;return uf.is(l)?(h=l.process,this._isDetached=l.detached):(h=l,this._isDetached=!1),h.stderr.on("data",f=>this.outputChannel.append(Ye.string(f)?f:f.toString(e))),{reader:new st.StreamMessageReader(h.stdout),writer:new st.StreamMessageWriter(h.stdin)}}});let c,u=a;return u.run||u.debug?this._forceDebug||s()?(c=u.debug,this._isInDebugMode=!0):(c=u.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(l=>{if(af.is(c)&&c.module){let h=c,f=h.transport||ct.stdio;if(h.runtime){let C=[],b=h.options??Object.create(null);b.execArgv&&b.execArgv.forEach(v=>C.push(v)),C.push(h.module),h.args&&h.args.forEach(v=>C.push(v));let y=Object.create(null);y.cwd=l,y.env=t(b.env,!1);let S=this._getRuntimePath(h.runtime,l),k;if(f===ct.ipc?(y.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):f===ct.stdio?C.push("--stdio"):f===ct.pipe?(k=(0,st.generateRandomPipeName)(),C.push(`--pipe=${k}`)):li.isSocket(f)&&C.push(`--socket=${f.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),f===ct.ipc||f===ct.stdio){let v=Mr.spawn(S,C,y);return!v||!v.pid?Fs(v,`Launching server using runtime ${S} failed.`):(this._serverProcess=v,v.stderr.on("data",D=>this.outputChannel.append(Ye.string(D)?D:D.toString(e))),f===ct.ipc?(v.stdout.on("data",D=>this.outputChannel.append(Ye.string(D)?D:D.toString(e))),Promise.resolve({reader:new st.IPCMessageReader(v),writer:new st.IPCMessageWriter(v)})):Promise.resolve({reader:new st.StreamMessageReader(v.stdout),writer:new st.StreamMessageWriter(v.stdin)}))}else{if(f===ct.pipe)return(0,st.createClientPipeTransport)(k).then(v=>{let D=Mr.spawn(S,C,y);return!D||!D.pid?Fs(D,`Launching server using runtime ${S} failed.`):(this._serverProcess=D,D.stderr.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),D.stdout.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),v.onConnected().then(R=>({reader:R[0],writer:R[1]})))});if(li.isSocket(f))return(0,st.createClientSocketTransport)(f.port).then(v=>{let D=Mr.spawn(S,C,y);return!D||!D.pid?Fs(D,`Launching server using runtime ${S} failed.`):(this._serverProcess=D,D.stderr.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),D.stdout.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),v.onConnected().then(R=>({reader:R[0],writer:R[1]})))})}}else{let C;return new Promise((b,y)=>{let S=(h.args&&h.args.slice())??[];f===ct.ipc?S.push("--node-ipc"):f===ct.stdio?S.push("--stdio"):f===ct.pipe?(C=(0,st.generateRandomPipeName)(),S.push(`--pipe=${C}`)):li.isSocket(f)&&S.push(`--socket=${f.port}`),S.push(`--clientProcessId=${process.pid.toString()}`);let k=h.options??Object.create(null);if(k.env=t(k.env,!0),k.execArgv=k.execArgv||[],k.cwd=l,k.silent=!0,f===ct.ipc||f===ct.stdio){let v=Mr.fork(h.module,S||[],k);o(v),this._serverProcess=v,v.stderr.on("data",D=>this.outputChannel.append(Ye.string(D)?D:D.toString(e))),f===ct.ipc?(v.stdout.on("data",D=>this.outputChannel.append(Ye.string(D)?D:D.toString(e))),b({reader:new st.IPCMessageReader(this._serverProcess),writer:new st.IPCMessageWriter(this._serverProcess)})):b({reader:new st.StreamMessageReader(v.stdout),writer:new st.StreamMessageWriter(v.stdin)})}else f===ct.pipe?(0,st.createClientPipeTransport)(C).then(v=>{let D=Mr.fork(h.module,S||[],k);o(D),this._serverProcess=D,D.stderr.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),D.stdout.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),v.onConnected().then(R=>{b({reader:R[0],writer:R[1]})},y)},y):li.isSocket(f)&&(0,st.createClientSocketTransport)(f.port).then(v=>{let D=Mr.fork(h.module,S||[],k);o(D),this._serverProcess=D,D.stderr.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),D.stdout.on("data",R=>this.outputChannel.append(Ye.string(R)?R:R.toString(e))),v.onConnected().then(R=>{b({reader:R[0],writer:R[1]})},y)},y)})}}else if(of.is(c)&&c.command){let h=c,f=c.args!==void 0?c.args.slice(0):[],C,b=c.transport;if(b===ct.stdio)f.push("--stdio");else if(b===ct.pipe)C=(0,st.generateRandomPipeName)(),f.push(`--pipe=${C}`);else if(li.isSocket(b))f.push(`--socket=${b.port}`);else if(b===ct.ipc)throw new Error("Transport kind ipc is not support for command executable");let y=Object.assign({},h.options);if(y.cwd=y.cwd||l,b===void 0||b===ct.stdio){let S=Mr.spawn(h.command,f,y);return!S||!S.pid?Fs(S,`Launching server using command ${h.command} failed.`):(S.stderr.on("data",k=>this.outputChannel.append(Ye.string(k)?k:k.toString(e))),this._serverProcess=S,this._isDetached=!!y.detached,Promise.resolve({reader:new st.StreamMessageReader(S.stdout),writer:new st.StreamMessageWriter(S.stdin)}))}else{if(b===ct.pipe)return(0,st.createClientPipeTransport)(C).then(S=>{let k=Mr.spawn(h.command,f,y);return!k||!k.pid?Fs(k,`Launching server using command ${h.command} failed.`):(this._serverProcess=k,this._isDetached=!!y.detached,k.stderr.on("data",v=>this.outputChannel.append(Ye.string(v)?v:v.toString(e))),k.stdout.on("data",v=>this.outputChannel.append(Ye.string(v)?v:v.toString(e))),S.onConnected().then(v=>({reader:v[0],writer:v[1]})))});if(li.isSocket(b))return(0,st.createClientSocketTransport)(b.port).then(S=>{let k=Mr.spawn(h.command,f,y);return!k||!k.pid?Fs(k,`Launching server using command ${h.command} failed.`):(this._serverProcess=k,this._isDetached=!!y.detached,k.stderr.on("data",v=>this.outputChannel.append(Ye.string(v)?v:v.toString(e))),k.stdout.on("data",v=>this.outputChannel.append(Ye.string(v)?v:v.toString(e))),S.onConnected().then(v=>({reader:v[0],writer:v[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(sf.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=sf.join(r,e);if(rf.existsSync(i))return i}if(t!==void 0){let i=sf.join(t,e);if(rf.existsSync(i))return i}return e}_mainGetRootPath(){let e=ui.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{rf.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};Yt.LanguageClient=hC;var pC=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return ui.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new ui.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?ui.workspace.getConfiguration(t).get(r,!1):ui.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};Yt.SettingMonitor=pC;function Fs(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var df=L((lN,gC)=>{"use strict";gC.exports=lf()});var Vx={};ZC(Vx,{activate:()=>Ux,deactivate:()=>Kx});var Os=z(require("vscode"));var Q=z(require("vscode")),Is=z(require("fs/promises")),IC=z(require("path"));var Pe=z(require("vscode")),tD={get lsp(){return{get serverPath(){return Pe.workspace.getConfiguration("swift.sourcekit-lsp").get("serverPath","")},get serverArguments(){return Pe.workspace.getConfiguration("swift.sourcekit-lsp").get("serverArguments",[])},get inlayHintsEnabled(){return Pe.workspace.getConfiguration("sourcekit-lsp").get("inlayHints.enabled",!0)},get supportCFamily(){return Pe.workspace.getConfiguration("sourcekit-lsp").get("support-c-cpp","cpptools-inactive")},get supportedLanguages(){return Pe.workspace.getConfiguration("swift.sourcekit-lsp").get("supported-languages",["swift","c","cpp","objective-c","objective-cpp"])},get disable(){return Pe.workspace.getConfiguration("swift.sourcekit-lsp").get("disable",!1)}}},folder(n){return{get testEnvironmentVariables(){return Pe.workspace.getConfiguration("swift",n).get("testEnvironmentVariables",{})},get autoGenerateLaunchConfigurations(){return Pe.workspace.getConfiguration("swift",n).get("autoGenerateLaunchConfigurations",!0)},get disableAutoResolve(){return Pe.workspace.getConfiguration("swift",n).get("disableAutoResolve",!1)},get searchSubfoldersForPackages(){return Pe.workspace.getConfiguration("swift",n).get("searchSubfoldersForPackages",!1)}}},get debugger(){return{get useDebugAdapterFromToolchain(){return Pe.workspace.getConfiguration("swift.debugger").get("useDebugAdapterFromToolchain",!1)},get debugAdapterPath(){return Pe.workspace.getConfiguration("swift.debugger").get("path","")}}},get excludePathsFromPackageDependencies(){return Pe.workspace.getConfiguration("swift").get("excludePathsFromPackageDependencies",[])},get path(){return Pe.workspace.getConfiguration("swift").get("path","")},get runtimePath(){return Pe.workspace.getConfiguration("swift").get("runtimePath","")},get sdk(){return Pe.workspace.getConfiguration("swift").get("SDK","")},set sdk(n){Pe.workspace.getConfiguration("swift").update("SDK",n)},get buildArguments(){return Pe.workspace.getConfiguration("swift").get("buildArguments",[])},get sanitizer(){return Pe.workspace.getConfiguration("swift").get("sanitizer","off")},get buildPath(){return Pe.workspace.getConfiguration("swift").get("buildPath","")},get swiftEnvironmentVariables(){return Pe.workspace.getConfiguration("swift").get("swiftEnvironmentVariables",{})},set swiftEnvironmentVariables(n){Pe.workspace.getConfiguration("swift").update("swiftEnvironmentVariables",n)},get problemMatchCompileErrors(){return Pe.workspace.getConfiguration("swift").get("problemMatchCompileErrors",!0)},get backgroundCompilation(){return Pe.workspace.getConfiguration("swift").get("backgroundCompilation",!1)},get actionAfterBuildError(){return Pe.workspace.getConfiguration("swift").get("actionAfterBuildError","Focus Terminal")},get diagnostics(){return Pe.workspace.getConfiguration("swift").get("diagnostics",!1)},get displayCoverageReportAfterRun(){return Pe.workspace.getConfiguration("swift").get("coverage.displayReportAfterRun",!0)},get alwaysShowCoverageStatusItem(){return Pe.workspace.getConfiguration("swift").get("coverage.alwaysShowStatusItem",!0)},get coverageHitColorLightMode(){return Pe.workspace.getConfiguration("swift").get("coverage.colors.lightMode.hit","#c0ffc0")},get coverageMissColorLightMode(){return Pe.workspace.getConfiguration("swift").get("coverage.colors.lightMode.miss","#ffc0c0")},get coverageHitColorDarkMode(){return Pe.workspace.getConfiguration("swift").get("coverage.colors.darkMode.hit","#003000")},get coverageMissColorDarkMode(){return Pe.workspace.getConfiguration("swift").get("coverage.colors.darkMode.miss","#400000")}},$=tD;var ge=z(require("vscode")),bf=z(require("path"));var Vp=z(require("vscode")),ns=z(require("path"));var pa=z(require("vscode"));var du=z(require("child_process")),If=z(require("fs/promises")),Ms=z(require("path"));function nn(n=process.env){if($.runtimePath==="")return;let e=$.runtimePath,t=As(),r=process.platform==="win32"?";":":";switch(n){case!1:return{[t]:e};case!0:return{[t]:`${e}${r}\${env:${t}}`};default:return n[t]?{[t]:`${e}${r}${n[t]}`}:{[t]:e}}}function As(){switch(process.platform){case"win32":return"Path";case"darwin":return"DYLD_LIBRARY_PATH";default:return"LD_LIBRARY_PATH"}}async function Kt(n,e,t={},r,i=!0){if(r==null||r.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,r.name),i){let s=nn(t.env);s&&Object.keys(s).length>0&&(t.env=ce(ce({},t.env??process.env),s))}return new Promise((s,o)=>du.execFile(n,e,t,(a,c,u)=>{a&&o({error:a,stdout:c,stderr:u}),s({stdout:c,stderr:u})}))}async function $s(n,e,t,r,i,s={},o,a=!0,c="SIGTERM"){if(o==null||o.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,o.name),a){let u=nn(s.env);u&&Object.keys(u).length>0&&(s.env=ce(ce({},s.env??process.env),u))}return new Promise((u,l)=>{var C,b;let h,f=du.execFile(n,e,s,y=>{y?l({error:y}):u(),h&&h.dispose()});t&&((C=f.stdout)==null||C.pipe(t)),r&&((b=f.stderr)==null||b.pipe(r)),i&&(h=i.onCancellationRequested(()=>{f.kill(c)}))})}async function Xr(n,e,t={},r){let i;return e==="default"?i=rD():i=e.getToolchainExecutable("swift"),e!=="default"&&(n=e.buildFlags.withSwiftSDKFlags(n)),Object.keys($.swiftEnvironmentVariables).length>0&&(t.env=ce(ce({},t.env??process.env),$.swiftEnvironmentVariables)),await Kt(i,n,t,r)}async function Of(n,e){for(;!n();)await nD(e)}function nD(n){return new Promise(e=>setTimeout(e,n))}function rD(n="swift"){let e=process.platform==="win32"?".exe":"";return Ms.join($.path,`${n}${e}`)}async function zr(...n){try{return await If.access(Ms.join(...n)),!0}catch{return!1}}function kn(n,e){let t=Ms.relative(e,n);return t[0]!=="."||t[1]!=="."}function fu(n=8){return Math.random().toString(16).substring(2,n)}function mn(n){return n.stderr?n.stderr:n.error?JSON.stringify(n.error):n instanceof Error?n.message:JSON.stringify(n)}function Nf(n){return n.length===1?n[0]:[n.slice(0,-1).join(", "),n[n.length-1]].join(" and ")}function qf(n,e=0){let t=3735928559^e,r=1103547991^e;for(let i=0,s;i<n.length;i++)s=n.charCodeAt(i),t=Math.imul(t^s,2654435761),r=Math.imul(r^s,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}var js=class{constructor(e,t){this.exists=t;this.fileWatcher=pa.workspace.createFileSystemWatcher(new pa.RelativePattern(e,"Tests/LinuxMain.swift"),!1,!0),this.fileWatcher.onDidCreate(()=>this.exists=!0),this.fileWatcher.onDidDelete(()=>this.exists=!1)}static async create(e){let t=await zr(e.fsPath,"Tests","LinuxMain.swift");return new js(e,t)}dispose(){var e;(e=this.fileWatcher)==null||e.dispose()}};var Hi=z(require("vscode"));var hu=class{constructor(e,t){this.folderContext=e;this.workspaceContext=t}install(){this.packageFileWatcher=this.createPackageFileWatcher(),this.resolvedFileWatcher=this.createResolvedFileWatcher()}dispose(){var e,t;(e=this.packageFileWatcher)==null||e.dispose(),(t=this.resolvedFileWatcher)==null||t.dispose()}createPackageFileWatcher(){let e=Hi.workspace.createFileSystemWatcher(new Hi.RelativePattern(this.folderContext.folder,"Package.swift"));return e.onDidCreate(async()=>await this.handlePackageSwiftChange()),e.onDidChange(async()=>await this.handlePackageSwiftChange()),e.onDidDelete(async()=>await this.handlePackageSwiftChange()),e}createResolvedFileWatcher(){let e=Hi.workspace.createFileSystemWatcher(new Hi.RelativePattern(this.folderContext.folder,"Package.resolved"));return e.onDidCreate(async()=>await this.handlePackageResolvedChange()),e.onDidChange(async()=>await this.handlePackageResolvedChange()),e.onDidDelete(async()=>await this.handlePackageResolvedChange()),e}async handlePackageSwiftChange(){await this.folderContext.reload(),this.workspaceContext.fireEvent(this.folderContext,we.packageUpdated)}async handlePackageResolvedChange(){var t,r;let e=(t=this.folderContext.swiftPackage.resolved)==null?void 0:t.fileHash;await this.folderContext.reloadPackageResolved(),((r=this.folderContext.swiftPackage.resolved)==null?void 0:r.fileHash)!==e&&this.workspaceContext.fireEvent(this.folderContext,we.resolvedUpdated)}};var Ra=z(require("vscode")),qu=z(require("fs/promises")),Pa=z(require("path"));var ka=z(require("path"));var Sa=z(require("fs/promises")),ft=z(require("path")),Sp=z(Dp()),Nu=z(require("vscode"));var He=class{constructor(e,t,r){this.major=e;this.minor=t;this.patch=r}static fromString(e){let t=e.match(/(\d+).(\d+)(?:.(\d+))?/);if(t){let r=parseInt(t[1]),i=parseInt(t[2]);if(t[3]===void 0)return new He(r,i,0);{let s=parseInt(t[3]);return new He(r,i,s)}}}toString(){return`${this.major}.${this.minor}.${this.patch}`}isLessThan(e){return this.major<e.major?!0:this.major>e.major?!1:this.minor<e.minor?!0:this.minor>e.minor?!1:this.patch<e.patch}isGreaterThan(e){return this.major>e.major?!0:this.major<e.major?!1:this.minor>e.minor?!0:this.minor<e.minor?!1:this.patch>e.patch}isLessThanOrEqual(e){return!this.isGreaterThan(e)}isGreaterThanOrEqual(e){return!this.isLessThan(e)}};var Tp=z(require("path")),lo=class{constructor(e,t){this.type=e;this.toolchain=t}static create(e,t){if(e==="thread"||e==="address")return new lo(e,t)}get runtimeEnvironment(){if(!this.toolchain.toolchainPath)return;let e=`/lib/swift/clang/lib/darwin/libclang_rt.${this.clangName}_osx_dynamic.dylib`;return{DYLD_INSERT_LIBRARIES:Tp.join(this.toolchain.toolchainPath,e)}}get buildFlags(){return[`--sanitize=${this.type}`]}get clangName(){switch(this.type){case"address":return"asan";case"thread":return"tsan"}}};var An=(i=>(i.iOS="iOS",i.tvOS="tvOS",i.watchOS="watchOS",i.visionOS="xrOS",i))(An||{});function MD(n){switch(n){case"iOS":return"iphoneos";case"tvOS":return"appletvos";case"watchOS":return"watchos";case"xrOS":return"xros"}}function kp(n){switch(n){case"iOS":return"arm64-apple-ios";case"tvOS":return"arm64-apple-tvos";case"watchOS":return"arm64-apple-watchos";case"xrOS":return"arm64-apple-xros"}}var Tr=class{constructor(e,t,r,i,s,o,a,c,u){this.swiftFolderPath=e;this.toolchainPath=t;this.swiftVersionString=r;this.swiftVersion=i;this.runtimePath=s;this.defaultTarget=o;this.defaultSDK=a;this.customSDK=c;this.xcTestPath=u}static async create(){var u;let e=await this.getSwiftFolderPath(),t=await this.getToolchainPath(e),r=await this.getSwiftTargetInfo(),i=await this.getSwiftVersion(r),s=await this.getRuntimePath(r),o=await this.getDefaultSDK(),a=this.getCustomSDK(),c=await this.getXCTestPath(r,i,s,a??o);return new Tr(e,t,r.compilerVersion,i,s,(u=r.target)==null?void 0:u.triple,o,a,c)}get buildFlags(){return new St(this)}sanitizer(e){return lo.create(e,this)}static async getXcodeDeveloperDir(e){let{stdout:t}=await Kt("xcode-select",["-p"],{env:e});return t.trimEnd()}static async getSDKForTarget(e){return await this.getSDKPath(MD(e))}static async getSDKPath(e){let{stdout:t}=await Kt("xcrun",["--sdk",e,"--show-sdk-path"],{env:ce(ce({},process.env),$.swiftEnvironmentVariables)});return ft.join(t.trimEnd())}static async getXcodeInstalls(){let{stdout:e}=await Kt("mdfind",["kMDItemCFBundleIdentifier == 'com.apple.dt.Xcode'"]);return e.trimEnd().split(`
`)}getToolchainExecutable(e){let t=process.platform==="win32"?".exe":"";return`${this.toolchainPath}/bin/${e}${t}`}logDiagnostics(e){e.logDiagnostic(`Swift Path: ${this.swiftFolderPath}`),e.logDiagnostic(`Toolchain Path: ${this.toolchainPath}`),this.runtimePath&&e.logDiagnostic(`Runtime Library Path: ${this.runtimePath}`),this.defaultTarget&&e.logDiagnostic(`Default Target: ${this.defaultTarget}`),this.defaultSDK&&e.logDiagnostic(`Default SDK: ${this.defaultSDK}`),this.customSDK&&e.logDiagnostic(`Custom SDK: ${this.customSDK}`),this.xcTestPath&&e.logDiagnostic(`XCTest Path: ${this.xcTestPath}`)}static async getSwiftFolderPath(){try{let e;if($.path!==""){let i=process.platform==="win32"?".exe":"";e=ft.join($.path,`swift${i}`)}else switch(process.platform){case"darwin":{let{stdout:i}=await Kt("which",["swift"]);e=i.trimEnd();break}case"win32":{let{stdout:i}=await Kt("where",["swift"]);e=i.trimEnd();break}default:{let{stdout:i}=await Kt("/bin/sh",["-c","LC_MESSAGES=C type swift"]),s=/^swift is (.*)$/.exec(i.trimEnd());if(s)e=s[1];else throw Error("Failed to find swift executable");break}}let t=await Sa.realpath(e),r=ft.dirname(t);return await this.getSwiftEnvPath(r)}catch{throw Error("Failed to find swift executable")}}static async getSwiftEnvPath(e){if(process.platform==="linux"&&e.endsWith(".swiftenv/shims"))try{let t=ft.dirname(e),r=ft.join(t,"libexec","swiftenv"),{stdout:i}=await Kt(r,["which","swift"]),s=i.trimEnd();return ft.dirname(s)}catch{return e}else return e}static async getToolchainPath(e){try{switch(process.platform){case"darwin":{if($.path!=="")return ft.dirname($.path);let{stdout:t}=await Kt("xcrun",["--find","swift"],{env:$.swiftEnvironmentVariables}),r=t.trimEnd();return ft.dirname(ft.dirname(r))}default:return ft.dirname(e)}}catch{throw Error("Failed to find swift toolchain")}}static async getRuntimePath(e){if($.runtimePath!=="")return $.runtimePath;if(process.platform==="win32"){let{stdout:t}=await Kt("where",["swiftCore.dll"]),r=t.trimEnd();return r.length>0?ft.dirname(r):void 0}else return e.paths.runtimeLibraryPaths.length>0?e.paths.runtimeLibraryPaths.join(":"):void 0}static async getDefaultSDK(){switch(process.platform){case"darwin":return process.env.SDKROOT?process.env.SDKROOT:this.getSDKPath("macosx");case"win32":return process.env.SDKROOT}}static getCustomSDK(){return $.sdk!==""?$.sdk:void 0}static async getXCTestPath(e,t,r,i){var s;switch(process.platform){case"darwin":{let o=await this.getXcodeDeveloperDir($.swiftEnvironmentVariables);return ft.join(o,"usr","bin")}case"win32":{let o=r!==void 0&&await zr(ft.join(r,"XCTest.dll"))?r:void 0;if(!i)return o;let a=ft.dirname(ft.dirname(ft.dirname(i))),c=ft.join(a,"Info.plist");if(await zr(c)!==!0){if(o)return o;Nu.window.showWarningMessage("XCTest not found due to non-standardized library layout. Tests explorer won't work as expected.");return}let u=await Sa.readFile(c,"utf8"),l;try{l=Sp.parse(u)}catch(f){Nu.window.showWarningMessage(`Unable to parse ${c}: ${f}`);return}let h=l.DefaultProperties.XCTEST_VERSION;if(!h)throw Error("Info.plist is missing the XCTEST_VERSION key.");if(t.isGreaterThanOrEqual(new He(5,7,0))){let f,C=(s=e.target)==null?void 0:s.triple.split("-",1)[0];switch(C){case"x86_64":f="bin64";break;case"i686":f="bin32";break;case"aarch64":f="bin64a";break;default:throw Error(`unsupported architecture ${C}`)}return ft.join(a,"Developer","Library",`XCTest-${h}`,"usr",f)}else return ft.join(a,"Developer","Library",`XCTest-${h}`,"usr","bin")}}}static async getSwiftTargetInfo(){try{try{let{stdout:t}=await Xr(["-print-target-info"],"default"),r=JSON.parse(t.trimEnd());if(r.compilerVersion)return r}catch{}let{stdout:e}=await Xr(["--version"],"default");return{compilerVersion:e.split(`
`,1)[0],paths:{runtimeLibraryPaths:[""]}}}catch{throw Error("Failed to get swift version from either '-print-target-info' or '--version'.")}}static getSwiftVersion(e){let t=e.compilerVersion.match(/Swift version ([\S]+)/),r;return t&&(r=He.fromString(t[1])),r??new He(0,0,0)}};var St=class{constructor(e){this.toolchain=e}withSwiftSDKFlags(e){switch(e[0]){case"package":{let t=e.splice(0,2).concat(this.buildPathFlags());switch(t[1]){case"dump-symbol-graph":case"diagnose-api-breaking-changes":case"resolve":return[...t,...this.swiftpmSDKFlags(),...e];default:return t.concat(e)}}case"build":case"run":case"test":return[...e.splice(0,1).concat(this.buildPathFlags()),...this.swiftpmSDKFlags(),...e];default:return e}}swiftpmSDKFlags(){return $.sdk!==""?["--sdk",$.sdk,...this.swiftDriverTargetFlags(!0)]:[]}buildPathFlags(){return $.buildPath&&$.buildPath.length>0?this.toolchain.swiftVersion.isLessThan(new He(5,8,0))?["--build-path",$.buildPath]:["--scratch-path",$.buildPath]:[]}static buildDirectoryFromWorkspacePath(e,t=!1){let r=$.buildPath.length>0?$.buildPath:".build";return!ka.isAbsolute(r)&&t?ka.join(e,r):r}swiftDriverSDKFlags(e=!1){if($.sdk==="")return[];let t=["-sdk",$.sdk];return e?t.flatMap(r=>["-Xswiftc",r]):t}getDarwinTarget(){let e=[{name:"iPhoneOS",target:An.iOS},{name:"AppleTVOS",target:An.tvOS},{name:"WatchOS",target:An.watchOS},{name:"XROS",target:An.visionOS}];if($.sdk===""||process.platform!=="darwin")return;let t=$.sdk.split("/"),r=t[t.length-1];for(let i of e)if(r.includes(i.name)){let s=r.substring(i.name.length,r.length-4);return Sn(ce({},i),{version:s})}}swiftDriverTargetFlags(e=!1){let t=this.getDarwinTarget();if(!t)return[];let r=["-target",`${kp(t.target)}${t.version}`];return e?r.flatMap(i=>["-Xswiftc",i]):r}static filterArguments(e,t){let r=[],i=0;for(let s of e){if(i>0){r.push(s),i-=1;continue}let o=t.find(c=>c.argument===s);if(o){r.push(s),i=o.include;continue}t.find(c=>c.include===1&&s.startsWith(c.argument+"="))&&r.push(s)}return r}};var Rp=class{constructor(e){let t=JSON.parse(e),r=t;if(this.version=r.version,this.fileHash=qf(e),this.version===1){let i=t;this.pins=i.object.pins.map(s=>new Lu(this.identity(s.repositoryURL),s.repositoryURL,s.state))}else if(this.version===2){let i=t;this.pins=i.pins.map(s=>new Lu(s.identity,s.location,s.state))}else throw Error("Unsupported Package.resolved version")}identity(e){return Pa.basename(e,".git").toLowerCase()}},Lu=class{constructor(e,t,r){this.identity=e;this.location=t;this.state=r}};function AD(n){return n.products!==void 0}function $D(n){return n instanceof Error}var Pn=class{constructor(e,t,r){this.folder=e;this.contents=t;this.resolved=r;this.plugins=[]}static async create(e,t){let r=await Pn.loadPackage(e,t),i=await Pn.loadPackageResolved(e);return new Pn(e,r,i)}static async loadPackage(e,t){try{let{stdout:r}=await Xr(["package","describe","--type","json"],t,{cwd:e.fsPath});for(;!r.startsWith("{");){let i=r.indexOf(`
`);r=r.slice(i+1)}return JSON.parse(r)}catch(r){let i=r;return i.stderr!==void 0&&(i.stderr.startsWith("error: root manifest")||i.stderr.startsWith("error: Could not find Package.swift"))?void 0:Error(mn(r))}}static async loadPackageResolved(e){try{let t=Ra.Uri.joinPath(e,"Package.resolved"),r=await qu.readFile(t.fsPath,"utf8");return new Rp(r)}catch{return}}static async loadPlugins(e,t){try{let{stdout:r}=await Xr(["package","plugin","--list"],t,{cwd:e.fsPath}),i=[],s=r.split(`
`).map(o=>o.trim());for(let o of s){let a=/^(.*) \(plugin (.*) in package (.*)\)/.exec(o);a&&i.push({command:a[1],name:a[2],package:a[3]})}return i}catch{return[]}}async loadWorkspaceState(){try{let e=Ra.Uri.joinPath(Ra.Uri.file(St.buildDirectoryFromWorkspacePath(this.folder.fsPath,!0)),"workspace-state.json"),t=await qu.readFile(e.fsPath,"utf8");return JSON.parse(t)}catch{return}}async reload(e){this.contents=await Pn.loadPackage(this.folder,e)}async reloadPackageResolved(){this.resolved=await Pn.loadPackageResolved(this.folder)}get isValid(){return AD(this.contents)}get error(){if($D(this.contents))return this.contents}get foundPackage(){return this.contents!==void 0}get name(){var e;return((e=this.contents)==null?void 0:e.name)??""}get products(){var e;return((e=this.contents)==null?void 0:e.products)??[]}get dependencies(){var e;return((e=this.contents)==null?void 0:e.dependencies)??[]}get targets(){var e;return((e=this.contents)==null?void 0:e.targets)??[]}get executableProducts(){return this.products.filter(e=>e.type.executable!==void 0)}get libraryProducts(){return this.products.filter(e=>e.type.library!==void 0)}getTargets(e){return this.targets.filter(t=>t.type===e)}getTarget(e){let t=Pa.relative(this.folder.fsPath,e);return this.targets.find(r=>kn(t,r.path))}};var Na=z(require("vscode"));var ht=z(require("vscode")),Ia=z(require("path")),Wu=z(require("stream"));var Ep=z(require("os")),sr=z(require("path")),$n=z(require("vscode"));var Pp=z(require("vscode")),_p=z(require("fs"));var yi=z(require("vscode")),jD={set hasPackage(n){yi.commands.executeCommand("setContext","swift.hasPackage",n)},set packageHasDependencies(n){yi.commands.executeCommand("setContext","swift.packageHasDependencies",n)},set packageHasPlugins(n){yi.commands.executeCommand("setContext","swift.packageHasPlugins",n)},set currentTargetType(n){yi.commands.executeCommand("setContext","swift.currentTargetType",n??"none")},set fileIsSnippet(n){yi.commands.executeCommand("setContext","swift.fileIsSnippet",n)},set lldbVSCodeAvailable(n){yi.commands.executeCommand("setContext","swift.lldbVSCodeAvailable",n)}},kt=jD;var an=class{static get adapterName(){return $.debugger.useDebugAdapterFromToolchain&&this.debugAdapaterExists?"swift-lldb":"lldb"}static async verifyDebugAdapterExists(e,t=!1){let r=$.debugger.debugAdapterPath.length>0,i=r?$.debugger.debugAdapterPath:e.toolchain.getToolchainExecutable("lldb-vscode");return await this.doesFileExist(i)?(this.debugAdapaterExists=!0,kt.lldbVSCodeAvailable=!0,!0):(t||Pp.window.showInformationMessage(r?"Cannot find lldb-vscode debug adapter specified in setting Swift.Debugger.Path.":"Cannot find lldb-vscode debug adapter in your Swift toolchain."),e.outputChannel.log(`Failed to find ${i}`),this.debugAdapaterExists=!1,kt.lldbVSCodeAvailable=!1,!1)}static async doesFileExist(e){try{return(await _p.promises.stat(e)).isFile()}catch{return!1}}};an.debugAdapaterExists=!1;async function wi(n,e,t=!1){if(!$.folder(n.workspaceFolder).autoGenerateLaunchConfigurations)return;let r=$n.workspace.getConfiguration("launch",n.folder),i=r.get("configurations")||[],s=["program","cwd","preLaunchTask","type",`env.${As()}`],o=[],a=WD(n),c=!1;for(let u of a){let l=i.findIndex(h=>h.name===u.name);if(l!==-1){let h=JSON.parse(JSON.stringify(i[l]));HD(h,u,s),JSON.stringify(i[l])!==JSON.stringify(h)&&o.push({index:l,config:h})}else i.push(u),c=!0}if(o.length>0){if(!t){let u=Nf(o.map(f=>f.config.name)),l=e??`The Swift extension would like to update launch configurations '${u}'.`;await $n.window.showWarningMessage(`${n.name}: ${l} Do you want to update?`,"Update","Cancel")==="Update"&&(t=!0)}t&&(o.forEach(u=>i[u.index]=u.config),c=!0)}c&&await r.update("configurations",i,$n.ConfigurationTarget.WorkspaceFolder)}function xp(n,e){let r=$n.workspace.getConfiguration("launch",e.folder).get("configurations")||[],{folder:i}=fo(e),s=St.buildDirectoryFromWorkspacePath(i,!0);return r.find(o=>o.program===sr.join(s,"debug",n))}function WD(n){let e=n.swiftPackage.executableProducts,{folder:t,nameSuffix:r}=fo(n),i=St.buildDirectoryFromWorkspacePath(t,!0),s=process.platform==="win32"?".exe":"";return e.flatMap(o=>{let a={type:an.adapterName,request:"launch",sourceLanguages:["swift"],args:[],cwd:t,env:nn(!0)};return[Sn(ce({},a),{name:`Debug ${o.name}${r}`,program:sr.join(i,"debug",o.name+s),preLaunchTask:`swift: Build Debug ${o.name}${r}`}),Sn(ce({},a),{name:`Release ${o.name}${r}`,program:sr.join(i,"release",o.name+s),preLaunchTask:`swift: Build Release ${o.name}${r}`})]})}function Fp(n,e){let{folder:t}=fo(e),r=St.buildDirectoryFromWorkspacePath(t,!0);return{type:an.adapterName,request:"launch",sourceLanguages:["swift"],name:`Run ${n}`,program:sr.join(r,"debug",n),args:[],cwd:t,env:nn(!0)}}function Mu(n,e=!1){var a;if(n.swiftPackage.getTargets("test").length===0)return null;let t=ce(ce({},nn()),$.folder(n.workspaceFolder).testEnvironmentVariables),{folder:r,nameSuffix:i}=fo(n,e),s=St.buildDirectoryFromWorkspacePath(r,!0),o={type:an.adapterName,request:"launch",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,cwd:r,preLaunchTask:`swift: Build All${i}`};if(process.platform==="darwin"){let c=n.workspaceContext.toolchain.xcTestPath;if(c===void 0)return null;let u=n.workspaceContext.toolchain.sanitizer($.sanitizer);return Sn(ce({},o),{program:sr.join(c,"xctest"),args:[sr.join(s,"debug",n.swiftPackage.name+"PackageTests.xctest")],env:ce(ce({},t),u==null?void 0:u.runtimeEnvironment)})}else if(process.platform==="win32"){let c=n.workspaceContext.toolchain.runtimePath,u=n.workspaceContext.toolchain.xcTestPath;if(u===void 0)return null;u!==c&&(t.Path=`${u};${t.Path??process.env.Path}`);let l=$.sdk===""?process.env.SDKROOT:$.sdk;if(l===void 0)return null;let h;return($.debugger.useDebugAdapterFromToolchain||((a=$n.workspace.getConfiguration("lldb"))==null?void 0:a.get("library")))&&(h=[`settings set target.sdk-path ${l}`]),Sn(ce({},o),{program:sr.join(s,"debug",n.swiftPackage.name+"PackageTests.xctest"),env:t,preRunCommands:h})}else return Sn(ce({},o),{program:sr.join(s,"debug",n.swiftPackage.name+"PackageTests.xctest"),env:t})}function Ip(n,e){if(n.swiftPackage.getTargets("test").length===0||process.platform!=="darwin")return null;let{folder:t,nameSuffix:r}=fo(n,!0),i=St.buildDirectoryFromWorkspacePath(t,!0),s=n.workspaceContext.toolchain.xcTestPath;if(s===void 0)return null;let o;switch(Ep.arch()){case"x64":o="x86_64";break;case"arm64":o="arm64e";break;default:return null}let a=n.workspaceContext.toolchain.sanitizer($.sanitizer),c=Object.entries(ce(ce(ce({},nn()),$.folder(n.workspaceFolder).testEnvironmentVariables),a==null?void 0:a.runtimeEnvironment)).map(([u,l])=>`settings set target.env-vars ${u}="${l}"`);return{type:an.adapterName,request:"custom",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,targetCreateCommands:[`file -a ${o} ${s}/xctest`],processCreateCommands:[...c,`process launch -w ${t} -- ${e} ${i}/debug/${n.swiftPackage.name}PackageTests.xctest`],preLaunchTask:`swift: Build All${r}`}}async function _a(n,e,t={}){return new Promise((r,i)=>{$n.debug.startDebugging(n,e,t).then(s=>{if(s){let o=$n.debug.onDidTerminateDebugSession(async()=>{o.dispose(),r()})}},s=>{i(s)})})}function HD(n,e,t){t.forEach(r=>{if(r.includes(".")){let[i,s]=r.split(".",2);if(n[i]===void 0)n[i]=e[i];else if(e[i]===void 0){let o=Object.keys(n[i]);o.length===1&&o[0]===s?n[i]=void 0:n[i][s]=void 0}else n[i][s]=e[i][s]}else n[r]=e[r]})}function fo(n,e=!1){let t=e?n.workspaceFolder.uri.fsPath:`\${workspaceFolder:${n.workspaceFolder.name}}`,r,i;return n.relativePath.length===0?(r=t,i=""):(r=sr.join(t,n.relativePath),i=` (${n.relativePath})`),{folder:r,nameSuffix:i}}var Be=z(require("vscode")),Ea=z(require("path"));function KD(n){if(n.workspaceContext.swiftVersion.isLessThan(new He(5,1,0)))return[];if(process.platform!=="darwin"){let e=n.linuxMain.exists,t=n.workspaceContext.swiftVersion.isGreaterThanOrEqual(new He(5,4,0));if(e||!t)return["--enable-test-discovery"]}return[]}function VD(n){return process.platform==="win32"?n.swiftVersion.isGreaterThanOrEqual(new He(5,9,0))?["-Xlinker","-debug:dwarf"]:["-Xswiftc","-g","-Xswiftc","-use-ld=lld","-Xlinker","-debug:dwarf"]:[]}function xa(n,e=!0){let t=[];e&&t.push(...VD(n));let r=n.sanitizer($.sanitizer);return r&&t.push(...r.buildFlags),t.push(...$.buildArguments),t}function Au(){return $.actionAfterBuildError==="Focus Terminal"?Be.TaskRevealKind.Silent:Be.TaskRevealKind.Never}function BD(n){let e=xa(n.workspaceContext.toolchain);n.swiftPackage.getTargets("test").length>0&&e.push(...KD(n));let t=un.buildAllName;return n.relativePath.length>0&&(t+=` (${n.relativePath})`),n.workspaceContext.toolchain.buildFlags.getDarwinTarget()===void 0&&(e=["--build-tests",...e]),cn(["build",...e],t,{group:Be.TaskGroup.Build,cwd:n.folder,scope:n.workspaceFolder,presentationOptions:{reveal:Au()},problemMatcher:$.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},n.workspaceContext.toolchain)}async function Zi(n){let e=un.buildAllName;n.relativePath.length>0&&(e+=` (${n.relativePath})`);let t=n.workspaceFolder.uri.fsPath,r=(await Be.tasks.fetchTasks()).filter(o=>{if(o.source!=="Workspace"||o.scope!==n.workspaceFolder)return!1;let a=o.execution.options,c=o.execution.options,u=(a==null?void 0:a.cwd)??(c==null?void 0:c.cwd);return(u==="${workspaceFolder}"||u===void 0)&&(u=t),u===n.folder.fsPath}),i=r.find(o=>{var a,c;return((a=o.group)==null?void 0:a.id)===Be.TaskGroup.Build.id&&((c=o.group)==null?void 0:c.isDefault)===!0});if(i||(i=r.find(o=>o.name===`swift: ${e}`),i))return i;if(i=(await Be.tasks.fetchTasks({type:"swift"})).find(o=>{var a;return o.name===e&&((a=o.execution.options)==null?void 0:a.cwd)===n.folder.fsPath&&o.source==="swift"}),!i)throw Error("Build All Task does not exist");return i}function XD(n,e){let t=e.workspaceContext.toolchain,r="";return e.relativePath.length>0&&(r=` (${e.relativePath})`),[cn(["build","--product",n.name,...xa(t)],`Build Debug ${n.name}${r}`,{group:Be.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Au()},problemMatcher:$.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},e.workspaceContext.toolchain),cn(["build","-c","release","--product",n.name,...$.buildArguments],`Build Release ${n.name}${r}`,{group:Be.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Au()},problemMatcher:$.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},e.workspaceContext.toolchain)]}function cn(n,e,t,r){let i=r.getToolchainExecutable("swift");n=r.buildFlags.withSwiftSDKFlags(n);let s=t.cwd.fsPath,o=t.cwd.fsPath,a=new Be.Task({type:"swift",args:n,cwd:s,disableTaskQueue:t.disableTaskQueue},(t==null?void 0:t.scope)??Be.TaskScope.Workspace,e,"swift",new Be.ProcessExecution(i,n,{cwd:o,env:ce(ce({},$.swiftEnvironmentVariables),nn())}),t==null?void 0:t.problemMatcher),c;return(t==null?void 0:t.prefix)?c=`(${t.prefix}) `:c="",a.detail=`${c}swift ${n.join(" ")}`,a.group=t==null?void 0:t.group,a.presentationOptions=(t==null?void 0:t.presentationOptions)??{},a}var un=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let r of this.workspaceContext.folders){if(!r.swiftPackage.foundPackage)continue;let i=r.taskQueue.activeOperation;if(i&&!i.operation.isBuildOperation){let o=new Be.Task({type:"swift",args:[]},r.workspaceFolder,"Build tasks disabled","swift",new Be.CustomExecution(()=>{throw Error("Task disabled.")}));o.group=Be.TaskGroup.Build,o.detail=`While ${i.operation.name} is running.`,o.presentationOptions={reveal:Be.TaskRevealKind.Never,echo:!1},t.push(o);continue}t.push(BD(r));let s=r.swiftPackage.executableProducts;for(let o of s)t.push(...XD(o,r))}return t}resolveTask(e,t){let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=e.scope,s=e.definition.cwd;!Ea.isAbsolute(s)&&i.uri.fsPath&&(s=Ea.join(i.uri.fsPath,s));let o=new Be.Task(e.definition,e.scope??Be.TaskScope.Workspace,e.name??"Swift Custom Task","swift",new Be.ProcessExecution(r,e.definition.args,{cwd:s,env:ce(ce({},$.swiftEnvironmentVariables),nn())}),e.problemMatchers);return o.detail=e.detail??`swift ${e.definition.args.join(" ")}`,o.group=e.group,o.presentationOptions=e.presentationOptions,o}};un.buildAllName="Build All",un.cleanBuildName="Clean Build",un.resolvePackageName="Resolve Package Dependencies",un.updatePackageName="Update Package Dependencies";var $u=class{parseResultDarwin(e,t){let r=e.split(`
`);t.excess&&(r[0]=t.excess+r[0]),e[e.length-1]!==`
`?t.excess=r.pop():t.excess=void 0;for(let i of r){let s=/^Test Case '-\[(\S+)\s(.*)\]' started./.exec(i);if(s){let C=`${s[1]}/${s[2]}`;this.startTest(t.getTestItemIndexDarwin(C),t);continue}let o=/^Test Case '-\[(\S+)\s(.*)\]' passed \((\d.*) seconds\)/.exec(i);if(o){let C=`${o[1]}/${o[2]}`,b=+o[3];this.passTest(t.getTestItemIndexDarwin(C),b,t);continue}let a=/^Test Case '-\[(\S+)\s(.*)\]' failed \((\d.*) seconds\)/.exec(i);if(a){let C=`${a[1]}/${a[2]}`,b=+a[3];this.failTest(t.getTestItemIndexDarwin(C),b,t);continue}let c=/^(.+):(\d+):\serror:\s-\[(\S+)\s(.*)\] : (.*)$/.exec(i);if(c){let C=`${c[3]}/${c[4]}`;this.startErrorMessage(t.getTestItemIndexDarwin(C),c[5],c[1],c[2],t);continue}let u=/^(.+):(\d+):\s-\[(\S+)\s(.*)\] : Test skipped/.exec(i);if(u){let C=`${u[3]}/${u[4]}`;this.skipTest(t.getTestItemIndexDarwin(C),t);continue}let l=/^Test Suite '(.*)' started/.exec(i);if(l){this.startTestSuite(l[1],t);continue}let h=/^Test Suite '(.*)' passed/.exec(i);if(h){this.passTestSuite(h[1],t);continue}let f=/^Test Suite '(.*)' failed/.exec(i);if(f){this.failTestSuite(f[1],t);continue}this.continueErrorMessage(i,t)}}parseResultNonDarwin(e,t){let r=e.split(`
`);t.excess&&(r[0]=t.excess+r[0]),e[e.length-1]!==`
`?t.excess=r.pop():t.excess=void 0;for(let i of r){let s=/^Test Case '(.*)\.(.*)' started/.exec(i);if(s){let f=`${s[1]}/${s[2]}`,C=t.getTestItemIndexNonDarwin(f,void 0);this.startTest(C,t);continue}let o=/^Test Case '(.*)\.(.*)' failed \((\d.*) seconds\)/.exec(i);if(o){let f=`${o[1]}/${o[2]}`,C=t.getTestItemIndexNonDarwin(f,void 0);this.failTest(C,+o[3],t);continue}let a=/^(.+):(\d+):\serror:\s*(.*)\.(.*) : (.*)/.exec(i);if(a){let f=`${a[3]}/${a[4]}`,C=t.getTestItemIndexNonDarwin(f,a[1]);this.startErrorMessage(C,a[5],a[1],a[2],t);continue}let c=/^(.+):(\d+):\s*(.*)\.(.*) : Test skipped/.exec(i);if(c){let f=`${c[3]}/${c[4]}`,C=t.getTestItemIndexNonDarwin(f,c[1]);this.skipTest(C,t);continue}let u=/^Test Suite '(.*)' started/.exec(i);if(u){this.startTestSuite(u[1],t);continue}let l=/^Test Suite '(.*)' passed/.exec(i);if(l){this.passTestSuite(l[1],t);continue}let h=/^Test Suite '(.*)' failed/.exec(i);if(h){this.failTestSuite(h[1],t);continue}this.continueErrorMessage(i,t)}for(let i of r){let s=/^Test Case '(.*)\.(.*)' passed \((\d.*) seconds\)/.exec(i);if(s){let o=`${s[1]}/${s[2]}`,a=+s[3],c=t.getTestItemIndexNonDarwin(o,void 0);this.passTest(c,a,t);continue}}}startTestSuite(e,t){t.startedSuite(e)}passTestSuite(e,t){t.passedSuite(e)}failTestSuite(e,t){t.failedSuite(e)}startTest(e,t){e!==-1&&(t.started(e),t.failedTest=void 0)}passTest(e,t,r){e!==-1&&r.passed(e,t),r.failedTest=void 0}startErrorMessage(e,t,r,i,s){if(s.failedTest){s.failedTest.complete=!0;return}s.failedTest={testIndex:e,message:t,file:r,lineNumber:parseInt(i),complete:!1}}continueErrorMessage(e,t){t.failedTest&&t.failedTest.complete!==!0&&(t.failedTest.message+=`
${e}`)}failTest(e,t,r){e!==-1&&(r.failedTest?r.failed(e,r.failedTest.message,{file:r.failedTest.file,line:r.failedTest.lineNumber}):r.failed(e,"Failed")),r.failedTest=void 0}skipTest(e,t){e!==-1&&t.skipped(e),t.failedTest=void 0}};var Op=z(require("vscode"));var Np=class{createDebugAdapterTracker(e){return new ho(e.id)}};function qp(){return Op.debug.registerDebugAdapterTrackerFactory(an.adapterName,new Np)}var Fa=class{constructor(e){this.id=e;Fa.debugSessionIdMap[e]=this}static setDebugSessionCallback(e,t){let r=this.debugSessionIdMap[e.id];r&&(r.cb=t)}onDidSendMessage(e){let t=e;this.cb&&t&&t.type==="event"&&t.event==="output"&&t.body.category!=="console"&&this.cb(t.body.output)}onWillStopSession(){delete Fa.debugSessionIdMap[this.id]}},ho=Fa;ho.debugSessionIdMap={};var es=z(require("vscode"));var jn=class{constructor(e,t={showStatusItem:!1,checkAlreadyRunning:!1}){this.task=e;this.options=t}get name(){return this.task.name}get id(){let e;return this.task.scope===es.TaskScope.Workspace||this.task.scope===es.TaskScope.Global?e=es.TaskScope[this.task.scope]:this.task.scope?e=`,${this.task.scope.name}`:e="*undefined*",this.task.definition.args.join()+e}get statusItemId(){return this.task}get isBuildOperation(){return this.task.group===es.TaskGroup.Build}run(e,t){return e.tasks.executeTaskAndWait(this.task,t)}},po=class{constructor(e,t,r,i,s){this.args=e;this.folderContext=t;this.name=r;this.options=i;this.process=s}get id(){var e;return`${this.args.join()},${(e=this.folderContext)==null?void 0:e.folder.path}`}get statusItemId(){return`${this.name} (${this.folderContext.name})`}get isBuildOperation(){return!1}async run(e){let{stdout:t,stderr:r}=await Xr(this.args,e.toolchain,{cwd:this.folderContext.folder.fsPath},this.folderContext);return await this.process(t,r),0}},Lp=class{constructor(e,t,r){this.operation=e;this.cb=t;this.token=r;this.promise=void 0}get id(){return this.operation.id}get showStatusItem(){return this.operation.options.showStatusItem}get log(){return this.operation.options.log}run(e){return this.operation.run(e,this.token)}},ju=class{constructor(e){this.folderContext=e;this.queue=[],this.workspaceContext=e.workspaceContext,this.activeOperation=void 0,this.disabled=!1}queueOperation(e,t){let r=this.findQueuedOperation(e);if(r&&r.promise!==void 0)return r.promise;if(e.options.checkAlreadyRunning===!0&&this.activeOperation&&this.activeOperation.promise&&this.activeOperation.id===e.id)return this.activeOperation.promise;let i=new Promise((s,o)=>{r=new Lp(e,a=>{a.success!==void 0?s(a.success):a.fail!==void 0?o(a.fail):s(void 0)},t),this.queue.push(r),this.processQueue()});return this.queue.length>0&&!this.queue[this.queue.length-1].promise&&(this.queue[this.queue.length-1].promise=i),i}async processQueue(){if(!this.activeOperation){let e=this.queue.shift();e&&(this.activeOperation=e,e.showStatusItem===!0&&this.workspaceContext.statusItem.start(e.operation.statusItemId),await this.waitWhileDisabled(),e.log&&this.workspaceContext.outputChannel.logStart(`${e.log} ... `,this.folderContext.name),e.run(this.workspaceContext).then(t=>{if(e.log)switch(t){case 0:this.workspaceContext.outputChannel.logEnd("done.");break;case void 0:this.workspaceContext.outputChannel.logEnd("cancelled.");break;default:this.workspaceContext.outputChannel.logEnd("failed.");break}this.finishTask(e,{success:t})}).catch(t=>{e.log&&this.workspaceContext.outputChannel.logEnd(`${t}`),this.finishTask(e,{fail:t})}))}}finishTask(e,t){e.cb(t),e.showStatusItem===!0&&this.workspaceContext.statusItem.end(e.operation.statusItemId),this.activeOperation=void 0,this.processQueue()}findQueuedOperation(e){for(let t of this.queue)if(t.id===e.id)return t}async waitWhileDisabled(){await Of(()=>!this.disabled,1e3)}};var bi=class{constructor(e,t,r){this.request=e;this.folderContext=t;this.controller=r;this.testRun=this.controller.createTestRun(this.request);let i=this.createTestLists();this.testItems=i.testItems,this.testArgs=i.testArgs,this.testOutputParser=new $u}get workspaceContext(){return this.folderContext.workspaceContext}static setupProfiles(e,t){e.createRunProfile("Run Tests",ht.TestRunProfileKind.Run,async(r,i)=>{await new bi(r,t,e).runHandler(!1,!1,i)},!0),e.createRunProfile("Test Coverage",ht.TestRunProfileKind.Run,async(r,i)=>{await new bi(r,t,e).runHandler(!1,!0,i)}),e.createRunProfile("Debug Tests",ht.TestRunProfileKind.Debug,async(r,i)=>{await new bi(r,t,e).runHandler(!0,!1,i)})}createTestLists(){var s,o,a,c;let e=[];this.request.include&&this.request.include.length>0?this.request.include.forEach(u=>e.push(u)):this.controller.items.forEach(u=>e.push(u));let t=[],r=[];for(;e.length>0;){let u=e.pop();if(!((s=this.request.exclude)==null?void 0:s.includes(u))){if(u.parent&&!((o=u.parent)==null?void 0:o.parent)&&!((a=this.request.exclude)==null?void 0:a.find(l=>l.id.startsWith(u.id)))){t.push(u),u.children.size>0&&u.children.forEach(l=>r.push(l));continue}if(u.children.size>0){u.children.forEach(l=>e.push(l));continue}t.push(u)}}let i=[];for((this.request.include&&this.request.include.length>0||this.request.exclude&&this.request.exclude.length>0)&&(i=t.map(u=>u.id));r.length>0;){let u=r.pop();((c=this.request.exclude)==null?void 0:c.includes(u))||t.push(u)}return{testItems:t,testArgs:i}}async runHandler(e,t,r){let i=new Mp(this.testItems,this.testRun,this.folderContext);try{if(!t){let s=await Zi(this.folderContext),o=await this.folderContext.taskQueue.queueOperation(new jn(s),r);if(o===void 0||o!==0){this.testRun.end();return}}this.setTestsEnqueued(),e?await this.debugSession(r,i):await this.runSession(r,t,i)}catch(s){let o=s;if(o&&o.error&&o.error.message.startsWith("Command failed")){this.testRun.end();return}this.testRun.appendOutput(`\r
Error: ${mn(s)}`)}this.testRun.end()}createLaunchConfigurationForTesting(e){let t=this.testArgs.join(",");if(process.platform==="darwin"){let r=this.workspaceContext.toolchain.swiftVersion;if(e&&r.isLessThan(new He(5,7,0))&&r.isGreaterThanOrEqual(new He(5,6,0))){let i;t.length>0?i=`-XCTest ${t}`:i="";let s=Ip(this.folderContext,i);return s===null?null:s}else{let i=Mu(this.folderContext,!0);return i===null?null:(t.length>0&&(i.args=["-XCTest",t,...i.args]),i.terminal="console",i)}}else{let r=Mu(this.folderContext,!0);return r===null?null:(t.length>0&&(r.args=[t]),r.terminal="console",r)}}async runSession(e,t,r){let i=this.createLaunchConfigurationForTesting(!1);if(i===null)return;let s=new Wu.Writable({write:(u,l,h)=>{let f=u.toString();this.testRun.appendOutput(f.replace(/\n/g,`\r
`)),process.platform==="darwin"?this.testOutputParser.parseResultDarwin(f,r):this.testOutputParser.parseResultNonDarwin(f,r),h()}}),o=new Wu.Writable({write:(u,l,h)=>{let f=u.toString();this.testRun.appendOutput(f.replace(/\n/g,`\r
`)),h()}}),a,c;if(process.platform==="darwin",a=s,c=o,e.isCancellationRequested){s.end(),o.end();return}this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`);try{if(t){let u=this.testArgs.flatMap(h=>["--filter",h]),l=["test","--enable-code-coverage"];await $s(this.workspaceContext.toolchain.getToolchainExecutable("swift"),[...l,...u],a,c,e,{cwd:i.cwd,env:ce(ce({},process.env),i.env),maxBuffer:16*1024*1024},this.folderContext,!1,"SIGINT")}else process.platform==="darwin"&&(a=o,c=s),await $s(i.program,i.args??[],a,c,e,{cwd:i.cwd,env:ce(ce({},process.env),i.env),maxBuffer:16*1024*1024},this.folderContext,!1,"SIGKILL")}catch(u){if(o.end(),s.end(),t&&(await this.folderContext.lcovResults.generate(),$.displayCoverageReportAfterRun&&this.workspaceContext.testCoverageDocumentProvider.show(this.folderContext)),r.currentTestItem){let l=new ht.TestMessage(mn(u));this.testRun.errored(r.currentTestItem,l)}throw u}o.end(),s.end(),t&&(await this.folderContext.lcovResults.generate(),$.displayCoverageReportAfterRun&&this.workspaceContext.testCoverageDocumentProvider.show(this.folderContext))}async debugSession(e,t){let r=this.createLaunchConfigurationForTesting(!0);if(r===null)return;if(r.preLaunchTask=void 0,$.diagnostics){let o=JSON.stringify(r);this.workspaceContext.outputChannel.logDiagnostic(`Debug Config: ${o}`,this.folderContext.name)}let i=[],s=ht.debug.onDidStartDebugSession(o=>{this.workspaceContext.outputChannel.logDiagnostic("Start Test Debugging",this.folderContext.name),ho.setDebugSessionCallback(o,c=>{this.testRun.appendOutput(c),process.platform==="darwin"?this.testOutputParser.parseResultDarwin(c,t):this.testOutputParser.parseResultNonDarwin(c,t)});let a=e.onCancellationRequested(()=>{this.workspaceContext.outputChannel.logDiagnostic("Test Debugging Cancelled",this.folderContext.name),ht.debug.stopDebugging(o)});i.push(a)});return i.push(s),new Promise((o,a)=>{ht.debug.startDebugging(this.folderContext.workspaceFolder,r).then(c=>{if(c){this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`),ht.commands.executeCommand("testing.showMostRecentOutput");let u=ht.debug.onDidTerminateDebugSession(async()=>{this.workspaceContext.outputChannel.logDiagnostic("Stop Test Debugging",this.folderContext.name),i.forEach(l=>l.dispose()),o()});i.push(u)}else i.forEach(u=>u.dispose()),a()},c=>{i.forEach(u=>u.dispose()),a(c)})})}setTestsEnqueued(){for(let e of this.testItems)this.testRun.enqueued(e)}},Mp=class{constructor(e,t,r){this.testItems=e;this.testRun=t;this.folderContext=r}getTestItemIndexDarwin(e){return this.testItems.findIndex(t=>t.id===e)}getTestItemIndexNonDarwin(e,t){let r=-1;return t&&(r=this.testItems.findIndex(i=>this.isTestWithFilenameInTarget(e,t,i))),r===-1&&(r=this.testItems.findIndex(i=>i.id.endsWith(e))),r}started(e){this.testRun.started(this.testItems[e]),this.currentTestItem=this.testItems[e]}passed(e,t){this.testRun.passed(this.testItems[e],t*1e3),this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}failed(e,t,r){if(r){let i=new ht.TestMessage(t);i.location=new ht.Location(ht.Uri.file(r.file),new ht.Position(r.line-1,0)),this.testRun.failed(this.testItems[e],i)}else this.testRun.failed(this.testItems[e],new ht.TestMessage(t));this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}skipped(e){this.testRun.skipped(this.testItems[e]),this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}startedSuite(){}passedSuite(e){var r;let t=(r=this.lastTestItem)==null?void 0:r.parent;t&&t.id.endsWith(`.${e}`)&&this.testRun.passed(t)}failedSuite(e){var r;let t=(r=this.lastTestItem)==null?void 0:r.parent;t&&t.id.endsWith(`.${e}`)&&this.testRun.failed(t,[])}isTestWithFilenameInTarget(e,t,r){var o;if(!r.id.endsWith(e))return!1;let i=(o=r.parent)==null?void 0:o.parent;if(!i)return!1;let s=this.folderContext.swiftPackage.targets.find(a=>i.label===a.name);if(s){let a=t,c=Ia.join(this.folderContext.folder.fsPath,s.path),u=Ia.relative(c,a);return s.sources.find(l=>l===u)!==void 0}return!1}};var go=z(require("vscode")),Oa=z(require("path"));var Hu=class{constructor(e,t,r){this.uri=e;this.folderContext=t;this.controller=r;var i;this.targetName=(i=this.getTarget(e))==null?void 0:i.name,this.classes=[],this.functions=[]}includesFunction(e,t,r){return e!==this.targetName?!1:this.functions.find(i=>i.className===t&&i.funcName===r)!==void 0}addTestItems(){if(!this.targetName)return;let e=this.controller.items.get(this.targetName);!e||this.addTestItemsToTarget(e)}updateTestItems(e){if(!this.targetName)return;let t=this.parseSymbolList(e),r=this.controller.items.get(this.targetName);if(!r){this.functions=t.functions,this.classes=t.classes;return}let i=t.functions,s=[];this.functions.forEach(o=>{i.find(a=>o.className===a.className&&o.funcName===a.funcName)||s.push(o)}),this.functions=i,this.classes=t.classes,this.addTestItemsToTarget(r);for(let o of s){let a=`${this.targetName}.${o.className}`,c=r.children.get(a);if(!c)continue;let u=`${this.targetName}.${o.className}/${o.funcName}`;c.children.delete(u)}r.children.forEach(o=>{o.children.size===0&&r.children.delete(o.id)})}addTestItemsToTarget(e){let t=e.id;for(let r of this.classes){let i=`${t}.${r.className}`,s=e.children.get(i);if(!!s)if(s.uri)s.range=r.range;else{let o=s.children;e.children.delete(i);let a=this.controller.createTestItem(i,r.className,this.uri);o.forEach(c=>a.children.add(c)),a.range=r.range,e.children.add(a)}}for(let r of this.functions){let i=`${t}.${r.className}`,s=e.children.get(i);if(!s)continue;let o=`${t}.${r.className}/${r.funcName}`,a=s.children.get(o);if(a)if(a.uri)a.range=r.range;else{s.children.delete(o);let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}else{let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}}}parseSymbolList(e){let t=[],r=[];return e.filter(s=>s.kind===go.SymbolKind.Class||s.kind===go.SymbolKind.Namespace).forEach(s=>{var a;s.kind===go.SymbolKind.Class&&t.push({className:s.name,range:s.range});let o=(a=s.children)==null?void 0:a.filter(c=>c.kind===go.SymbolKind.Method&&c.name.match(/^test.*\(\)/));o==null||o.forEach(c=>{r.push({className:s.name,funcName:c.name.slice(0,-2),range:c.range})})}),{classes:t,functions:r}}getTarget(e){return kn(e.fsPath,this.folderContext.folder.fsPath)?this.folderContext.swiftPackage.getTargets("test").find(i=>{let s=Oa.relative(Oa.join(this.folderContext.folder.fsPath,i.path),e.fsPath);return i.sources.find(o=>o===s)!==void 0}):void 0}};var mo=class{constructor(e){this.folderContext=e;this.controller=Na.tests.createTestController(e.name,`${e.name} Tests`),this.controller.resolveHandler=async r=>{r||await this.discoverTestsInWorkspace()},bi.setupProfiles(this.controller,this.folderContext);let t=e.workspaceContext.tasks.onDidEndTaskProcess(r=>{var o;let i=r.execution.task,s=i.execution;i.scope===this.folderContext.workspaceFolder&&i.group===Na.TaskGroup.Build&&((o=s==null?void 0:s.options)==null?void 0:o.cwd)===this.folderContext.folder.fsPath&&r.exitCode===0&&i.definition.dontTriggerTestDiscovery!==!0&&this.discoverTestsInWorkspace()});this.subscriptions=[t,this.controller]}dispose(){this.subscriptions.forEach(e=>e.dispose())}static observeFolders(e){return e.observeFolders((t,r,i)=>{var s;switch(r){case we.add:t&&(t.addTestExplorer(),$.folder(t.workspaceFolder).disableAutoResolve||(s=t==null?void 0:t.testExplorer)==null||s.discoverTestsInWorkspace());break;case we.focus:t&&(i.languageClientManager.documentSymbolWatcher=(o,a)=>mo.onDocumentSymbols(t,o,a))}})}static onDocumentSymbols(e,t,r){var o;let i=t==null?void 0:t.uri,s=e==null?void 0:e.testExplorer;s&&r&&i&&i.scheme==="file"&&kn(i.fsPath,e.folder.fsPath)&&(((o=s.lspFunctionParser)==null?void 0:o.uri)===i||(s.lspFunctionParser=new Hu(i,e,s.controller)),s.lspFunctionParser.updateTestItems(r))}async discoverTestsInWorkspace(){var e;try{let t=this.folderContext.workspaceContext.toolchain,r=xa(t);if(process.platform==="darwin"&&$.sanitizer!=="off"){let o=await Zi(this.folderContext);o.definition.dontTriggerTestDiscovery=!0;let a=await this.folderContext.taskQueue.queueOperation(new jn(o));if(a===void 0||a!==0){this.setErrorTestItem("Build the project to enable test discovery.");return}}let i;t.swiftVersion.isGreaterThanOrEqual(new He(5,8,0))?i=["test","list","--skip-build"]:i=["test","--list-tests","--skip-build"],i=[...i,...r];let s=new po(i,this.folderContext,"Listing Tests",{showStatusItem:!0,checkAlreadyRunning:!1,log:"Listing tests"},o=>{this.deleteErrorTestItem();let a=o.match(/^.*\.[a-zA-Z0-9_]*\/.*$/gm);if(!!a){this.controller.items.forEach(c=>{c.children.forEach(u=>{u.children.forEach(l=>{var f;let h=`${c.label}.${u.label}/${l.label}`;!a.find(C=>C===h)&&!((f=this.lspFunctionParser)==null?void 0:f.includesFunction(c.label,u.label,l.label))&&u.children.delete(l.id)}),u.children.size===0&&c.children.delete(u.id)})});for(let c of a){let u=/^([\w\d_]*)\.([\w\d_]*)\/(.*)$/.exec(c);if(!u)continue;let l=this.controller.items.get(u[1]);l||(l=this.controller.createTestItem(u[1],u[1]),this.controller.items.add(l));let h=l.children.get(`${u[1]}.${u[2]}`);if(h||(h=this.controller.createTestItem(`${u[1]}.${u[2]}`,u[2]),l.children.add(h)),!h.children.get(c)){let f=this.controller.createTestItem(c,u[3]);h.children.add(f)}}}});await this.folderContext.taskQueue.queueOperation(s),(e=this.lspFunctionParser)==null||e.addTestItems()}catch(t){let r=mn(t);process.platform==="darwin"&&r.match(/error: unableToLoadBundle/)||process.platform==="win32"&&r.match(/The file doesnt exist./)||!["darwin","win32"].includes(process.platform)&&r.match(/No such file or directory/)?this.setErrorTestItem("Build the project to enable test discovery."):r.startsWith("error: no tests found")?this.setErrorTestItem("Add a test target to your Package.","No Tests Found."):this.setErrorTestItem(r),this.folderContext.workspaceContext.outputChannel.log(`Test Discovery Failed: ${r}`,this.folderContext.name)}}deleteErrorTestItem(){this.controller.items.delete(mo.errorTestItemId)}setErrorTestItem(e,t="Test Discovery Error"){if(this.controller.items.forEach(r=>{this.controller.items.delete(r.id)}),this.controller.items.size===0){let r=this.controller.createTestItem(mo.errorTestItemId,t);r.error=e,this.controller.items.add(r)}}},ts=mo;ts.errorTestItemId="#Error#";var Ap=z(require("vscode")),$p=z(require("path"));var vo=class{constructor(e){this.folderContext=e;this.waitingToRun=!1}static start(e){let t=Ap.workspace.onDidSaveTextDocument(r=>{if($.backgroundCompilation===!1)return;let i=["swift","c","cpp","objective-c","objective-cpp"],s=!1;if(i.forEach(a=>{r.languageId===a&&(s=!0)}),s===!1)return;let o=e.folders.find(a=>kn(r.uri.fsPath,a.folder.fsPath));!o||$p.join(o.folder.fsPath,"Package.swift")!==r.uri.fsPath&&o.backgroundCompilation.runTask()});return{dispose:()=>t.dispose()}}async runTask(){let e=await Zi(this.folderContext);if(!!e)try{await this.folderContext.taskQueue.queueOperation(new jn(e))}catch{}}};var Hp=z(Wp()),Up=z(require("fs")),Kp=z(require("fs/promises"));var Vu=class{constructor(e){this.folderContext=e;this.load()}dispose(){this.observer=void 0}async generate(){let e=this.folderContext.workspaceContext.toolchain.getToolchainExecutable("llvm-cov"),t=this.folderContext.swiftPackage.name,r=St.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0),i=`${r}/debug/codecov/lcov.info`,s=Up.createWriteStream(i);try{let o=`${r}/debug/${t}PackageTests.xctest`;process.platform==="darwin"&&(o+=`/Contents/MacOs/${t}PackageTests`),await $s(e,["export","-format","lcov",o,"-ignore-filename-regex=Tests|.build|Snippets|Plugins",`-instr-profile=${r}/debug/codecov/default.profdata`],s,s,null,{env:ce(ce({},process.env),$.swiftEnvironmentVariables),maxBuffer:16*1024*1024},this.folderContext),await this.lcovFileChanged()}catch(o){throw s.end(),o}}get exist(){return this.contents!==void 0}resultsForFile(e){var t;return(t=this.contents)==null?void 0:t.find(r=>r.file===e)}get totals(){if(!this.contents)return;let e=0,t=0;return this.contents.forEach(r=>{e+=r.lines.hit,t+=r.lines.found}),{hit:e,found:t}}async lcovFileChanged(){await this.load(),this.observer&&this.observer(this)}async load(){let e=this.lcovFilename();try{let t=await Kp.readFile(e,"utf8");this.contents=await this.loadLcov(t)}catch{}}async loadLcov(e){return new Promise((t,r)=>{Hp.source(e,(i,s)=>{i?r(i):s&&t(s)})})}lcovFilename(){return`${St.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0)}/debug/codecov/lcov.info`}};var Lt=class{constructor(e,t,r,i,s){this.folder=e;this.linuxMain=t;this.swiftPackage=r;this.workspaceFolder=i;this.workspaceContext=s;this.hasResolveErrors=!1;this.packageWatcher=new hu(this,s),this.packageWatcher.install(),this.backgroundCompilation=new vo(this),this.taskQueue=new ju(this),this.lcovResults=new Vu(this)}dispose(){var e,t;(e=this.linuxMain)==null||e.dispose(),this.packageWatcher.dispose(),(t=this.testExplorer)==null||t.dispose(),this.lcovResults.dispose()}static async create(e,t,r){let i=`Loading Package (${Lt.uriName(e)})`;r.statusItem.start(i);let{linuxMain:s,swiftPackage:o}=await r.statusItem.showStatusWhileRunning(i,async()=>{let u=await js.create(e),l=await Pn.create(e,r.toolchain);return{linuxMain:u,swiftPackage:l}});r.statusItem.end(i);let a=new Lt(e,s,o,t,r),c=o.error;return c&&(Vp.window.showErrorMessage(`Failed to load ${a.name}/Package.swift: ${c.message}`),r.outputChannel.log(`Failed to load Package.swift: ${c.message}`,a.name)),a}get name(){return this.relativePath.length===0?this.workspaceFolder.name:`${this.workspaceFolder.name}/${this.relativePath}`}get relativePath(){return ns.relative(this.workspaceFolder.uri.fsPath,this.folder.fsPath)}get isRootFolder(){return this.workspaceFolder.uri===this.folder}async reload(){await this.swiftPackage.reload(this.workspaceContext.toolchain)}async reloadPackageResolved(){await this.swiftPackage.reloadPackageResolved()}async loadSwiftPlugins(){let e=await Pn.loadPlugins(this.workspaceFolder.uri,this.workspaceContext.toolchain);this.swiftPackage.plugins=e}async fireEvent(e){this.workspaceContext.fireEvent(this,e)}editedPackageFolder(e){return ns.join(this.folder.fsPath,"Packages",e)}addTestExplorer(){this.testExplorer=new ts(this)}static uriName(e){return ns.basename(e.fsPath)}};var Ci=z(require("vscode")),Bp=z(require("path")),Xp=class{constructor(e){this.task=e}get name(){if(this.task instanceof Ci.Task){let e=this.task.definition.cwd;return e?`${this.task.name} (${Bp.basename(e)})`:this.task.name}else return this.task}},Bu=class{constructor(){this.runningTasks=[];this.item=Ci.window.createStatusBarItem(Ci.StatusBarAlignment.Left)}async showStatusWhileRunning(e,t){this.start(e);try{let r=await t();return this.end(e),r}catch(r){throw this.end(e),r}}start(e){if(this.runningTasks.findIndex(r=>r.task===e)!==-1)return;let t=new Xp(e);this.runningTasks.push(t),this.showTask(t)}end(e){let t=this.runningTasks.findIndex(r=>r.task===e);if(t!==-1)if(this.runningTasks.splice(t,1),this.runningTasks.length===0)this.hide();else{let r=this.runningTasks[this.runningTasks.length-1];this.showTask(r)}}showTask(e){e.task instanceof Ci.Task?this.show(`$(sync~spin) ${e.name}`,e.name,"workbench.action.tasks.showTasks"):this.show(`$(sync~spin) ${e.name}`,e.name)}show(e,t=void 0,r=void 0){this.item.text=e,this.item.accessibilityInformation={label:t??e},this.item.command=r,this.item.show()}hide(){this.item.hide()}dispose(){this.item.dispose()}};var zp=z(require("vscode"));var Xu=class{constructor(){this.channel=zp.window.createOutputChannel("Swift")}dispose(){this.channel.dispose()}log(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logDiagnostic(e,t){if(!$.diagnostics)return;let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logStart(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.append(i),console.log(i)}logEnd(e){this.channel.appendLine(e),console.log(e)}get nowFormatted(){return new Date().toLocaleString("en-US",{hourCycle:"h23",hour:"2-digit",minute:"numeric",second:"numeric"})}};var Jr=z(require("path")),qa=z(require("fs/promises"));var Yr=class{constructor(e,t){this.success=e;this.failure=t}static makeSuccess(e){return new Yr(e)}static makeFailure(e){return new Yr(void 0,e)}};async function Gp(n){let e=Jr.join(n.swiftFolderPath,"lldb"),t=Jr.dirname(n.swiftFolderPath);try{let s=["-b","-O","script print('<!' + lldb.SBHostOS.GetLLDBPath(lldb.ePathTypeLLDBShlibDir).fullpath + '!>')"],{stdout:o}=await Kt(e,s),a=/^<!([^!]*)!>/m.exec(o);a&&(t=a[1])}catch{if(process.platform==="win32")return Yr.makeFailure(void 0)}let r=await YD(t);return r?Yr.makeSuccess(r):Yr.makeFailure("LLDB failed to provide a library path")}async function YD(n){if((await qa.stat(n)).isFile())return n;let t,r;if(process.platform==="linux")t=Jr.join(n,"lib"),r=/liblldb.*\.so.*/;else if(process.platform==="darwin")t=Jr.join(n,"lib"),r=/liblldb\..*dylib|LLDB/;else if(process.platform==="win32")t=Jr.join(n,"bin"),r=/liblldb\.dll/;else return n;for(let i of[n,t]){let s=await JD(i,r);if(s)return Jr.join(i,s)}}async function JD(n,e){try{let t=await qa.readdir(n);for(let r of t)if(e.test(r))return r}catch{}return null}var It=z(require("vscode")),bC=z(require("path")),Ct=z(df());var aa=z(require("vscode"));var mC=z(df()),vC=new mC.RequestType("sourcekit-lsp/inlayHints");var yC=class{constructor(e){this.client=e}provideInlayHints(e,t,r){if(!$.lsp.inlayHintsEnabled)return null;let i={textDocument:this.client.code2ProtocolConverter.asTextDocumentIdentifier(e),range:{start:t.start,end:t.end}};return this.client.sendRequest(vC,i,r).then(o=>o.map(a=>{let c=a.label,u;switch(a.category){case"type":u=aa.InlayHintKind.Type,c=`: ${c}`;break;case"parameter":u=aa.InlayHintKind.Parameter;break}return{label:c,position:a.position,kind:u,paddingLeft:!0}}),o=>o)}};function wC(n){return aa.languages.registerInlayHintsProvider(Nn.documentSelector,new yC(n))}var fr=class{constructor(e){this.workspaceContext=e;if(this.singleServerSupport=e.swiftVersion.isGreaterThanOrEqual(new He(5,7,0)),this.subscriptions=[],this.subFolderWorkspaces=[],this.singleServerSupport){let r=e.observeFolders(async(i,s)=>{if(!!i)switch(s){case we.add:this.addFolder(i);break;case we.remove:this.removeFolder(i);break}});this.subscriptions.push(r),this.setLanguageClientFolder(void 0)}else{let r=e.observeFolders(async(i,s)=>{switch(s){case we.add:i&&i.folder&&this.isActiveFileInFolder(i.folder)&&await this.setLanguageClientFolder(i.folder);break;case we.focus:await this.setLanguageClientFolder(i==null?void 0:i.folder);break}});this.subscriptions.push(r)}let t=It.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration("swift.sourcekit-lsp")&&It.window.showInformationMessage("Changing LSP settings requires the language server be restarted.","Ok").then(i=>{i==="Ok"&&this.restart()})});if(this.subscriptions.push(t),e.swiftVersion.isLessThan(new He(5,6,0))){e.outputChannel.logDiagnostic("LSP: Adding new/delete file handlers");let r=It.workspace.onDidCreateFiles(()=>{this.restart()}),i=It.workspace.onDidDeleteFiles(()=>{this.restart()});this.subscriptions.push(r,i)}this.waitingOnRestartCount=0,this.documentSymbolWatcher=void 0,this.cancellationToken=new It.CancellationTokenSource}static get documentSelector(){var t;let e;switch($.lsp.supportCFamily){case"enable":e=[...fr.appleLangDocumentSelector,...fr.cFamilyDocumentSelector];break;case"disable":e=fr.appleLangDocumentSelector;break;case"cpptools-inactive":e=((t=It.extensions.getExtension("ms-vscode.cpptools"))==null?void 0:t.isActive)===!0?fr.appleLangDocumentSelector:[...fr.appleLangDocumentSelector,...fr.cFamilyDocumentSelector]}return e=e.filter(r=>$.lsp.supportedLanguages.includes(r.language)),e}dispose(){var e,t,r,i;(e=this.cancellationToken)==null||e.cancel(),(t=this.cancellationToken)==null||t.dispose(),(r=this.legacyInlayHints)==null||r.dispose(),this.subscriptions.forEach(s=>s.dispose()),(i=this.languageClient)==null||i.stop()}async useLanguageClient(e){if(!this.languageClient||!this.clientReadyPromise)throw ff.LanguageClientUnavailable;return this.clientReadyPromise.then(()=>{if(!this.languageClient||!this.cancellationToken)throw ff.LanguageClientUnavailable;return e(this.languageClient,this.cancellationToken.token)},t=>t)}async restart(){await this.setLanguageClientFolder(this.currentWorkspaceFolder,!0)}async addFolder(e){e.isRootFolder||this.useLanguageClient(async t=>{let r=e.folder;this.subFolderWorkspaces.push(e.folder);let i={uri:t.code2ProtocolConverter.asUri(r),name:Lt.uriName(r)};t.sendNotification(Ct.DidChangeWorkspaceFoldersNotification.type,{event:{added:[i],removed:[]}})})}async removeFolder(e){e.isRootFolder||this.useLanguageClient(async t=>{let r=e.folder;this.subFolderWorkspaces=this.subFolderWorkspaces.filter(s=>s!==r);let i={uri:t.code2ProtocolConverter.asUri(r),name:Lt.uriName(r)};t.sendNotification(Ct.DidChangeWorkspaceFoldersNotification.type,{event:{added:[],removed:[i]}})})}async addSubFolderWorkspaces(e){for(let t of this.subFolderWorkspaces){let r={uri:e.code2ProtocolConverter.asUri(t),name:Lt.uriName(t)};e.sendNotification(Ct.DidChangeWorkspaceFoldersNotification.type,{event:{added:[r],removed:[]}})}}async setLanguageClientFolder(e,t=!1){if(this.languageClient===void 0){this.currentWorkspaceFolder=e,this.restartedPromise=this.setupLanguageClient(e);return}else{if(!this.singleServerSupport&&(e===void 0||this.currentWorkspaceFolder===e&&!t))return;let r;e&&(r={uri:e,name:Lt.uriName(e),index:0}),this.restartLanguageClient(r)}}async restartLanguageClient(e){var r,i,s;if(this.waitingOnRestartCount+=1,this.restartedPromise)try{await this.restartedPromise}catch{}if(this.waitingOnRestartCount-=1,this.waitingOnRestartCount!==0)return;let t=this.languageClient;this.languageClient=null,this.currentWorkspaceFolder=e==null?void 0:e.uri,(r=this.legacyInlayHints)==null||r.dispose(),this.legacyInlayHints=void 0,t&&((i=this.cancellationToken)==null||i.cancel(),(s=this.cancellationToken)==null||s.dispose(),this.restartedPromise=t.stop().then(async()=>{await this.setupLanguageClient(e==null?void 0:e.uri)}).catch(async o=>{o.message==="Stopping the server timed out"&&await this.setupLanguageClient(e==null?void 0:e.uri),this.workspaceContext.outputChannel.log(`${o}`)}))}isActiveFileInFolder(e){if(It.window.activeTextEditor&&It.window.activeTextEditor.document){let t=It.window.activeTextEditor.document.uri.fsPath;if(kn(t,e.fsPath))return!0}return!1}async setupLanguageClient(e){if($.lsp.disable){this.languageClient=void 0;return}let t=this.createLSPClient(e);return this.startClient(t)}createLSPClient(e){var f;let t=this.workspaceContext.toolchain.getToolchainExecutable("sourcekit-lsp"),r=$.lsp,i=r.serverPath,s=i.length>0?i:t,o=this.workspaceContext.toolchain.buildFlags,a=[...o.swiftDriverSDKFlags(!0),...o.swiftDriverTargetFlags(!0),...St.filterArguments($.buildArguments.concat(o.buildPathFlags()),fr.buildArgumentFilter)],c={command:s,args:r.serverArguments.concat(a),options:{env:ce(ce(ce({},process.env),$.swiftEnvironmentVariables),nn())}};i.length>0&&$.path.length>0&&i!==t&&(c.options={env:Sn(ce({},(f=c.options)==null?void 0:f.env),{SOURCEKIT_TOOLCHAIN_PATH:this.workspaceContext.toolchain.toolchainPath})});let u=c,l;e&&(l={uri:e,name:Lt.uriName(e),index:0});let h={documentSelector:fr.documentSelector,revealOutputChannelOn:Ct.RevealOutputChannelOn.Never,workspaceFolder:l,middleware:{provideDocumentSymbols:async(C,b,y)=>{let S=await y(C,b),k=S;return this.documentSymbolWatcher&&k&&this.documentSymbolWatcher(C,k),S},provideDefinition:async(C,b,y,S)=>{let k=await S(C,b,y),v=k;if(v&&bC.extname(v[0].uri.path)===".swiftinterface"){let D=v[0].uri.with({scheme:"readonly"});return new It.Location(D,v[0].range)}return k},provideInlayHints:async(C,b,y,S)=>{let k=await S(C,b,y);return k==null||k.forEach(v=>v.textEdits=void 0),k}},errorHandler:new CC(5)};return new Ct.LanguageClient("swift.sourcekit-lsp","SourceKit Language Server",u,h)}async startClient(e){return e.onDidChangeState(t=>{t.oldState===Ct.State.Starting&&t.newState===Ct.State.Running&&this.addSubFolderWorkspaces(e)}),e.clientOptions.workspaceFolder?this.workspaceContext.outputChannel.log(`SourceKit-LSP setup for ${Lt.uriName(e.clientOptions.workspaceFolder.uri)}`):this.workspaceContext.outputChannel.log("SourceKit-LSP setup"),this.clientReadyPromise=e.start().then(()=>{this.workspaceContext.swiftVersion.isLessThan(new He(5,7,0))&&(this.legacyInlayHints=wC(e))}).catch(t=>{var r;throw this.workspaceContext.outputChannel.log(`${t}`),(r=this.languageClient)==null||r.stop(),this.languageClient=void 0,t}),this.languageClient=e,this.cancellationToken=new It.CancellationTokenSource,this.clientReadyPromise}},Nn=fr;Nn.appleLangDocumentSelector=[{scheme:"file",language:"swift"},{scheme:"untitled",language:"swift"},{scheme:"file",language:"objective-c"},{scheme:"untitled",language:"objective-c"},{scheme:"file",language:"objective-cpp"},{scheme:"untitled",language:"objective-cpp"}],Nn.cFamilyDocumentSelector=[{scheme:"file",language:"c"},{scheme:"untitled",language:"c"},{scheme:"file",language:"cpp"},{scheme:"untitled",language:"cpp"}],Nn.buildArgumentFilter=[{argument:"--build-path",include:1},{argument:"--scratch-path",include:1},{argument:"-Xswiftc",include:1},{argument:"-Xcc",include:1},{argument:"-Xcxx",include:1},{argument:"-Xlinker",include:1},{argument:"-Xclangd",include:1},{argument:"-index-store-path",include:1}];var CC=class{constructor(e){this.maxRestartCount=e;this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Ct.ErrorAction.Continue}:{action:Ct.ErrorAction.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:Ct.CloseAction.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?new Promise(t=>{It.window.showErrorMessage(`The SourceKit-LSP server crashed ${this.maxRestartCount+1} times in the last 3 minutes. See the output for more information. Do you want to restart it again.`,"Yes","No").then(r=>{r==="Yes"?(this.restarts=[],t({action:Ct.CloseAction.Restart})):t({action:Ct.CloseAction.DoNotRestart})})}):(this.restarts.shift(),{action:Ct.CloseAction.Restart})}},ff=(e=>(e[e.LanguageClientUnavailable=0]="LanguageClientUnavailable",e))(ff||{});var DC=z(require("os")),hf=z(require("path")),TC=z(require("fs/promises"));var ca=class{constructor(e){this.path=e}filename(e,t){let r;return t?r=`${e}${fu(16)}.${t}`:r=`${e}${fu(16)}`,hf.join(this.path,r)}static async create(){let e=hf.join((0,DC.tmpdir)(),"vscode-swift");try{await TC.mkdir(e)}catch{}return new ca(e)}};var ua=z(require("vscode")),pf=class{constructor(e){this.workspaceContext=e;this.taskEndObservers=new Set;this.taskId=0;this.onDidEndTaskProcessDisposible=ua.tasks.onDidEndTaskProcess(t=>{this.taskEndObservers.forEach(r=>r(t))}),this.onDidEndTaskDisposible=ua.tasks.onDidEndTask(t=>{this.taskEndObservers.forEach(r=>r({execution:t.execution,exitCode:void 0})),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!1)}),this.onDidStartTaskDisposible=ua.tasks.onDidStartTask(t=>{this.taskStartObserver&&this.taskStartObserver(t),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!0)})}onDidEndTaskProcess(e){return this.taskEndObservers.add(e),{dispose:()=>{this.removeObserver(e)}}}async executeTaskAndWait(e,t){return e.definition.id=this.taskId,this.taskId+=1,new Promise((r,i)=>{this.startingTaskPromise?this.startingTaskPromise.then(()=>{this.executeTaskAndResolve(e,r,i,t)}):this.executeTaskAndResolve(e,r,i,t)})}executeTaskAndResolve(e,t,r,i){let s=this.onDidEndTaskProcess(o=>{o.execution.task.definition.id===e.definition.id&&(s.dispose(),t(o.exitCode))});this.startingTaskPromise!==void 0&&console.warn("TaskManager: Starting promise should be undefined if we reach here."),this.startingTaskPromise=new Promise(o=>{this.taskStartObserver=()=>{this.taskStartObserver=void 0,this.startingTaskPromise=void 0,o()}}),ua.tasks.executeTask(e).then(o=>{i==null||i.onCancellationRequested(()=>{o.terminate(),s.dispose(),t(void 0)})},o=>{console.log(o),s.dispose(),this.startingTaskPromise=void 0,r(o)})}removeObserver(e){this.taskEndObservers.delete(e)}disableTaskQueue(e,t){let r=this.workspaceContext.folders.findIndex(i=>i.folder.fsPath===e.definition.cwd);r!==-1&&(this.workspaceContext.folders[r].taskQueue.disabled=t)}dispose(){this.onDidEndTaskDisposible.dispose(),this.onDidEndTaskProcessDisposible.dispose(),this.onDidStartTaskDisposible.dispose()}};var ru=z(require("vscode")),iu=z(require("path"));function SC(n){if(n.swiftVersion.isLessThan({major:5,minor:7,patch:0})||!n.currentFolder||!n.currentDocument){kt.fileIsSnippet=!1;return}let e=n.currentDocument.fsPath,t=iu.join(n.currentFolder.folder.fsPath,"Snippets");e.startsWith(t)?kt.fileIsSnippet=!0:kt.fileIsSnippet=!1}async function kC(n){await PC(n,{noDebug:!0})}async function RC(n){await PC(n,{})}async function PC(n,e){let t=n.currentFolder;if(!n.currentDocument||!t)return;let r=iu.basename(n.currentDocument.fsPath,".swift"),i=cn(["build","--product",r],`Build ${r}`,{group:ru.TaskGroup.Build,cwd:t.folder,scope:t.workspaceFolder,presentationOptions:{reveal:ru.TaskRevealKind.Always},problemMatcher:$.problemMatchCompileErrors?"$swiftc":void 0},n.toolchain);try{await t.taskQueue.queueOperation(new jn(i)).then(s=>{if(s===0){let o=Fp(r,t);return _a(t.workspaceFolder,o,e)}})}catch{}}var Ar=z(require("vscode")),gf=z(require("path")),mf=class{constructor(e){this.ctx=e;this.onDidChangeEmitter=new Ar.EventEmitter,this.provider=Ar.workspace.registerTextDocumentContentProvider("swiftTestCoverage",{provideTextDocumentContent:t=>{let r=gf.basename(t.path," coverage"),i=e.folders.find(o=>o.name===r);return i?this.generateMarkdownReport(i)??`Failed to generate test coverage report for ${r}`:`Test coverage report for ${r} is unavailable`},onDidChange:this.onDidChangeEmitter.event})}dispose(){this.provider.dispose(),this.onDidChangeEmitter.dispose()}show(e){let t=Ar.Uri.parse(`swiftTestCoverage://report/${e.name} coverage`);this.onDidChangeEmitter.fire(t),Ar.commands.executeCommand("markdown.showPreview",t).then(()=>{Ar.commands.executeCommand("markdown.preview.refresh",t)})}generateMarkdownReport(e){let t=e.lcovResults;if(!t.contents)return;let r=`
## Test coverage report for ${e.name}

|File|Total lines| Hit|Missed|Coverage %|
|----|----------:|---:|-----:|---------:|
`,i=t.contents.map(h=>{let f=gf.basename(h.file),C=h.lines.found,b=h.lines.hit,y=C-b,S=(100*b/C).toFixed(2),k=encodeURI(`vscode://file${h.file}`);return`|[${f}](${k})|${C}|${b}|${y}|${S}|`}),s=t.totals,o=s.found,a=s.hit,c=o-a,u=(100*a/o).toFixed(2),l=`
| | | | |
|**Totals**|${o}|${a}|${c}|${u}|
`;return r+i.join(`
`)+l}};var Dn=z(require("vscode"));var vf=class{constructor(e,t){this.document=e;this.position=t}match(e){let t=this.getLine();if(!t)return null;let r=e.exec(t.text);if(r){let i=r.index+r[0].length;this.position=this.position.translate(void 0,i+t.whitespace);let s=r.map(o=>o);return s.shift(),s}return null}skipUntil(e){let t='{([<"',r='})]>"',i="})]",s=[];for(let o=this.getLine();o;o=this.getLine()){let a=-1,c=0;for(;c<o.text.length;){let u=o.text[c];if(e.indexOf(u)!==-1){let l=s.pop();if(!l)return this.position=this.position.translate(void 0,c+o.whitespace+1),o.text[c];e=l}else if((a=t.indexOf(u))!==-1)s.push(e),e=r[a];else{if(i.indexOf(u)!==-1&&e!=='"')return;u==="\\"&&e==='"'&&(c+=1)}c+=1}this.position=this.position.translate(1,-this.position.character)}}getLine(){for(;this.position.line<this.document.lineCount;){let t=this.document.lineAt(this.position.line).text.substring(this.position.character),r=/^\s*/.exec(t),i=0;if(r&&(i=r[0].length),t.length>i)return{text:t.substring(i),whitespace:i};this.position=this.position.translate(1,-this.position.character)}return null}};var yf=class extends Dn.CompletionItem{constructor(e,t,r,i){super(t,Dn.CompletionItemKind.Text);this.detail=r,this.insertText=e,this.sortText=i}},_C=class{async provideCompletionItems(e,t){return this.isLineComment(e,t.line-1)===!1?void 0:[new yf("/// ","///","Documentation comment")]}isLineComment(e,t){return!!/^\s*\/\/\//.test(e.lineAt(t).text)}},EC=class{async provideCompletionItems(e,t){if(this.isLineComment(e,t.line)===!1)return;let i=new Dn.Position(t.line+1,0),s=this.getFunctionDetails(e,i);if(s){if(s.parameters.length===0&&s.returns===!1)return;let o=this.constructSnippet(s,!1);return[new yf(o,"/// - parameters:","Function documentation comment")]}}async insert(e,t){let r=new Dn.Position(t,0),i=e.document,s=this.getFunctionDetails(i,r);if(s){let o=this.constructSnippet(s,!0),a=new Dn.Position(t,s.indent);e.insertSnippet(o,a)}}isLineComment(e,t){return!!/^\s*\/\/\/\s*$/.test(e.lineAt(t).text)}getFunctionDetails(e,t){let r=new vf(e,t);if(!r.match(/^[^{]*\b(?:func|init)/))return null;let i=r.match(/^([^(<]*)\s*(\(|<)/);if(!i||i[1]==="<"&&(r.skipUntil(">"),!r.match(/^\(/)))return null;let s=[];if(!r.match(/^\)/))for(;;){let c=r.match(/(\S*)(?:\s*)?:/);if(!c)return null;s.push(...c);let u=r.skipUntil(",)");if(!u)return null;if(u===")")break}let o=!1;for(;;){let c=r.match(/^\s*([a-z]+)/);if(!c||c.length===0)break;c[0]==="throws"&&(o=!0)}let a=r.match(/^\s*->/)!==null;return{indent:e.lineAt(t.line).firstNonWhitespaceCharacterIndex,parameters:s,returns:a,throws:o}}constructSnippet(e,t){let r="";t&&(r+="/// "),r+=" $1";let i=2;if(e.parameters.length===1)r+=`
/// - Parameter ${e.parameters[0]}: $${i}`,i++;else if(e.parameters.length>0){r+=`
/// - Parameters:`;for(let s of e.parameters)r+=`
///   - ${s}: $${i}`,i++}return e.returns&&(r+=`
/// - Returns: $${i}`),t&&(r+=`
`),new Dn.SnippetString(r)}},wf=class{constructor(){this.functionCommentCompletion=new EC,this.functionCommentCompletionProvider=Dn.languages.registerCompletionItemProvider("swift",this.functionCommentCompletion,"/"),this.commentCompletionProvider=Dn.languages.registerCompletionItemProvider("swift",new _C,`
`)}async insert(e,t){await this.functionCommentCompletion.insert(e,t)}dispose(){this.functionCommentCompletionProvider.dispose(),this.commentCompletionProvider.dispose()}};var Je=z(require("vscode"));var su=class{constructor(e){this.workspaceContext=e;this.displayResults=!1,this.currentEditor=Je.window.activeTextEditor;let{hit:t,miss:r}=this.getTestCoverageDecorationTypes();this.coverageHitDecorationType=Je.window.createTextEditorDecorationType(t),this.coverageMissDecorationType=Je.window.createTextEditorDecorationType(r),this.statusBarItem=this.createCoverageStatusItem(),e.folders.forEach(a=>{a.lcovResults.observer=c=>{this.resultsChanged(c)}});let i=e.observeFolders((a,c)=>{if(!!a)switch(c){case we.add:a.lcovResults.observer=u=>{this.resultsChanged(u)}}}),s=Je.window.onDidChangeActiveTextEditor(async a=>{this.currentEditor&&this.clear(this.currentEditor),a&&(this.render(a),this.currentEditor=a)}),o=Je.workspace.onDidChangeConfiguration(a=>{a.affectsConfiguration("swift.coverage.colors")&&this.resetTestCoverageEditorColors(),a.affectsConfiguration("swift.coverage.alwaysShowStatusItem")&&this.updateCoverageStatusItem()});this.subscriptions=[i,s,o]}dispose(){this.subscriptions.forEach(e=>e.dispose()),this.coverageHitDecorationType.dispose(),this.coverageMissDecorationType.dispose()}createCoverageStatusItem(){let e=Je.window.createStatusBarItem(Je.StatusBarAlignment.Left);return $.alwaysShowCoverageStatusItem&&(e.text="Coverage: Off",e.accessibilityInformation={label:"Coverage: Off",role:"button"},e.command="swift.toggleTestCoverage",e.show()),e}updateCoverageStatusItem(){$.alwaysShowCoverageStatusItem?(this.updateCoverageStatusItemText(this.statusItemCoverageOffText()),this.statusBarItem.command="swift.toggleTestCoverage",this.statusBarItem.show()):(this.statusBarItem.command=void 0,this.statusBarItem.hide())}updateCoverageStatusItemText(e){this.statusBarItem.text=e,this.statusBarItem.accessibilityInformation={label:e,role:$.alwaysShowCoverageStatusItem?"button":void 0}}resetTestCoverageEditorColors(){this.currentEditor&&this.clear(this.currentEditor),this.coverageHitDecorationType.dispose(),this.coverageMissDecorationType.dispose();let{hit:e,miss:t}=this.getTestCoverageDecorationTypes();this.coverageHitDecorationType=Je.window.createTextEditorDecorationType(e),this.coverageMissDecorationType=Je.window.createTextEditorDecorationType(t)}getTestCoverageDecorationTypes(){let e={isWholeLine:!0,dark:{backgroundColor:$.coverageHitColorDarkMode,overviewRulerColor:$.coverageHitColorDarkMode},light:{backgroundColor:$.coverageHitColorLightMode,overviewRulerColor:$.coverageHitColorLightMode}},t={isWholeLine:!0,dark:{backgroundColor:$.coverageMissColorDarkMode,overviewRulerColor:$.coverageMissColorDarkMode},light:{backgroundColor:$.coverageMissColorLightMode,overviewRulerColor:$.coverageMissColorLightMode}};return{hit:e,miss:t}}toggleDisplayResults(){this.displayResults===!0?(this.displayResults=!1,this.currentEditor?this.clear(this.currentEditor):this.updateCoverageStatusItemText(this.statusItemCoverageOffText())):(this.displayResults=!0,this.currentEditor?this.render(this.currentEditor):this.updateCoverageStatusItemText(this.statusItemCoverageOffText()))}resultsChanged(e){e.folderContext===this.workspaceContext.currentFolder&&this.currentEditor&&this.render(this.currentEditor)}render(e){this.clear(e);let t=this.workspaceContext.currentFolder;if(!t||!this.displayResults)return;t.lcovResults.exist||(Je.window.showInformationMessage("Test coverage results are unavailable."),this.displayResults=!1);let r=t.lcovResults.resultsForFile(e==null?void 0:e.document.fileName);if(!r)return;let i=r.lines.details.filter(a=>a.hit>0),s=r.lines.details.filter(a=>a.hit===0);if(i.length>0){let a=i.map(u=>new Je.Range(new Je.Position(u.line-1,0),new Je.Position(u.line-1,0))),c=this.combineRanges(a);e.setDecorations(this.coverageHitDecorationType,c)}if(s.length>0){let a=s.map(u=>new Je.Range(new Je.Position(u.line-1,0),new Je.Position(u.line-1,0))),c=this.combineRanges(a);e.setDecorations(this.coverageMissDecorationType,c)}let o=100*r.lines.hit/r.lines.found;this.updateCoverageStatusItemText(`Coverage: ${o.toFixed(1)}%`),this.statusBarItem.show()}combineRanges(e){let t=e[0],r=[];if(e.length<2)return e;for(let i=1;i<e.length;i++)e[i].start.line===t.end.line+1?t=new Je.Range(new Je.Position(t.start.line,0),new Je.Position(e[i].end.line,0)):(r.push(t),t=e[i]);return r.push(t),r}clear(e){e.setDecorations(this.coverageHitDecorationType,[]),e.setDecorations(this.coverageMissDecorationType,[]),$.alwaysShowCoverageStatusItem?this.updateCoverageStatusItemText(this.statusItemCoverageOffText()):this.statusBarItem.hide()}statusItemCoverageOffText(){return this.displayResults?"Coverage: Unavailable":"Coverage: Off"}};var la=class{constructor(e,t){this.tempFolder=e;this.toolchain=t;this.folders=[];this.initialisationFinished=!1;this.observers=new Set;var a;this.outputChannel=new Xu,this.statusItem=new Bu,this.languageClientManager=new Nn(this),this.outputChannel.log(this.toolchain.swiftVersionString),this.toolchain.logDiagnostics(this.outputChannel),this.tasks=new pf(this),this.currentDocument=null,this.testCoverageDocumentProvider=new mf(this),this.commentCompletionProvider=new wf,this.testCoverageRenderer=new su(this);let r=ge.workspace.onDidChangeConfiguration(async c=>{if(c.affectsConfiguration("swift.path")&&ge.window.showInformationMessage("Changing the Swift path requires the project be reloaded.","Ok").then(u=>{u==="Ok"&&ge.commands.executeCommand("workbench.action.reloadWindow")}),c.affectsConfiguration("swift.SDK")&&ge.window.showInformationMessage("Changing the Swift SDK path requires the project be reloaded.","Ok").then(u=>{u==="Ok"&&ge.commands.executeCommand("workbench.action.reloadWindow")}),c.affectsConfiguration("swift.runtimePath")){if(!this.needToAutoGenerateLaunchConfig())return;ge.window.showInformationMessage(`Launch configurations need to be updated after changing the Swift runtime path. Custom versions of environment variable '${As()}' may be overridden. Do you want to update?`,"Update","Cancel").then(async u=>{u==="Update"&&this.folders.forEach(async l=>await wi(l,void 0,!0))})}if(c.affectsConfiguration("swift.buildPath")){if(!this.needToAutoGenerateLaunchConfig())return;ge.window.showInformationMessage("Launch configurations need to be updated after changing the Swift build path. Do you want to update?","Update","Cancel").then(async u=>{u==="Update"&&this.folders.forEach(async l=>await wi(l,void 0,!0))})}if(c.affectsConfiguration("swift.debugger.useDebugAdapterFromToolchain")||c.affectsConfiguration("swift.debugger.path")){if($.debugger.useDebugAdapterFromToolchain&&!await an.verifyDebugAdapterExists(this))return;this.folders.forEach(async u=>await wi(u,"Launch configurations need to be updated after changing the debug adapter."))}}),i=vo.start(this),s=this.observeFolders((c,u)=>{switch(u){case we.remove:this.updatePluginContextKey();break;case we.focus:this.updateContextKeys(c),this.updateContextKeysForFile();break;case we.unfocus:this.updateContextKeys(c);break;case we.resolvedUpdated:c===this.currentFolder&&this.updateContextKeys(c)}}),o=this.tasks.onDidEndTaskProcess(c=>{c.execution.task.group===ge.TaskGroup.Build&&c.exitCode!==0&&c.exitCode!==void 0&&$.actionAfterBuildError==="Focus Problems"&&ge.commands.executeCommand("workbench.panel.markers.view.focus")});this.subscriptions=[o,this.commentCompletionProvider,this.testCoverageDocumentProvider,this.testCoverageRenderer,i,s,r,this.tasks,this.languageClientManager,this.outputChannel,this.statusItem],this.lastFocusUri=(a=ge.window.activeTextEditor)==null?void 0:a.document.uri}dispose(){this.folders.forEach(e=>e.dispose()),this.subscriptions.forEach(e=>e.dispose())}get swiftVersion(){return this.toolchain.swiftVersion}static async create(){let e=await ca.create(),t=await Tr.create();return new la(e,t)}updateContextKeys(e){if(!e||!e.swiftPackage.foundPackage){kt.hasPackage=!1,kt.packageHasDependencies=!1;return}kt.hasPackage=!0,kt.packageHasDependencies=e.swiftPackage.dependencies.length>0}updateContextKeysForFile(){var e,t,r;this.currentDocument?kt.currentTargetType=(r=(t=this.currentFolder)==null?void 0:t.swiftPackage.getTarget((e=this.currentDocument)==null?void 0:e.fsPath))==null?void 0:r.type:kt.currentTargetType=void 0,SC(this)}updatePluginContextKey(){let e=!1;for(let t of this.folders)if(t.swiftPackage.plugins.length>0){e=!0;break}kt.packageHasPlugins=e}setupEventListeners(){let e=ge.workspace.onDidChangeWorkspaceFolders(r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}this.onDidChangeWorkspaceFolders(r)}),t=ge.window.onDidChangeActiveTextEditor(async r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}await this.focusTextEditor(r)});this.subscriptions.push(e,t)}async addWorkspaceFolders(){if(ge.workspace.workspaceFolders&&ge.workspace.workspaceFolders.length>0)for(let e of ge.workspace.workspaceFolders)await this.addWorkspaceFolder(e);this.currentFolder===void 0&&(this.folders.length===1?await this.focusFolder(this.folders[0]):await this.focusFolder(null)),this.initialisationComplete()}async fireEvent(e,t){for(let r of this.observers)await r(e,t,this)}async focusFolder(e){e!==this.currentFolder&&(this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,we.unfocus),this.currentFolder=e,await this.fireEvent(e,we.focus))}async onDidChangeWorkspaceFolders(e){for(let t of e.added)await this.addWorkspaceFolder(t);for(let t of e.removed)await this.removeWorkspaceFolder(t)}async addWorkspaceFolder(e){await this.searchForPackages(e.uri,e),this.getActiveWorkspaceFolder(ge.window.activeTextEditor)===e&&await this.focusTextEditor(ge.window.activeTextEditor)}async searchForPackages(e,t){if(await this.isValidWorkspaceFolder(e.fsPath)){await this.addPackageFolder(e,t);return}!$.folder(t).searchSubfoldersForPackages||await ge.workspace.fs.readDirectory(e).then(async r=>{for(let i of r)i[1]===ge.FileType.Directory&&i[0][0]!=="."&&i[0]!=="Packages"&&await this.searchForPackages(ge.Uri.joinPath(e,i[0]),t)})}async addPackageFolder(e,t){let r=this.folders.findIndex(s=>s.folder.fsPath===e.fsPath);if(r!==-1)return console.error(`Adding package folder ${e} twice`),this.folders[r];let i=await Lt.create(e,t,this);return this.folders.push(i),await this.fireEvent(i,we.add),i}async removeWorkspaceFolder(e){this.folders.forEach(async t=>{if(t.workspaceFolder!==e)return;this.currentFolder===t&&this.focusFolder(null);let r=[...this.observers];r.reverse();for(let i of r)await i(t,we.remove,this);t.dispose()}),this.folders=this.folders.filter(t=>t.workspaceFolder!==e)}observeFolders(e){return this.observers.add(e),{dispose:()=>this.observers.delete(e)}}async setLLDBVersion(){if(an.adapterName!=="lldb")return;let e=await Gp(this.toolchain);if(!e.success){if(!e.failure)return;let o=`Error: ${mn(e.failure)}`;ge.window.showErrorMessage(`Failed to setup CodeLLDB for debugging of Swift code. Debugging may produce unexpected results. ${o}`),this.outputChannel.log(`Failed to setup CodeLLDB: ${o}`);return}let t=e.success,r=ge.workspace.getConfiguration("lldb"),i=r.get("library"),s=r.get("launch.expressions");i===t&&s==="native"||ge.window.showInformationMessage("The Swift extension needs to update some CodeLLDB settings to enable debugging features. Do you want to set this up in your global settings or the workspace settings?","Global","Workspace","Cancel").then(o=>{switch(o){case"Global":r.update("library",t,ge.ConfigurationTarget.Global),r.update("launch.expressions","native",ge.ConfigurationTarget.Global),r.update("library",void 0,ge.ConfigurationTarget.Workspace),r.update("launch.expressions",void 0,ge.ConfigurationTarget.Workspace);break;case"Workspace":r.update("library",t,ge.ConfigurationTarget.Workspace),r.update("launch.expressions","native",ge.ConfigurationTarget.Workspace);break}})}async focusTextEditor(e){await this.focusUri(e==null?void 0:e.document.uri)}async focusUri(e){var t;this.currentDocument=e??null,this.updateContextKeysForFile(),((t=this.currentDocument)==null?void 0:t.scheme)==="file"&&await this.focusPackageUri(this.currentDocument)}async focusPackageUri(e){let t=await this.getPackageFolder(e);if(t instanceof Lt)await this.focusFolder(t),this.lastFocusUri=void 0;else if(t instanceof ge.Uri)if(this.initialisationFinished===!1)this.lastFocusUri=e;else{let r=ge.workspace.getWorkspaceFolder(t);if(!r)return;await this.unfocusCurrentFolder();let i=await this.addPackageFolder(t,r);await this.focusFolder(i)}else await this.focusFolder(null)}toggleTestCoverageDisplay(){this.testCoverageRenderer||(this.testCoverageRenderer=new su(this),this.subscriptions.push(this.testCoverageRenderer)),this.testCoverageRenderer.toggleDisplayResults()}initialisationComplete(){this.initialisationFinished=!0,this.lastFocusUri&&(this.focusUri(this.lastFocusUri),this.lastFocusUri=void 0)}getWorkspaceFolder(e){return ge.workspace.getWorkspaceFolder(e)}getActiveWorkspaceFolder(e){if(!(!e||!e.document))return ge.workspace.getWorkspaceFolder(e.document.uri)}async getPackageFolder(e){let t=this.folders.find(a=>kn(e.fsPath,a.folder.fsPath));if(t)return t;let r=this.getWorkspaceFolder(e);if(!r)return;let i=r.uri.fsPath,s,o=bf.dirname(e.fsPath);for(await this.isValidWorkspaceFolder(o)&&(s=o);o!==i;)o=bf.dirname(o),await this.isValidWorkspaceFolder(o)&&(s=o);if(s)return ge.Uri.file(s)}async isValidWorkspaceFolder(e){return await zr(e,"Package.swift")||await zr(e,"compile_commands.json")}async unfocusCurrentFolder(){this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,we.unfocus),this.currentFolder=void 0}needToAutoGenerateLaunchConfig(){let e=!1;return this.folders.forEach(t=>{let r=$.folder(t.workspaceFolder).autoGenerateLaunchConfigurations&&t.swiftPackage.executableProducts.length>0;e=e||r}),e}},we=(o=>(o.add="add",o.remove="remove",o.focus="focus",o.unfocus="unfocus",o.packageUpdated="packageUpdated",o.resolvedUpdated="resolvedUpdated",o))(we||{});var Jt=z(require("vscode")),ou=z(require("fs/promises")),au=z(require("path"));var Zn=class{constructor(e,t,r,i,s){this.name=e;this.path=t;this.location=r;this.version=i;this.type=s}toTreeItem(){let e=new Jt.TreeItem(this.name,Jt.TreeItemCollapsibleState.Collapsed);return e.id=this.path,e.description=this.version,e.iconPath=this.type==="editing"?new Jt.ThemeIcon("edit"):new Jt.ThemeIcon("package"),e.contextValue=this.type,e.accessibilityInformation={label:`Package ${this.name}`},e}},xC=class{constructor(e,t,r){this.name=e;this.path=t;this.isDirectory=r}toTreeItem(){let e=new Jt.TreeItem(this.name,this.isDirectory?Jt.TreeItemCollapsibleState.Collapsed:Jt.TreeItemCollapsibleState.None);return e.id=this.path,e.resourceUri=Jt.Uri.file(this.path),this.isDirectory?e.accessibilityInformation={label:`Folder ${this.name}`}:(e.command={command:"vscode.open",arguments:[e.resourceUri],title:"Open File"},e.accessibilityInformation={label:`File ${this.name}`}),e}},Cf=class{constructor(e){this.workspaceContext=e;this.didChangeTreeDataEmitter=new Jt.EventEmitter;this.onDidChangeTreeData=this.didChangeTreeDataEmitter.event;kt.hasPackage=!1,kt.packageHasDependencies=!1}dispose(){var e;(e=this.workspaceObserver)==null||e.dispose()}observeFolders(e){this.workspaceObserver=this.workspaceContext.observeFolders((t,r)=>{switch(r){case we.focus:if(!t)return;e.title=`Package Dependencies (${t.name})`,this.didChangeTreeDataEmitter.fire();break;case we.unfocus:e.title="Package Dependencies",this.didChangeTreeDataEmitter.fire();break;case we.resolvedUpdated:if(!t)return;t===this.workspaceContext.currentFolder&&this.didChangeTreeDataEmitter.fire()}})}getTreeItem(e){return e.toTreeItem()}async getChildren(e){let t=this.workspaceContext.currentFolder;if(!t)return[];if(!e){let r=await t.swiftPackage.loadWorkspaceState();return await this.getDependencyGraph(r,t)}return this.getNodesInDirectory(e.path)}async getDependencyGraph(e,t){if(!e)return[];let r=await this.getInUseDependencies(e,t);return(e==null?void 0:e.object.dependencies.filter(i=>r.has(i.packageRef.identity.toLowerCase())).map(i=>{let s=this.dependencyType(i),o=this.dependencyDisplayVersion(i),a=this.dependencyPackagePath(i,t.folder.fsPath),c=i.packageRef.location;return new Zn(i.packageRef.identity,a,c,o,s)}))??[]}async getInUseDependencies(e,t){let r=await this.getLocalDependencySet(e,t),i=this.getRemoteDependencySet(t),s=this.getEditedDependencySet(e);return new Set([...r,...i,...s])}getRemoteDependencySet(e){var t;return new Set((t=e==null?void 0:e.swiftPackage.resolved)==null?void 0:t.pins.map(r=>r.identity))}getEditedDependencySet(e){return new Set(e.object.dependencies.filter(t=>this.dependencyType(t)==="editing").map(t=>t.packageRef.identity))}async getLocalDependencySet(e,t){let r=t.swiftPackage.dependencies??[],i=e.object.dependencies??[],s=t.folder.fsPath,o=new Set,a=r;for(;a.length>0;){let c=a.pop();if(!c||o.has(c.identity)||c.type!=="local"&&c.type!=="fileSystem")continue;o.add(c.identity);let u=i.find(f=>f.packageRef.identity===c.identity);if(!u)continue;let l=this.dependencyPackagePath(u,s),h=await Pn.loadPackage(Jt.Uri.file(l),this.workspaceContext.toolchain);a.push(...h.dependencies)}return o}getLocalDependencies(e){return(e==null?void 0:e.object.dependencies.filter(t=>(t.packageRef.kind==="local"||t.packageRef.kind==="fileSystem")&&t.packageRef.location).map(t=>new Zn(t.packageRef.identity,t.packageRef.location,t.packageRef.location,"local","local")))??[]}getRemoteDependencies(e){var t;return((t=e.swiftPackage.resolved)==null?void 0:t.pins.map(r=>new Zn(r.identity,r.location,r.location,r.state.version??r.state.branch??r.state.revision.substring(0,7),"remote")))??[]}getEditedDependencies(e){return(e==null?void 0:e.object.dependencies.filter(t=>t.state.name==="edited"&&t.state.path).map(t=>new Zn(t.packageRef.identity,t.state.path,t.state.path,"local","editing")))??[]}async getNodesInDirectory(e){let t=await ou.readdir(e),r=[],i=$.excludePathsFromPackageDependencies;for(let s of t){if(i.includes(s))continue;let o=au.join(e,s),a=await ou.stat(o);r.push(new xC(s,o,a.isDirectory()))}return r.sort((s,o)=>s.isDirectory===o.isDirectory?s.name.localeCompare(o.name):s.isDirectory?-1:1)}dependencyType(e){return e.state.name==="edited"?"editing":e.packageRef.kind==="local"||e.packageRef.kind==="fileSystem"?"local":"remote"}dependencyDisplayVersion(e){var r,i,s;let t=this.dependencyType(e);return t==="editing"?"editing":t==="local"?"local":((r=e.state.checkoutState)==null?void 0:r.version)??((i=e.state.checkoutState)==null?void 0:i.branch)??((s=e.state.checkoutState)==null?void 0:s.revision.substring(0,7))??"unknown"}dependencyPackagePath(e,t){let r=this.dependencyType(e);if(r==="editing")return e.state.path??au.join(t,"Packages",e.subpath);if(r==="local")return e.state.path??e.packageRef.location;{let i=St.buildDirectoryFromWorkspacePath(t,!0);return au.join(i,"checkouts",e.subpath)}}};var FC=z(require("vscode"));async function cu(n,e,t,r=()=>{}){let i=FC.window.createQuickPick();i.placeholder=n,i.items=e,i.show();let s=await new Promise(o=>{i.onDidAccept(()=>o(i.selectedItems[0])),i.onDidTriggerItemButton(a=>{r(a),o(void 0)}),i.onDidHide(()=>o(void 0))});i.busy=!0,s&&(await t(s),i.busy=!1),i.dispose()}async function yx(n){let e=n.currentFolder;!e||await da(e)}async function da(n,e){let t=cn(["package","resolve"],un.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await ji(t,"Resolving Dependencies",n,!1,e).then(r=>{qC(r,n)})}async function wx(n){let e=n.currentFolder;!e||await bx(e)}async function bx(n){let e=cn(["package","update"],un.updatePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await ji(e,"Updating Dependencies",n).then(t=>{qC(t,n)})}async function Cx(n){await OC(n,{noDebug:!0})}async function Dx(n){await OC(n,{})}async function OC(n,e){var o;let t=n.currentFolder;if(!t)return;let r=(o=Q.window.activeTextEditor)==null?void 0:o.document.fileName;if(!r)return;let i=t.swiftPackage.getTarget(r);if(!i||i.type!=="executable")return;let s=xp(i.name,t);if(s)return _a(t.workspaceFolder,s,e)}async function Tx(n){let e=n.currentFolder;!e||await Sx(e)}async function Sx(n){let e=cn(["package","clean"],un.cleanBuildName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent},group:Q.TaskGroup.Clean},n.workspaceContext.toolchain);await ji(e,"Clean Build",n)}async function kx(n){let e=n.currentFolder;!e||await Rx(e)}async function Rx(n){let e=cn(["package","reset"],"Reset Package Dependencies",{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent},group:Q.TaskGroup.Clean},n.workspaceContext.toolchain);await ji(e,"Reset Package",n).then(async t=>{if(!t)return;let r=cn(["package","resolve"],un.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await ji(r,"Resolving Dependencies",n)})}async function Px(n){var s;let e=(s=Q.window.activeTextEditor)==null?void 0:s.document;if(!e)return;if(process.platform==="win32"&&n.toolchain.swiftVersion.isLessThan(new He(5,7,0))){Q.window.showErrorMessage("Run Swift Script is unavailable with the legacy driver on Windows.");return}let t=e.fileName,r=!1;if(e.isUntitled){r=!0,t=n.tempFolder.filename(e.fileName,"swift");let o=e.getText();await Is.writeFile(t,o)}else await e.save();let i=cn([t],`Run ${t}`,{scope:Q.TaskScope.Global,cwd:Q.Uri.file(IC.dirname(t)),presentationOptions:{reveal:Q.TaskRevealKind.Always,clear:!0}},n.toolchain);await n.tasks.executeTaskAndWait(i),r&&await Is.rm(t)}async function _x(){Q.commands.executeCommand("workbench.action.tasks.runTask",{type:"swift-plugin"})}async function Ex(n,e){let t=e.currentFolder;!t||Q.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.folder,openLabel:"Select",title:"Select folder"}).then(async r=>{if(!r)return;let i=r[0],s=cn(["package","edit","--path",i.fsPath,n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name},e.toolchain);await ji(s,`Use local version of ${n}`,t,!0).then(o=>{o&&e.fireEvent(t,we.resolvedUpdated)})})}async function xx(n,e){let t=e.currentFolder;if(!t)return;let r=cn(["package","edit",n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name},e.toolchain);await ji(r,`edit locally ${n}`,t,!0).then(i=>{var s;if(i){e.fireEvent(t,we.resolvedUpdated);let o=((s=Q.workspace.workspaceFolders)==null?void 0:s.length)??0;Q.workspace.updateWorkspaceFolders(o,0,{uri:Q.Uri.file(t.editedPackageFolder(n)),name:n})}})}async function Fx(n,e){let t=e.currentFolder;if(!t)return;e.outputChannel.log(`unedit dependency ${n}`,t.name);let r=`Reverting edited dependency ${n} (${t.name})`;e.statusItem.start(r),await NC(t,n,e),e.statusItem.end(r)}async function NC(n,e,t,r=[]){var i;try{let s=new po(["package","unedit",...r,e],n,`Finish editing ${e}`,{showStatusItem:!0,checkAlreadyRunning:!1,log:"Unedit"},()=>{});await n.taskQueue.queueOperation(s),t.fireEvent(n,we.resolvedUpdated);let o=(i=Q.workspace.workspaceFolders)==null?void 0:i.findIndex(a=>a.name===e);if(o)try{await Is.stat(Q.workspace.workspaceFolders[o].uri.fsPath)}catch{Q.workspace.updateWorkspaceFolders(o,1)}}catch(s){let o=s;o.stderr.match(/has uncommited changes/)?Q.window.showWarningMessage(`${e} has uncommitted changes. Are you sure you want to continue?`,"Yes","No").then(async a=>{if(a==="No"){t.outputChannel.log(o.stderr,n.name);return}await NC(n,e,t,["--force"])}):(t.outputChannel.log(o.stderr,n.name),Q.window.showErrorMessage(`${o.stderr}`))}}async function Ix(n){var t;let e=((t=Q.workspace.workspaceFolders)==null?void 0:t.length)??0;Q.workspace.updateWorkspaceFolders(e,0,{uri:Q.Uri.file(n.path),name:n.name})}async function Ox(n){if(n.currentFolder){let e=Q.Uri.joinPath(n.currentFolder.folder,"Package.swift"),t=await Q.workspace.openTextDocument(e);Q.window.showTextDocument(t)}}function Nx(n){let e=Q.window.activeTextEditor;if(!e)return;let t=e.selection.active.line;n.commentCompletionProvider.insert(e,t)}function qx(n){n.languageClientManager.restart()}async function ji(n,e,t,r=!1,i){try{return await t.taskQueue.queueOperation(new jn(n,{showStatusItem:!0,checkAlreadyRunning:i??!1,log:e}))===0?!0:(r&&Q.window.showErrorMessage(`${e} failed`),!1)}catch(s){return r&&Q.window.showErrorMessage(`${e} failed: ${s}`),!1}}function Lx(n){try{let e=Q.Uri.parse(n.location,!0);Q.env.openExternal(e)}catch{}}async function Mx(){await cu("Select a new target",[{value:void 0,label:"macOS"},{value:An.iOS,label:"iOS"},{value:An.tvOS,label:"tvOS"},{value:An.watchOS,label:"watchOS"},{value:An.visionOS,label:"visionOS"}],async n=>{try{let e=n.value?await Tr.getSDKForTarget(n.value):"";e!==void 0?e!==""?($.sdk=e,Q.window.showWarningMessage(`Selecting the ${n.label} SDK will provide code editing support, but compiling with this SDK will have undefined results.`)):$.sdk=void 0:Q.window.showErrorMessage("Unable to obtain requested SDK path")}catch{Q.window.showErrorMessage("Unable to obtain requested SDK path")}})}async function Ax(){let n=await Tr.getXcodeDeveloperDir(),e=$.swiftEnvironmentVariables.DEVELOPER_DIR,t=await Tr.getXcodeInstalls();await cu(e??n,t.map(r=>{let i=`${r}/Contents/Developer`;return{label:i===n?`${r} (default)`:r,folder:i===n?void 0:i}}),async r=>{let i=$.swiftEnvironmentVariables,s=i.DEVELOPER_DIR??n;if(r.folder)i.DEVELOPER_DIR=r.folder;else if(i.DEVELOPER_DIR){let o=i,{DEVELOPER_DIR:a}=o;i=xf(o,["DEVELOPER_DIR"])}$.swiftEnvironmentVariables=i,$.sdk.length>0&&$.sdk.startsWith(s)&&($.sdk=$.sdk.replace(s,r.folder??n)),Q.window.showInformationMessage("Changing the Xcode Developer Directory requires the project be reloaded.","Ok").then(()=>{Q.commands.executeCommand("workbench.action.reloadWindow")})})}async function $x(n){n.currentFolder&&n.testCoverageDocumentProvider.show(n.currentFolder)}function jx(n){n.toggleTestCoverageDisplay()}async function Wx(n){let e=n.toolchain.getToolchainExecutable("lldb");try{let{stdout:t}=await Kt(e,["--batch","--no-lldbinit","--one-line","platform process list --show-args --all-users"]),i=t.split(`
`).flatMap(s=>{let o=/^(\d+)\s+\d+\s+\S+\s+\S+\s+(.+)$/.exec(s);return o?[{pid:parseInt(o[1]),label:`${o[1]}: ${o[2]}`}]:[]});await cu("Select Process",i,async s=>{let o={type:"swift-lldb",request:"attach",name:"Attach",pid:s.pid};await Q.debug.startDebugging(void 0,o)})}catch(t){Q.window.showErrorMessage(`Failed to run LLDB: ${mn(t)}`)}}function qC(n,e){let t=e.hasResolveErrors;e.hasResolveErrors=!n,t&&!e.hasResolveErrors&&e.fireEvent(we.resolvedUpdated)}function LC(n){n.subscriptions.push(Q.commands.registerCommand("swift.resolveDependencies",()=>yx(n)),Q.commands.registerCommand("swift.updateDependencies",()=>wx(n)),Q.commands.registerCommand("swift.run",()=>Cx(n)),Q.commands.registerCommand("swift.debug",()=>Dx(n)),Q.commands.registerCommand("swift.cleanBuild",()=>Tx(n)),Q.commands.registerCommand("swift.switchPlatform",()=>Mx()),Q.commands.registerCommand("swift.resetPackage",()=>kx(n)),Q.commands.registerCommand("swift.runScript",()=>Px(n)),Q.commands.registerCommand("swift.openPackage",()=>Ox(n)),Q.commands.registerCommand("swift.runSnippet",()=>kC(n)),Q.commands.registerCommand("swift.debugSnippet",()=>RC(n)),Q.commands.registerCommand("swift.runPluginTask",()=>_x()),Q.commands.registerCommand("swift.restartLSPServer",()=>qx(n)),Q.commands.registerCommand("swift.insertFunctionComment",()=>Nx(n)),Q.commands.registerCommand("swift.showTestCoverageReport",()=>$x(n)),Q.commands.registerCommand("swift.toggleTestCoverage",()=>jx(n)),Q.commands.registerCommand("swift.useLocalDependency",e=>{e instanceof Zn&&Ex(e.name,n)}),Q.commands.registerCommand("swift.editDependency",e=>{e instanceof Zn&&xx(e.name,n)}),Q.commands.registerCommand("swift.uneditDependency",e=>{e instanceof Zn&&Fx(e.name,n)}),Q.commands.registerCommand("swift.openInWorkspace",e=>{e instanceof Zn&&Ix(e)}),Q.commands.registerCommand("swift.openExternal",e=>{e instanceof Zn&&Lx(e)}),Q.commands.registerCommand("swift.selectXcodeDeveloperDir",()=>Ax()),Q.commands.registerCommand("swift.attachDebugger",()=>Wx(n)))}var Df=z(require("vscode")),MC=z(lf());var Tf=class{constructor(e){let t=Df.languages.createLanguageStatusItem("swiftlang-version",Nn.documentSelector);t.text=e.toolchain.swiftVersionString,t.accessibilityInformation={label:`Swift Version ${e.toolchain.swiftVersion.toString()}`},this.packageSwiftItem=Df.languages.createLanguageStatusItem("swiftlang-package",[...Nn.appleLangDocumentSelector,...Nn.cFamilyDocumentSelector]),this.packageSwiftItem.text="No Package.swift",this.packageSwiftItem.accessibilityInformation={label:"There is no Package.swift"};let r=e.observeFolders(async(i,s)=>{switch(s){case we.focus:i&&i.swiftPackage.foundPackage?(this.packageSwiftItem.text="Package.swift",this.packageSwiftItem.command=MC.Command.create("Open Package","swift.openPackage"),this.packageSwiftItem.accessibilityInformation={label:"Open Package.swift"}):(this.packageSwiftItem.text="No Package.swift",this.packageSwiftItem.accessibilityInformation={label:"There is no Package.swift"},this.packageSwiftItem.command=void 0)}});this.subscriptions=[r,t,this.packageSwiftItem]}dispose(){this.subscriptions.forEach(e=>e.dispose())}};var er=z(require("vscode")),AC=z(require("path"));var Sf=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let r of this.workspaceContext.folders)for(let i of r.swiftPackage.plugins)t.push(this.createSwiftPluginTask(i,{cwd:r.folder,scope:r.workspaceFolder,presentationOptions:{reveal:er.TaskRevealKind.Always}}));return t}resolveTask(e,t){let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=e.definition.disableSandbox?["--disable-sandbox"]:[],s=e.definition.allowWritingToPackageDirectory?["--allow-writing-to-package-directory"]:[],o=["package",...i,...s,e.definition.command,...e.definition.args];o=this.workspaceContext.toolchain.buildFlags.withSwiftSDKFlags(o);let a=new er.Task(e.definition,e.scope??er.TaskScope.Workspace,e.name,"swift-plugin",new er.ProcessExecution(r,o,{cwd:e.definition.cwd}),e.problemMatchers);return a.detail=e.detail??`swift ${o.join(" ")}`,a.presentationOptions=e.presentationOptions,a}createSwiftPluginTask(e,t){var f;let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=AC.relative(t.scope.uri.fsPath,(f=t.cwd)==null?void 0:f.fsPath),s=i!==""?i:void 0,o=this.getTaskDefinition(e,s),a=o.disableSandbox?["--disable-sandbox"]:[],c=o.allowWritingToPackageDirectory?["--allow-writing-to-package-directory"]:[],u=["package",...a,...c,e.command,...o.args];u=this.workspaceContext.toolchain.buildFlags.withSwiftSDKFlags(u);let l=new er.Task(o,t.scope??er.TaskScope.Workspace,e.name,"swift-plugin",new er.ProcessExecution(r,u,{cwd:s,env:ce(ce({},$.swiftEnvironmentVariables),nn())}),[]),h;return t.prefix?h=`(${t.prefix}) `:h="",l.detail=`${h}swift ${u.join(" ")}`,l.presentationOptions=(t==null?void 0:t.presentationOptions)??{},l}getTaskDefinition(e,t){let r={type:"swift-plugin",command:e.command,args:[],disableSandbox:!1,allowWritingToPackageDirectory:!1,cwd:t,disableTaskQueue:!1};switch(`${e.package}, ${e.command}`){case"swift-aws-lambda-runtime, archive":r.disableSandbox=!0,r.disableTaskQueue=!0;break;case"SwiftDocCPlugin, generate-documentation":r.allowWritingToPackageDirectory=!0;break;case"SwiftDocCPlugin, preview-documentation":r.disableSandbox=!0,r.allowWritingToPackageDirectory=!0;break;case"SwiftFormat, swiftformat":r.allowWritingToPackageDirectory=!0;break;default:break}return r}};var $C=z(require("vscode")),jC=z(require("fs/promises"));function WC(){return $C.workspace.registerTextDocumentContentProvider("readonly",{provideTextDocumentContent:async e=>{try{return await jC.readFile(e.fsPath,"utf8")}catch{return`Failed to load swiftinterface ${e.path}`}}})}var fa=z(require("vscode"));function HC(n){class e{createDebugAdapterDescriptor(s,o){if(!o){let a=$.debugger.debugAdapterPath.length>0?$.debugger.debugAdapterPath:n.toolchain.getToolchainExecutable("lldb-vscode");o=new fa.DebugAdapterExecutable(a,[],{})}return o}}let t=fa.debug.registerDebugAdapterDescriptorFactory("swift-lldb",new e),r=fa.debug.registerDebugConfigurationProvider("swift-lldb",new UC);return{dispose:()=>{r.dispose(),t.dispose()}}}var UC=class{async resolveDebugConfiguration(e,t,r){return t.env=this.convertEnvironmentVariables(t.env),t}convertEnvironmentVariables(e){if(e!==void 0)return Object.entries(e).map(([t,r])=>`${t}=${r}`)}};async function Ux(n){try{console.debug("Activating Swift for Visual Studio Code...");let e=await la.create();n.subscriptions.push(e),await an.verifyDebugAdapterExists(e,!0),e.setLLDBVersion(),e.setupEventListeners();let t=Os.tasks.registerTaskProvider("swift",new un(e)),r=Os.tasks.registerTaskProvider("swift-plugin",new Sf(e));LC(e);let i=new Tf(e),s=WC(),o=e.observeFolders((f,C)=>{e.outputChannel.log(`${C}: ${f==null?void 0:f.folder.fsPath}`,f==null?void 0:f.name)}),a=new Cf(e),c=Os.window.createTreeView("packageDependencies",{treeDataProvider:a,showCollapseAll:!0});a.observeFolders(c);let u=e.observeFolders(async(f,C,b)=>{async function y(S,k){(!$.folder(S.workspaceFolder).disableAutoResolve||$.backgroundCompilation)&&($.backgroundCompilation&&S.workspaceFolder.uri===S.folder?await S.backgroundCompilation.runTask():await da(S,!0),k.swiftVersion.isGreaterThanOrEqual(new He(5,6,0))&&k.statusItem.showStatusWhileRunning(`Loading Swift Plugins (${Lt.uriName(S.workspaceFolder.uri)})`,async()=>{await S.loadSwiftPlugins(),k.updatePluginContextKey()}))}if(!!f)switch(C){case we.add:wi(f),f.swiftPackage.foundPackage&&y(f,b);break;case we.packageUpdated:wi(f),f.swiftPackage.foundPackage&&!$.folder(f.workspaceFolder).disableAutoResolve&&await da(f,!0);break;case we.resolvedUpdated:f.swiftPackage.foundPackage&&!$.folder(f.workspaceFolder).disableAutoResolve&&await da(f,!0)}}),l=ts.observeFolders(e);if($.debugger.useDebugAdapterFromToolchain){let f=HC(e);n.subscriptions.push(f)}let h=qp();return e.addWorkspaceFolders(),n.subscriptions.push(h,u,l,s,c,a,o,i,r,t),{workspaceContext:e}}catch(e){let t=mn(e);throw Os.window.showErrorMessage(`Activating Swift extension failed: ${t}`),Error(t)}}function Kx(){}module.exports=eD(Vx);0&&(module.exports={activate,deactivate});
